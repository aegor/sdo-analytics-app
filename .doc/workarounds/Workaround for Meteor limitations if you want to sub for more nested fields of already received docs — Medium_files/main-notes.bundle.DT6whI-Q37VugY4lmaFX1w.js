(function(z){
'use strict';var iva=function(a,b){var c=b.g();if(c===Number||c.$isProtoEnum)return c=Number(a),Number.isNaN(c)?void 0:c;if(c===Boolean)return Boolean(a);if(c===String)return String(a)},jva=function(a,b){this.user=a;this.quotes=b},k$=function(a){return a.Cy.best||null},l$=function(){this.Tx=1},kva=function(a,b){return z.y(a,"slots",b)},lva=function(a,b){return z.y(a,"requestContext",b)},m$=function(a){z.A.call(this);this.w(a)},n$=function(a,b){b=b.filter(function(a){return"anon"!=a.Sa()});var c=z.Za(b,
function(a){return a.Sa()},a);return z.db(c).map(function(a){return new jva(a[0].Zb(),a)},a)},mva=function(a,b,c,d){return(0,z.Oc)(a.Po[b.name]||[],function(a){return a.pc()==c&&a.cd()==d})},o$=function(a){return z.w(a,"inResponseToMediaResource")},p$=function(a){return z.w(a,"mediumQuote")},q$=function(a,b){return k$(a)?z.DF(k$(a)).filter(function(a){return this.hN(a)==b},a):[]},nva=function(a,b,c){b=kva(lva(new m$,b),c);b=(new l$).Lh(b);var d=a.l.s(z.$ka,{},b);return z.jJ(a,d,function(){return z.q(a.S.get(d,
{background:!0}),function(a){return a.value})})},ova=function(a,b,c){var d=a.l.s(z.pM,{postId:b},{filter:c});return z.jJ(a,d,function(){return this.Va.Nl(d)})},pva=function(a,b){var c=a.l.s(z.Kka,{postId:b});return z.jJ(a,c,function(){return this.Va.Nl(c)})},qva=function(a){z.zA(a.wa,z.Xl("",a.Gp()))},rva=function(a,b,c){c=c.vs;b=b.getAttribute("name").split(" ");var d=z.ob(b);a=(a.Po[c.name]||[]).filter(function(a){return d[a.Bg()]});return a.length?z.IF(a):null},sva=function(a,b,c,d){b=mva(a,b,
c,d);return n$(a,b)},tva=function(a,b){var c=0;(a.Po[b]||[]).forEach(function(a){"anon"==a.Sa()&&(c+=a.Tc())});return c},r$=function(a){return z.w(a,"replies")},uva=function(a,b){z.Sn(a,7);var c=new z.Jn("",1,a.ia());b.forEach(function(a){z.Qn(c,z.fo(a.startOffset,a.endOffset,[a.quoteId],[a.userId]))},a);for(var d=z.ao(c),e=z.bo(c,d),g=0;g<d.length;g++){var h=e[g];if(h.length){for(var k={},n=[],p=0;p<h.length;p++){var u=h[p];k[z.w(u,"creatorIds")]=!0;n.push(u.getName())}h=d[g];p=g<d.length-1?d[g+
1]:a.ia().length;z.Qn(a,z.fo(h,p,n,Object.keys(k)))}}},vva=function(a,b,c){b=z.B;a=a.Kda?"Top highlight":(0,z.B)(z.F(z.GR(z.D(a,{YN:!0,L_:!c.useragent.isMobile}),c))+(1==a.ig&&a.isActive?" highlighted":""));return b(a)},s$=function(a,b){this.Vf=a;this.K3=b;var c=z.yC(a.node,b);this.nd=(this.fi=c)&&c.getAttribute("name");this.dD=c?z.ju(a,c):-1},t$=function(a,b,c){b="";var d=!a.Jea&&(null==a.post.virtuals?null:null==a.post.virtuals.previewImage?null:a.post.virtuals.previewImage.imageId),e=""+(a.ub?
"95":"85"),e=z.E(e),g=""+(d?z.H(z.qp({image:a.post.virtuals.previewImage,strategy:"crop-fixed",width:e,height:e},0,c)):""),g=(0,z.L)(g),e=""+z.H(z.Ro(z.D(a,{post:a.post,source:a.NP}),0,c)),e=(0,z.L)(e),h="u-block"+(a.oA?" u-width400 u-tableCell u-verticalAlignMiddle"+(a.ub?" u-height95":" u-height85"):""),h=z.E(h),k="readNextPromo-postInfo"+(a.oA?" u-tableCell u-verticalAlignMiddle u-paddingRight0":""),k=z.E(k),n="readNextPromo-postTitle u-block"+(a.oA?" u-lineClamp2":" u-noWrapWithEllipsis"),n=z.E(n),
d='\x3cdiv class\x3d"'+z.G(k)+'"\x3e'+(a.pga?'\x3cspan class\x3d"readNextPromo-callToAction u-accentColor--textNormal"\x3e'+z.F((0,z.B)("Next story"))+"\x3c/span\x3e":"")+'\x3ch4 class\x3d"'+z.G(n)+'"\x3e'+z.C(a.post.title)+"\x3c/h4\x3e"+(a.Gea?"":'\x3cspan class\x3d"readNextPromo-authorName u-block u-noWrapWithEllipsis"\x3e'+z.C(a.post.creator.name)+"\x3c/span\x3e")+"\x3c/div\x3e"+(d?'\x3cdiv class\x3d"readNextPromo-coverImage u-tableCell"\x3e\x3cimg class\x3d"readNextPromo-image'+(a.ub?" u-height95 u-width95":
"")+'" src\x3d"'+z.G(z.Lm(g))+'" /\x3e\x3c/div\x3e':""),d=(0,z.M)(d),g="readNextPromo"+(a.ub?" u-height95":"")+(a.ca?" u-height44 readNextPromo--chromeless":"")+(a.F?" "+z.C(a.F):""),g=(0,z.M)(g);b+='\x3cdiv class\x3d"'+z.G(g)+'"\x3e'+(a.Fea?'\x3cdiv class\x3d"buttonSet-separator buttonSet-separator--readNext u-floatLeft u-verticalAlignTop js-postActionRightSeparator"\x3e\x3c/div\x3e':"")+z.F(z.V({href:e,C:d,wn:!0,F:h},c))+"\x3c/div\x3e";return(0,z.B)(b)},wva=function(a,b,c){return(0,z.B)(z.XZ(z.D(a,
{user:c.currentUser,type:"quoteResponses"}),c))},xva=function(a,b,c){return(0,z.B)('\x3cdiv\x3e\x3cdiv class\x3d"buttonSet buttonSet--highlightMenu"\x3e'+z.F(z.xw({action:"quote",source:"quote_popover",icon:(0,z.M)(""+z.F(z.Mx())),F:"button--highlightMenu u-accentColor--highlightStrong js-quoteAttributions-pileOn",Vb:!0,Fj:!0,eM:"quote",ca:!0,isActive:a.isActive},c))+(c.supportsEdit?z.F(z.xw({action:"quote-respond",source:"quote_popover",icon:(0,z.M)(""+z.F(z.Wx())),F:"button--highlightMenu",Vb:!0,
ca:!0},c)):"")+'\x3cdiv class\x3d"buttonSet-separator"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"js-quoteAttributions-info quoteAttributions-info"\x3e'+vva(a,0,c)+"\x3c/div\x3e\x3c/div\x3e")},u$=function(a){z.id.call(this);var b=z.Ug();this.Bh=b&&new s$(z.Uh(b,!0),a);this.cj=b&&new s$(z.Uh(b,!1),a)},v$=function(a,b){return(0,z.B)(a.post?'\x3cdiv class\x3d"relatedPost col u-padding5 u-xs-size12of12 u-size6of12"\x3e'+t$({post:a.post,NP:z.E(""+z.UE({name:"related-reads-footer-grid",index:a.index})),
oA:!0,ub:!0},0,b)+"\x3c/div\x3e":"")},yva=function(a,b,c){return(0,z.B)('\x3cdiv class\x3d"postBundle"\x3e\x3cdiv class\x3d"container u-maxWidth740"\x3e\x3cdiv class\x3d"supplementalPostContent relatedReadsStream js-relatedReadsStream u-maxWidth640"\x3e'+z.F(z.jS(a,0,c))+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e")},w$=function(a,b,c){z.R.call(this);this.uc=a.get("quotes-data");var d=this.uc.xh;d.subscribe("add",this.AU,this);d.subscribe("remove",this.AU,this);this.za=b;this.Oc=b.Ef;this.il=c;this.IR=
[];this.wa=a.get("app");this.ka=a.get("popover");this.l=a.get("route-builder");this.QI=a.get("global-event-bus");this.f9=a.get("progressive-media-loader")},Ava=function(a,b,c,d){var e=zva(a,b);e&&(c=z.aE(z.cE(z.$D(z.bE(z.ZD(a.ka).Ma(xva,e),"top"),c),"popover--dark popover--padding0 popover--flexible popover--quoteAttributions"),d).U())&&(c.Ij("deactivate",function(){this.Pm===b&&x$(this,null)},a),z.TD(c).o("quote",a.A4.bind(a,c)).o("quote-respond",a.B4.bind(a,c)))},zva=function(a,b){if("anon"==b.Sa())return{isActive:!1,
Kda:!0};var c=y$(a,b),d=b.pc(),e=b.cd(),c=sva(a.uc,c,d,e);if(!c||!c.length)return null;c=(0,z.pb)(c,function(a){return a.user});d=(0,z.Oc)(c,function(a){return a.userId!=z.Yk().userId});return{isActive:(0,z.Bc)(c,function(a){return a.userId==z.Yk().userId}),social:d,ig:c.length}},Bva=function(a,b){var c=a.Oc.querySelectorAll('.markup--quote[name~\x3d"'+b.Bg()+'"]');return z.Qa(c)},y$=function(a,b){var c=b.Db()[0].name;return(c=z.Qt(a.Oc,c))?a.za.Ag(c):null},Cva=function(a,b){var c=z.Vg(b);return(c=
z.TF(a.il,c))?rva(a.uc,b,c):null},x$=function(a,b){a.Pm!==b&&(a.Pm&&Dva(a,a.Pm,!1),b&&Dva(a,b,!0),a.Pm=b)},Dva=function(a,b,c){Bva(a,b).map(function(a){z.Sc(a,"is-targeted",c)})},z$=function(a,b){var c=b.Db(),d=z.Qt(a.Oc,c[0].getName()),c=z.Qt(a.Oc,z.Ia(c).getName());(d=z.sF(d,b.pc(),c,b.cd()))&&z.RF(a.Nh(),d)},A$=function(a,b,c,d){z.T(c?z.IM:z.Ila,{postId:a.za.va(),quoteId:b,source:d})},Eva=function(a,b,c){b="";for(var d=a.posts,e=d.length,g=0;g<e;g++)b+=t$({post:d[g],NP:a.source,oA:!0,F:"u-margin5 u-overflowHidden u-whitespaceNormal u-inlineBlock"},
0,c);return(0,z.B)(b)},Fva=function(a,b,c){return(0,z.B)('\x3cdiv class\x3d"relatedPostGridContainer"\x3e\x3cdiv class\x3d"relatedPostGrid container u-maxWidth740"\x3e'+z.F(z.ry({title:z.E(""+(0,z.B)("Related reads")),zn:!0,F:"u-margin10 u-fontSizeSmaller u-textColorDark"},c))+'\x3cdiv class\x3d"row"\x3e'+v$({post:a.posts[0],index:0},c)+v$({post:a.posts[1],index:1},c)+'\x3c/div\x3e\x3cdiv class\x3d"row"\x3e'+v$({post:a.posts[2],index:2},c)+v$({post:a.posts[3],index:3},c)+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e")},
Gva=function(a,b,c){b=z.F(z.zw({action:"sidecard-dismiss",RN:!0,F:"u-fontSizeLarge u-marginRight5"},c))+'\x3ch1 class\x3d"u-padding10 u-fontSizeSmallest u-textColorDark u-backgroundGrayLightest"\x3e'+z.F((0,z.B)("More good reads"))+"\x3c/h1\x3e\x3cul\x3e";a=a.posts;for(var d=a.length,e=0;e<d;e++){var g=a[e];b+='\x3cli class\x3d"u-borderTopLightest"\x3e'+z.F(z.V({href:(0,z.L)(""+z.H(z.Ro({post:g},0,c))),isPrimary:!0,C:(0,z.M)('\x3cdiv class\x3d"u-fontSizeSmall u-contentTextBold u-lineClamp2 u-block u-paddingTop10 u-paddingLeft10 u-paddingRight10"\x3e'+
z.C(g.title)+'\x3c/div\x3e\x3cdiv class\x3d"u-fontSizeSmaller u-alignMiddle u-paddingBottom10 u-paddingLeft10 u-paddingRight10 u-textColorNormal"\x3e'+z.C(g.creator.name)+"\x3c/div\x3e")},c))+"\x3c/li\x3e"}return(0,z.B)(b+"\x3c/ul\x3e")},Hva=function(a,b){z.BC(a,z.AC,z.Hb(b,z.Eb(!0)),void 0)},B$=function(a){z.Uu.call(this);this.vb=a.get("dom-model-converter");this.JT={};this.HS={};this.lK={};this.X=a;this.kl=a.get("request");this.l=a.get("route-builder");this.aa=a.get("model-store");this.Fa="";this.dU=
0;this.FR=!1;this.Wk=null},C$=function(a,b){var c=a.JT[b];c||(c=a.JT[b]=new z.yF,a.ba("new_note_list",c,a));return c},Iva=function(a,b){if(!b)return!1;var c=b.ia();if(a.content==c.substring(a.startIndex,a.endIndex))return!0;var d=new RegExp(z.za(a.content),"gi"),e=d.exec(c),c=e&&d.exec(c);return e&&!c?(c=a.endIndex-a.startIndex,a.startIndex=e.index,a.endIndex=e.index+c,a.content=e[0],!0):!1},D$=function(a,b,c){var d=b.va(),e=b.Re(),g=C$(a,b.Mc()),h=g?g.indexOf(b):-1,k=b.Nz();b.gt(c);"HIDDEN"==c?a.aa.remove(b):
b=z.gF(a.aa,b);var n=g?g.indexOf(b):-1;return{yi:a.kl.put(a.l.s(z.Zja,{postId:d,noteId:e}),{state:c}),HA:function(){b.gt(k);-1==n&&(-1==h?g.add(b):z.AF(g,b,h))}}},E$=function(a,b,c,d,e,g){var h=r$(a.Kl(c,e)),k=z.Ja(h,function(a){return a.ps()==b}),n=h[k];"HIDDEN"==g&&z.Na(h,k);c=a.l.s(z.bka,{postId:d,noteId:c,replyId:b});a=a.kl.put(c,{state:g});var p=z.Ja(h,function(a){return a.ps()==b});return{yi:a,HA:function(){-1==p&&z.Ta(h,k,0,n)}}},Jva=function(a,b,c){this.range=a;this.anchor=b;this.Kr=b.getAttribute("name");
this.highlight=c},F$=function(a,b,c){z.R.call(this);this.I9=b;this.W8=c;this.xa=a.get("screen");this.Ba=a.get("screen-request")},G$=function(a){z.R.call(this);this.ea=null;this.Ba=a.get("screen-request");this.X=a},Kva=function(){},wwa=function(a){this.cD=a},H$=function(a,b){return b?z.Qt(a.cD,b):null},xwa=function(a,b,c){Hva(a.cD,function(a){var e=a.getAttribute("name");e&&b.call(c,a,e)})},ywa=function(a,b){return z.Bf(a.cD,b)?a.cD:null},I$=function(a,b,c,d,e){z.eZ.call(this,a,b);this.Ga(new z.SX(c));
this.Ga(new z.OZ(!1));this.Ga(new z.RZ(a));this.Ga(new z.fZ);this.Ga(new z.UZ(!1));this.Ga(new z.l_(d,!0));this.qg=!0;this.kj=d;this.kl=a.get("request");this.ha=a.get("dialog");this.WJ=e;this.U()},zwa=function(){return(0,z.B)("Write a note…")},J$=function(a,b,c,d,e){I$.call(this,a,b,e||"Leave a note",400,d||null);this.Fa=c;this.l=a.get("route-builder");this.Od=a.get("notes-data")},K$=function(a,b,c,d,e,g){I$.call(this,a,b,"Leave a reply…",200,d);this.l=a.get("route-builder");this.Od=a.get("notes-data");
this.Fa=c;this.wU=g||null;this.nd=e},Bwa=function(a,b,c){var d='\x3cdiv class\x3d"quoteResponses js-quoteResponses"\x3e',e=a.quotes.length,g=a.Gj.length||a.mQ;b=a.notes.length||a.HG;if(e||g||b){if(e){var e='\x3cdiv class\x3d"quoteResponses-section"\x3e'+z.F(z.sy({title:(0,z.M)(z.F((0,z.B)("Highlights"))+" ("+z.C(a.quotes.length)+")"),Cd:!0},c)),h;h={WZ:a.quotes,mha:!0};for(var k='\x3cdiv class\x3d"js-quotesList"\x3e'+(h.mha?"":z.F(z.sy({title:(0,z.M)(""+z.F((0,z.B)("Highlights"))),Cd:!0,Dc:(0,z.M)(""+
z.F(z.qy({href:(0,z.L)(""+z.H((0,z.Qo)("https://medium.com/the-story/introducing-highlights-a4df69e8ed43"))),moreText:"Learn more",Ub:!0},c)))},c))),n="list list--quotes list--short"+(h.WZ.length?"":" is-empty"),n=(0,z.M)(n),k=k+('\x3cul class\x3d"'+z.G(n)+'"\x3e'),n=h.WZ,p=n.length,u=0;u<p;u++){for(var x=n[u],I="",J=x.quotes,O=J.length,S=0;S<O;S++)I+=""+J[S].quoteId+(S!=O-1?",":"");I=z.E(I);k+='\x3cli class\x3d"list-item list-item--inline" data-quote-ids\x3d"'+z.G(I)+'" data-quote-creator-id\x3d"'+
z.G(x.user.userId)+'" data-action\x3d"highlight-quote" data-action-type\x3d"hover"\x3e'+z.F(z.iy(z.D(h,{user:x.user,mm:!0}),c))+"\x3c/li\x3e"}h=(0,z.B)(k+"\x3c/ul\x3e\x3c/div\x3e");e=e+z.C(h)+"\x3c/div\x3e"}else e="";g?(g='\x3cdiv class\x3d"quoteResponses-section'+(a.mQ?" is-withEditor":"")+'"\x3e'+z.F(z.sy({title:(0,z.M)(""+z.F((0,z.B)("Responses"))),Cd:!0},c)),a.mQ&&c.supportsEdit&&c.isAuthenticated?(h={},h=(0,z.B)('\x3cdiv class\x3d"js-inlineNewPostControl inlineNewPostControl inlineNewPostControl--quoteResponses blockGroup blockGroup-list"\x3e'+
z.XZ(z.D(h,{user:c.currentUser,isCollapsed:!0,Es:!0,type:"quoteResponses",cq:(0,z.M)(""+z.F((0,z.B)("Respond here…")))}),c)+"\x3c/div\x3e"),h=z.C(h)):h="",g=g+h+Awa(a,0,c)+"\x3c/div\x3e"):g="";d+=e+g;if(a.rfa&&b){d+='\x3cdiv class\x3d"quoteResponses-section quoteResponses-section--fullBleed"\x3e';b="";g=a.post.homeCollection;g=""+("Private notes are visible to you"+(a.post.creator.userId!=c.currentUser.userId?", the author,":"")+" and the editors of "+(g?z.C(g.name):"any publication this story is added\x26nbsp;to")+
".");g=(0,z.B)(g);g=""+z.C(g);g=(0,z.M)(g);b+='\x3cspan data-tooltip\x3d"'+z.G(g)+'"\x3eWho can see this?\x3c/span\x3e';g={};g=(0,z.B)(z.qx(z.D(g,{name:"lock",size:"19px",content:(0,z.M)('\x3csvg class\x3d"svgIcon-use" width\x3d"19" height\x3d"19" viewBox\x3d"0 0 19 19" \x3e\x3cpath d\x3d"M14 14.052a1 1 0 0 1-.992.998H5.992A.99.99 0 0 1 5 14.052v-4.004a1 1 0 0 1 .992-.998h7.016a.99.99 0 0 1 .992.998v4.004zM7 5.445C7 4.187 8.114 3.15 9.5 3.15c1.385 0 2.5 1.04 2.5 2.295V8.05H7V5.445zm6.008 2.605H13V5.445c0-1.822-1.578-3.295-3.5-3.295C7.577 2.15 6 3.618 6 5.445V8.05h-.008A2 2 0 0 0 4 10.048v4.004a1.99 1.99 0 0 0 1.992 1.998h7.016A2 2 0 0 0 15 14.052v-4.004a1.99 1.99 0 0 0-1.992-1.998z" fill-rule\x3d"evenodd"/\x3e\x3c/svg\x3e')})));
b={YP:(0,z.M)(""+z.C(g)),title:(0,z.M)(""+z.F((0,z.B)("Private notes"))),Cd:!0,Dc:(0,z.M)(b),F:"heading--privateNotes"};b=(0,z.B)(z.oy(z.D(b,{Hh:(0,z.M)(""+z.py(b,c)),jea:!0})));b=d+=z.C(b);d=""+('\x3cdiv class\x3d"privateNotes-list js-notesList'+(a.HG?" is-showingNoteEditor":"")+(0==a.notes.length?" is-empty":"")+'"\x3e');g=a.notes;e=g.length;for(h=0;h<e;h++)d+=L$({note:g[h],post:a.post,ZA:a.ZA},0,c);a.HG?(a=a.post.creator,a=(0,z.B)(c.currentUser.userId==a.userId?"Leave yourself a note":"Send "+
z.C(a.name)+" a private note…"),a='\x3cdiv class\x3d"privateNotes-actions js-noteActions"\x3e'+z.F(z.uw({action:"show-note-editor",text:(0,z.M)(""+z.C(a)),F:"privateNotes-prompt"},0,c)),c=(0,z.B)('\x3cdiv class\x3d"privateNotes-editor"\x3e'+z.F(z.jy({user:c.currentUser,je:!0},c))+'\x3cdiv class\x3d"js-noteEditor"\x3e\x3c/div\x3e\x3cdiv class\x3d"buttonSet"\x3e'+z.F(z.uw({action:"save-note",isPrimary:!0,F:"js-saveNoteButton",text:(0,z.M)(""+z.F((0,z.B)("Send")))},0,c))+z.F(z.uw({action:"hide-note-editor",
text:(0,z.M)(""+z.F((0,z.B)("Cancel")))},0,c))+"\x3c/div\x3e\x3c/div\x3e"),c=a+c+"\x3c/div\x3e"):c="";c=(0,z.B)(d+("\x3c/div\x3e"+c));d=b+('\x3cdiv class\x3d"quoteResponses-inner privateNotes"\x3e'+c+"\x3c/div\x3e\x3c/div\x3e")}}else 0<a.Iw&&(d+='\x3cdiv class\x3d"quoteResponses-section quoteResponses-section--fullBleed quoteResponses-section--tips u-textAlignCenter"\x3e\x3cdiv class\x3d"quoteResponses-section--tipsInner u-alignMiddle"\x3e'+z.F(z.xw({ub:!0,qe:!0,ca:!0,action:"previous-highlight-tip",
icon:(0,z.M)(""+z.F(z.ux())),title:(0,z.M)("Show previous tip")},c))+"\x3cdiv class\x3d'u-alignBlock quoteResponses-section--tipsContent js-highlightTip'\x3e\x3c/div\x3e"+z.F(z.xw({ub:!0,qe:!0,ca:!0,action:"next-highlight-tip",icon:(0,z.M)(""+z.F(z.vx())),title:(0,z.M)("Show next tip")},c))+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e");return(0,z.B)(d+"\x3c/div\x3e")},Awa=function(a,b,c){return(0,z.B)(z.F(z.YR({source:"quoteResponses",count:a.Gj.length,posts:a.Gj,nc:!0,dd:!0,Gg:!0,UN:!0,Iea:!0,hg:!0,Ue:!0,
mda:!0},c)))},L$=function(a,b,c){var d,e=null==a.note.replies?null:a.note.replies.length,g=null==a.note.replyId,h=a.post.creator.userId==c.currentUser.userId,k=a.post.creator.userId==a.note.author.userId;d=a.note.author.userId==c.currentUser.userId;b=h||(null==a.post.homeCollection?null:a.post.homeCollection.virtuals.permissions.canEditPosts);var n=""+(g?"js-note-item"+(a.note.noteId?" js-note-"+a.note.noteId:""):"js-reply-item"+(a.note.replyId?" js-reply-"+a.note.replyId:"")),n=z.E(n),p="",h='\x3cdiv class\x3d"privateNotes-item '+
z.G(n)+' js-note" data-note-id\x3d"'+z.G(a.note.noteId)+'"\x3e'+(g?z.F(z.iy({user:a.note.author},c)):z.F(z.gy({user:a.note.author},c)))+'\x3cdiv class\x3d"privateNotes-authorLockup"\x3e\x3cdiv class\x3d"privateNotes-author"\x3e'+z.F(z.Iw({user:a.note.author},c))+(g||!(h||d||(null==a.post.homeCollection?0:a.post.homeCollection.virtuals.permissions.canEditPosts))||k||a.CY?"":'\x3cspan class\x3d"privateNotes-author--supplemental"\x3e '+z.F((0,z.B)("(Editor)"))+"\x3c/span\x3e")+'\x3c/div\x3e\x3cdiv class\x3d"privateNotes-supplemental"\x3e'+
z.F(z.Dq(Number(a.note.createdAt),c))+'\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"privateNotes-content js-privateNotesContent"\x3e',k=z.F(z.or(String(a.note.content),c)),n=String(k).replace(/(\r\n|\r|\n)/g,"\x3cbr\x3e"),k=z.am(k,z.fm)?(0,z.B)(n,z.bm(k)):n;d=p+(h+k+"\x3c/div\x3e"+(d?Cwa({note:a.note,isPrimary:g},c):""));if(g){d+='\x3cdiv class\x3d"privateNotes-replies'+(e?"":" is-empty")+' js-repliesList"\x3e';if(e)for(e=a.note.replies,g=e.length,p=0;p<g;p++)h=e[p],d+=L$({note:h,post:a.post,CY:a.note.author.userId==
h.author.userId},0,c);e=d;g="\x3c/div\x3e"+(a.ZA?(0,z.B)('\x3cdiv class\x3d"privateNotes-editor privateNotes-editor--reply"\x3e'+z.F(z.hy({user:c.currentUser,je:!0},c))+'\x3cdiv class\x3d"js-replyEditor"\x3e\x3c/div\x3e\x3cdiv class\x3d"buttonSet"\x3e'+z.F(z.uw({action:"save-reply",isPrimary:!0,text:(0,z.M)(""+z.F((0,z.B)("Send")))},0,c))+z.F(z.uw({action:"hide-reply-editor",text:(0,z.M)(""+z.F((0,z.B)("Cancel")))},0,c))+"\x3c/div\x3e\x3c/div\x3e"):"")+'\x3cdiv class\x3d"privateNotes-actions'+(b?
" privateNotes-actions--withDismiss":"")+' u-clearfix"\x3e';d=a.ZA?'\x3cdiv class\x3d"u-floatLeft"\x3e'+(0,z.B)(z.F(z.uw({isPrimary:!0,action:"show-reply-editor",F:"privateNotes-prompt",text:(0,z.M)(""+z.F((0,z.B)("Reply")))},0,c)))+"\x3c/div\x3e":"";d=e+(g+d+(b?'\x3cdiv class\x3d"u-floatRight"\x3e'+Cwa({note:a.note,isPrimary:!0,kY:!0},c)+"\x3c/div\x3e":"")+"\x3c/div\x3e")}return(0,z.B)(d+"\x3c/div\x3e")},Cwa=function(a,b){return(0,z.B)(z.F(z.uw({actionValue:a.isPrimary?a.note.noteId:a.note.replyId,
action:a.kY?"dismiss-note":a.isPrimary?"delete-note":"delete-reply",F:"privateNotes-delete js-deleteNote",text:(0,z.M)(""+(a.kY?z.F((0,z.B)("Dismiss note")):z.F((0,z.B)("Delete"))))},0,b)))},Dwa=function(a,b,c){return(0,z.B)(0==a.mf?(1==a.Iw?"People":z.C(a.Iw)+" people")+' highlighted this passage. You can click on an existing highlight to add to it, like below:\x3cimg class\x3d"quoteResponses-tipAnimation" src\x3d"'+z.G(z.Lm(z.pr("/img/help/highlight-tips-2.gif",c.fp)))+'"\x3e':1==a.mf?'Or, select any passage to create your own highlight and tell the author and others what resonated with you:\x3cimg class\x3d"quoteResponses-tipAnimation" src\x3d"'+
z.G(z.Lm(z.pr("/img/help/highlight-tips-1.gif",c.fp)))+'"\x3e':2==a.mf?z.F(z.V({kd:!0,Vb:!0,source:"highlight_tip",C:"Sign in to create a profile",href:(0,z.L)(""+z.H(z.Xo(c)))},c))+" so that you can save your highlights and share them with others.":"")},M$=function(a,b,c,d,e,g,h,k){z.R.call(this);this.X=a;this.ga=a.get("butter-bar");this.za=b;this.nd=c;this.rh=e;this.uc=a.get("quotes-data");this.Od=a.get("notes-data");this.Vg=a.get("responses-data");this.Ed=g;this.WJ=d;this.AK=(this.wy=h)?h.Bg():
null;this.he=this.pd=null;this.yh={};this.SS=!!z.$k();this.TS=!!z.bl();this.pu=this.SS&&this.TS&&z.WG(b);this.Am=null;this.xC=0;this.oV=tva(this.uc,this.nd);this.Yq=k;this.Ia(this.hx())},Ewa=function(a){a.ib(".js-block").forEach(function(a){this.pa(a,"mouseenter",this.Z4,this);this.pa(a,"mouseleave",this.EL,this)},a)},Fwa=function(a){a.ib(".js-note").forEach(function(a){this.pa(a,"mouseenter",this.X4,this);this.pa(a,"mouseleave",this.EL,this)},a)},Gwa=function(a,b){var c=a.query(".js-note-"+b);a.yh[b]||
(a.yh[b]=new K$(a.X,c.querySelector(".js-replyEditor"),a.za.va(),b,a.nd),z.Xu(a,a.yh[b],"saving",a.R7,a),z.Xu(a,a.yh[b],"save",a.M7,a),z.Xu(a,a.yh[b],"fail",a.U6,a));z.t(c,"is-noteEditorVisible");a.yh[b].focus()},Hwa=function(a,b){var c=a.yh[b];c&&(c.Ea()&&c.ed(""),c=a.query(".js-note-"+b),z.Qc(c,"is-noteEditorVisible"))},Iwa=function(a,b,c){var d=H$(a.Ed,a.nd);if(d){var e=[];a.Yq&&(e=a.Yq.quotes.map(function(a){return a.Bg()}));(0,z.pb)(d.querySelectorAll(".markup--quote"),function(a){var d=a.getAttribute("data-creator-ids").split(" "),
d=z.Ma(d,b);if(this.Yq)var k=a.getAttribute("name").split(" "),d=d&&(0,z.Bc)(k,z.Ma.bind(null,e));z.Sc(a,"is-selected",c&&d)},a)}},N$=function(a){return(a=z.It(a,function(a){return z.Mc(a,"js-note-item")}))&&a.getAttribute("data-note-id")},Jwa=function(a,b,c,d){b=new z.LD(b,300);b.Ia(c);b.subscribe("dismiss",d,a);b.U();return b},O$=function(a){var b=a.Db(),c=a.pc();a=a.cd();1<b.length&&(a=b[0].ia().length);var d=new z.Xq;d.hq(b[0].getName());d.lf(c);z.y(d,"endIndex",a);d.ed(b[0].ia().substring(c,
a));return d},P$=function(a,b){var c=b%3;0>c&&(c=2);a.xC=c;(c=a.query(".js-highlightTip"))&&z.P(c,Dwa,{mf:a.xC,Iw:a.oV})},Q$=function(a,b,c,d){z.R.call(this);this.Ia(this.hx(d));this.$a=a.get("dom-monitor");this.za=b;this.XS=!b.Za().Cp()||b.td();this.Fa=b.va();this.Ed=c;this.uc=a.get("quotes-data");this.Vg=a.get("responses-data");this.Od=a.get("notes-data");this.Kq=null;this.Hf={}},Kwa=function(a,b){b.forEach(function(a){a&&R$(this,a)},a)},R$=function(a,b){if(!a.Kq)if(H$(a.Ed,b)){var c=Lwa(a,b),c=
Mwa(a,c),c=Nwa(a,c),c=Owa(a,c);a.Hf[b]=c;Pwa(a,b)}else delete a.Hf[b]},Qwa=function(a,b){if(!a.Kq){var c=a.Hf[b];if(c){var d=c.length,c=Nwa(a,c),c=Owa(a,c);a.Hf[b]=c;d!=c.length?Pwa(a,b):c.forEach(function(a){a.ua&&a.offsetTop&&(a.ua.style.top=a.offsetTop+"px")})}}},Rwa=function(a,b,c){return z.Ka(a.Hf[b]||[],function(a){return a.ua==c})},Lwa=function(a,b){var c=[];C$(a.Od,b).bf(function(a){var e=a.Iv(),g=void 0;e?(g=this.Od.jF(e),e=g.Ka(),g=z.w(g,"endIndex")):(e=0,g=a.Ea().length);c.push({anchor:b,
startIndex:e,endIndex:g,notes:[a],quotes:[],Gj:[]})},a);if(a.XS)return c;(a.uc.Po[b]||[]).forEach(function(a){var e=Swa(a);c.push({anchor:b,startIndex:e.startIndex,endIndex:e.endIndex,notes:[],quotes:[a],Gj:[]})},a);q$(a.Vg,b).forEach(function(a){var e=o$(a);e&&(e=p$(e)&&p$(e).xk())&&(e=Swa(e),c.push({anchor:b,startIndex:e.startIndex,endIndex:e.endIndex,notes:[],quotes:[],Gj:[a]}))},a);return c},Mwa=function(a,b){var c=[];b.sort(function(a,b){return a.startIndex-b.startIndex});b.forEach(function(a){var b=
z.Ja(c,function(b){return b.endIndex>=a.startIndex-1&&b.startIndex<=a.endIndex+1});0<=b?this.Yx(c[b],a):c.push(a)},a);return c},Owa=function(a,b){var c=[];b.forEach(function(a){if(a.offsetTop){var b=z.Ja(c,function(b){return 30>=Math.abs(b.offsetTop-a.offsetTop)});0<=b?this.Yx(c[b],a):c.push(a)}},a);return c},Pwa=function(a,b){a.ib(".js-paragraphControl-"+b).forEach(z.uf);a.Hf[b]=a.Hf[b].map(function(a){var b=Twa(this,a),b=z.lt(Uwa,b);b.style.top=a.offsetTop+"px";a.ua=b;this.W().appendChild(a.ua);
z.t(b,"is-visible");return a},a)},Twa=function(a,b){var c=b.notes,d=b.Gj,e=n$(a.uc,b.quotes),g=d?d.length:0,h=c?c.length:0,k=0,n=0,p=0,u=!1,x=!1,I={},J={},O=z.Yk().userId,S=a.za.Za().Be().Sa();c.forEach(function(a){var b=a.$r();b&&((a=r$(a))&&a.forEach(function(a){h++;a.author&&(a.author.userId==O&&k++,a.author.social&&a.author.social.isFollowing&&(I[a.author.userId]=a.author),J[a.author.userId]=!0)}),J[b.userId]=!0,b.userId==O&&k++,b.userId==S?n++:p++,b.social&&b.social.isFollowing&&(I[b.userId]=
b))});e.forEach(function(a){a=a.user;J[a.userId]=!0;a.userId==O&&(u=!0);a.social&&a.social.isFollowing&&(I[a.userId]=a)});d.forEach(function(a){a=a.Be();J[a.userId]=!0;a.userId==O&&(x=!0);a.social&&a.social.isFollowing&&(I[a.userId]=a)});c=b.quotes.filter(function(a){return"anon"==a.Sa()});return{postId:a.Fa,Kr:b.anchor,pfa:h,Tfa:g,Vs:x,Ms:k,xZ:n,qfa:p,vsa:e.length,Ts:u,fY:Object.keys(J).length,Bda:z.db(I),Iw:c.length}},Swa=function(a){var b=a.pc(),c=a.cd();1<a.paragraphs.length&&(c=a.paragraphs[0].text.length);
return{startIndex:b,endIndex:c}},Nwa=function(a,b){var c=z.du();return b.map(function(a){var b=this.Ed.get(a.anchor),g=this.za.Ag(b);if(!g)return a;var h=void 0;4==g.type&&(g.ia()&&(h=b.querySelector("figcaption")),h||(h=b));if(!h){for(var g=a.startIndex+1,b=[b],h=0,k=null;0<b.length&&h<g;)if(k=b.pop(),!(k.nodeName in z.$S))if(3==k.nodeType)var n=k.nodeValue.replace(/(\r\n|\r|\n)/g,"").replace(/ +/g," "),h=h+n.length;else if(k.nodeName in z.aT)h+=z.aT[k.nodeName].length;else for(n=k.childNodes.length-
1;0<=n;n--)b.push(k.childNodes[n]);h=k}g=z.hu(h,!0);a.offsetTop=Math.round(g.top+c.top);return a},a)},Uwa=function(a,b,c){b=z.B;var d='\x3cdiv class\x3d"paragraphControls js-paragraphControl js-paragraphControl-'+z.G(a.Kr)+' u-noUserSelect"\x3e',e=z.B,g;if(a.pfa||a.Tfa){g='\x3cdiv class\x3d"notesMarker u-noUserSelect" data-action\x3d"select-anchor" data-action-value\x3d"'+z.G(a.Kr)+'"\x3e';var h;h={};h=(0,z.B)(z.qx(z.D(h,{name:"asteriskFilled",size:"19px",content:(0,z.M)('\x3csvg class\x3d"svgIcon-use" width\x3d"19" height\x3d"19" viewBox\x3d"0 0 19 19" \x3e\x3cpath d\x3d"M14.78 8.07a8.681 8.681 0 0 0-.427-1.383.478.478 0 0 0-.584-.27l-3.12.77V4.034c0-.247-.19-.48-.43-.5a7.23 7.23 0 0 0-1.38 0c-.24.02-.43.253-.43.5V7.19L5.3 6.415a.48.48 0 0 0-.583.27c-.18.448-.324.91-.426 1.383-.05.24.1.5.32.58l3.06.754-1.98 2.956c-.14.196-.13.502.04.67.34.332.7.632 1.09.896.2.136.49.077.63-.117l2.09-3.114 2.09 3.112c.15.193.43.252.63.116.39-.26.75-.56 1.09-.89.17-.17.19-.47.04-.67L11.4 9.41l3.06-.76a.517.517 0 0 0 .32-.58" fill-rule\x3d"evenodd"/\x3e\x3c/svg\x3e')})));
g=g+z.C(h)+"\x3c/div\x3e"}else g="";var k;h=""+(1==a.Ms?"a note":"notes");h=z.E(h);k=""+(1==a.fY&&(0<a.Ms||a.Ts||a.Vs)?0<a.Ms&&a.Ts&&a.Vs?" highlighted, responded, and left "+h:0<a.Ms&&a.Vs?" responded and left "+h:0<a.Ms&&a.Ts?" highlighted and left "+h:a.Ts&&a.Vs?" highlighted and responded":a.Ts?" highlighted":0<a.Ms?" left "+h:a.Vs?" responded":"":"");k=z.E(k);h='\x3cspan class\x3d"paragraphControls-itemText"\x3e';c=""+(0<a.xZ&&0==a.qfa&&!a.Ts&&!a.Vs?1==a.xZ?"Note to self":"Notes to self":z.F(z.GR(z.D(a,
{social:a.Bda,isActive:0<a.Ms||a.Ts||a.Vs,ig:a.fY,YN:!0,xfa:!0,BW:0<a.Iw?"Top highlight":""}),c))+z.C(k));c=(0,z.M)(c);h+=z.F(z.OQ(z.D(a,{text:c})))+"\x3c/span\x3e";a=(0,z.B)(h);a=e(g+a);return b(d+a+"\x3c/div\x3e")},S$=function(a,b,c){z.R.call(this);this.X=a;this.N3=a.get("floating-components");this.xa=a.get("screen");this.Pa=a.get("screen-service");this.si=a.get("uri-fragment");this.$a=a.get("dom-monitor");this.za=b;this.Oc=b.Oc;this.Ef=this.Oc.querySelector(".js-postField");var d=z.fT("div","layoutSingleColumn notesPositionContainer");
z.dT(this.Oc,d,0);this.YT=d;this.uc=a.get("quotes-data");this.Od=a.get("notes-data");this.Od.subscribe("new_note_list",this.l7,this);this.Vg=a.get("responses-data");this.Zi=null;this.Ed=new wwa(this.Oc.querySelector(".js-notesSource"));this.Wx=this.Hf=this.PD=null;this.Hf=new Q$(a,b,this.Ed,this.YT);this.track(this.Hf);this.Wx=this.Hf.W();this.$i=this.HJ=null;this.Gd=c},U$=function(a,b){if(a.isActive()){var c=(b=b||a.HJ)&&b.AF,d=b&&b.noteId;c&&(a.sr(c),d&&a.Od.Kl(d,c)&&a.$i&&z.q(a.$i,function(){T$(this,
c,null,d)},a));qva(a.si)}else a.HJ=b||null},T$=function(a,b,c,d,e,g){var h={gg:!0,TN:767>=window.innerWidth};a.IK();c=new M$(a.X,a.za,b,d||"",c||null,a.Ed,e||null,g||null);c.subscribe("set-active-highlight",a.KU,a);c.subscribe("reset-highlight",a.P9,a);c.subscribe("close",a.IK,a);b=g&&g.ua?g.ua:a.Ed.get(b);g=z.mK(a.N3);g.gk=b;b=g.qq(c);b.Ty=h;h=b.aH(a.bk.bind(a));h.ID=!0;a.Zi=h.U()},Vwa=function(a,b,c){var d=a.za.Ag(H$(a.Ed,b));if(d&&4!=d.type){z.Sn(d,4);if(c){if(!Iva(c,d))return;z.Qn(d,z.Wn(c.startIndex,
c.endIndex,c.id))}c={mode:a.za.td()?"edit":"view",gh:z.Ip(a.za.Za()),media:null,Qi:null,sections:!0,Oi:!1,xi:!1,vf:!1};a.Ed.get(b).innerHTML=z.Kq(d,z.v,c)}},Wwa=function(a,b){var c=z.Ug();if(!c||c.isCollapsed())if(b&&(c=b),!c||c.isCollapsed())return null;var d=z.Wf(c),e=ywa(a.Ed,d);if(!e)return null;e=(d=z.It(d,z.AC,e))&&a.za.Ag(d);if(!d)return null;var g=z.ku(c,d,!0),h=z.ku(c,d,!1);return-1==g||-1==h?null:new Jva(c,d,new z.Xq({anchor:d.getAttribute("name"),startIndex:g,endIndex:h,content:e.ia().substring(g,
h)}))},Xwa=function(){},Ywa=function(a,b,c){a=a||{};b=z.B;var d='\x3cdiv class\x3d"container u-maxWidth740"\x3e\x3cdiv class\x3d"responsesStreamWrapper u-maxWidth640 u-hide js-responsesStreamWrapper"\x3e\x3cdiv class\x3d"container u-maxWidth640 responsesStream-title"\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col u-size12of12"\x3e'+z.F(z.ry({title:"Responses",zn:!0},c))+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e";if(c.supportsEdit){var e=a;a=z.B;c.isAuthenticated?e=z.F(z.YZ({cq:(0,z.M)(""+(e.post.virtuals.responsesCreatedCount?
z.F(z.rT()):z.F(z.qT())))},c)):(e=e||{},e=(0,z.B)('\x3cdiv class\x3d"responses-loggedOutPrompt js-responsesLoggedOutPrompt"\x3e'+z.F(z.xw({icon:(0,z.M)(""+z.F(z.Ux())),ca:!0,Vb:!0,Jd:(0,z.L)(""+z.H(z.Ro(z.D(e,{uG:!0}),0,c))),text:(0,z.M)(""+z.F(z.rT())),F:"button--loggedOutPrompt",source:"logged_out_response_prompt"},c))+"\x3c/div\x3e"));a='\x3cdiv class\x3d"container u-maxWidth640 responsesStream-editor cardChromeless"\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col u-size12of12"\x3e'+a(e)+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"}else a=
"";return b(d+a+'\x3cdiv class\x3d"responsesStream js-responsesStream"\x3e\x3c/div\x3e\x3cdiv class\x3d"container u-maxWidth640 u-hide js-showOtherResponses"\x3e\x3cdiv class\x3d"row"\x3e'+z.F(z.tw({action:"show-other-responses",C:(0,z.M)(""+z.F((0,z.B)("Show all responses"))),isPrimary:!0,F:"responsesStream-showOtherResponses cardChromeless u-sizeFullWidth"},c))+'\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"responsesStream js-responsesStreamOther"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e')},V$=function(a){z.R.call(this);
this.Ba=a.get("screen-request");this.ea=null;this.QL=a.get("screen-view-state");this.X=a;this.eL=!1;this.jK=this.pd=null},W$=function(a,b,c,d){z.R.call(this);this.vD=c;this.$o=null;this.za=d;this.AS=!1;this.Xb=a.get("element-tracker");this.OB=z.hu(this.za.Ef).height;this.Ia(this.hx(b))},X$=function(a){z.R.call(this);this.za=this.ea=null;this.o9=a.get("related-reads-data-manager");this.xa=a.get("screen");this.Aa=null;this.X=a},Y$=function(a,b){z.R.call(this);this.ea=a;this.raa=b;this.JU=this.gx=!1};
z.da(l$,z.$h);l$.prototype.Lh=function(a){var b={};z.hJ(this,b,a.Bb(),"");return b};
l$.prototype.mb=function(a,b){if(!a||!b)return null;var c=new a;Object.keys(b).forEach(function(a){for(var e=a.split(/[\[\]]+/).filter(function(a){return!!a}),g=c,h=void 0;h=e.shift();){var k=g.D.rk[h];if(!k)break;var n=k.g();if(k.Z()){var p=z.Li(g,h)||[],u=e.shift(),x=Number(u);if(void 0===u||!Number.isInteger(x)||0>x)break;if(n.prototype instanceof z.ii)k=p[x],k||(k=new n,p[x]=k),z.y(g,h,p),g=k;else{if(void 0!==e.shift())break;n=iva(b[a],k);p[x]=n;z.y(g,h,p)}}else if(n.prototype instanceof z.ii)p=
z.Li(g,h),p||(p=new n,z.y(g,h,p)),g=p;else{if(void 0!==e.shift())break;n=iva(b[a],k);z.y(g,h,n)}}});return c};z.m(m$,z.A);m$.prototype.J=function(){return""};m$.prototype.L=function(){return""};m$.prototype.N=function(){return m$.prototype};
m$.prototype.D={name:"PlacementsRequestQuery",fields:{requestContext:{name:"requestContext",g:function(){return z.qH},h:function(){return 1},j:function(){return"PlacementsRequestContext"},defaultValue:function(){}},slots:{name:"slots",g:function(){return z.eJ},Z:z.X,h:function(){return 2},j:function(){return"PlacementSlot"},defaultValue:function(){}}},O:{}};z.eZ.prototype.BG=z.Y(460,function(a){a!=this.IC&&this.Ra&&(this.Ra.Bf.contentEditable=a);this.IC=a});
z.IJ.prototype.hN=z.Y(452,function(a){a=o$(a);if(!a)return null;a=p$(a)&&p$(a).xk();return a?(a=a.Db())&&a.length?a[0].getName():null:null});z.iJ.prototype.Kz=z.Y(448,function(a){a=this.l.s(z.Lka,{postId:a});return z.lJ(this,a)});
z.oJ.prototype.Kz=z.Y(447,function(a){var b=this;return z.q(this.Ba.Kz(a),function(a){a=z.Qa(a.posts);var d={};z.cl(z.v).enable_related_reads_footer_grid_ui&&a&&(d.footerGrid=a.length>=b.au.footerGrid?z.Ta(a,0,b.au.footerGrid):null);(z.cl(z.v).enable_read_next_in_metabar||z.cl(z.v).enable_read_next_mobile_carousel)&&a&&(d.metabar=z.Ta(a,0,b.au.metabar));(z.cl(z.v).enable_related_reads_side_card||z.cl(z.v).enable_related_reads_side_card_fixed||z.cl(z.v).enable_read_next_mobile_carousel)&&a&&(d.sideCard=
z.Ta(a,0,b.au.sideCard));(z.cl(z.v).enable_related_reads_header_promo||z.cl(z.v).enable_read_next_mobile_carousel)&&a&&(d.topCard=z.Ta(a,0,b.au.topCard));(z.cl(z.v).enable_related_reads_footer_promo||z.cl(z.v).enable_related_reads_footer_promo_always_shown||z.cl(z.v).enable_read_next_mobile_carousel)&&a&&(d.bottomCard=z.Ta(a,0,b.au.bottomCard));return d},this)});z.YD.prototype.aH=z.Y(426,function(a){this.bk=a;return this});z.lK.prototype.aH=z.Y(425,function(a){this.bk=a;return this});
z.pv.prototype.Kl=z.Y(332,function(){return z.w(this,"note")});z.bJ.prototype.Kl=z.Y(331,function(a){return this.hb("Note",a)});z.Vq.prototype.ps=z.Y(330,function(){return z.w(this,"replyId")});z.pv.prototype.ps=z.Y(329,function(){return z.w(this,"replyId")});z.Tq.prototype.bt=z.Y(328,function(a){return z.y(this,"highlight",a)});z.Tq.prototype.jF=z.Y(327,function(){return z.w(this,"highlight")});z.Tq.prototype.gm=z.Y(326,function(a){return z.y(this,"author",a)});
z.Vq.prototype.gm=z.Y(325,function(a){return z.y(this,"author",a)});z.Av.prototype.gm=z.Y(324,function(a){return z.y(this,"author",a)});z.Tq.prototype.$r=z.Y(323,function(){return z.w(this,"author")});z.Vq.prototype.$r=z.Y(322,function(){return z.w(this,"author")});z.Av.prototype.$r=z.Y(321,function(){return z.w(this,"author")});z.Tq.prototype.Iv=z.Y(320,function(){return z.w(this,"highlightId")});z.Tq.prototype.Aw=z.Y(319,function(a){return z.y(this,"authorId",a)});
z.Vq.prototype.Aw=z.Y(318,function(a){return z.y(this,"authorId",a)});z.Tq.prototype.gt=z.Y(317,function(a){return z.y(this,"state",a)});z.Vq.prototype.gt=z.Y(316,function(a){return z.y(this,"state",a)});z.sv.prototype.gt=z.Y(315,function(a){return z.y(this,"state",a)});z.Tq.prototype.Re=z.Y(314,function(){return z.w(this,"noteId")});z.Vq.prototype.Re=z.Y(313,function(){return z.w(this,"noteId")});z.pv.prototype.Re=z.Y(312,function(){return z.w(this,"noteId")});
z.Hk.prototype.TA=z.Y(246,function(a){return z.y(this,"inResponseToPostId",a)});z.a_.prototype.TA=z.Y(245,function(a){this.Lx=a;return this});z.wj.prototype.qF=z.Y(183,function(){return z.w(this,"point")});s$.prototype.qF=function(){var a=window.document.body;return z.Bf(a,this.Vf.node)?this.Vf:this.fi&&z.Bf(a,this.fi)?z.lu(this.dD,this.fi):this.nd&&(a=z.Qt(this.K3,this.nd))?z.lu(this.dD,a):null};z.m(u$,z.Pf);
u$.prototype.GA=function(){if(!this.Bh)return null;var a=this.Bh.qF();if(!a)return null;var b=this.cj.qF();return b?z.Fg(a.node,a.offset,b.node,b.offset):null};z.m(w$,z.R);z.f=w$.prototype;z.f.Nh=function(){return this.il.Nh()};
z.f.V=function(){w$.R.V.call(this);z.Xu(this,this.QI,"data-redirect-type-quote",this.z6,this);this.pa(this.Oc,"click",this.Ex,this);z.XG(this.za)&&z.ot()&&this.pa(this.Oc,"mouseover",this.t4,this);this.za.Za().Cp()&&!this.za.td()&&z.r(this.uc.load(this.za.va()),z.Q);var a=this.Nh();a&&(z.Xu(this,a,"quote",this.o4,this),z.Xu(this,a,"quote-respond",this.p4,this),z.Xu(this,a,"show",this.FL,this),z.Xu(this,a,"hide",this.V6,this))};
z.f.z6=function(a){var b=z.TF(this.il,this.Nh().sl);b&&(a.url=new z.Yc(this.l.s(z.gM,{postId:this.za.va()},{paragraphs:JSON.stringify([b.vs.mb().Bb()]),startOffset:b.start,endOffset:b.end})))};z.f.Ex=function(a){z.It(a.target,function(a){if(a===this.Oc)return!0;var c=z.HC(a);if(3==c)return!0;if(7==c){if(c=Cva(this,a))if(x$(this,c),z.ot())z$(this,c);else{var d=new z.JD;Ava(this,c,a,d)}return!0}return!1}.bind(this))};
z.f.t4=function(a){z.It(a.target,function(a){if(a===this.Oc)return!0;var c=z.HC(a);if(3==c)return!0;if(7==c){c=z.Ug();if(!(c&&!c.isCollapsed()||this.Nh()&&this.Nh().Mi())&&(c=Cva(this,a))){var d=this.Oc.querySelector('.markup--quote[name~\x3d"'+c.Bg()+'"]');a=new z.LD(a,100);Ava(this,c,d,a);x$(this,c)}return!0}return!1}.bind(this))};
z.f.FL=function(){var a=z.Ug();a&&!a.isCollapsed()&&x$(this,null);z.XG(this.za)&&(a=z.TF(this.il,this.Nh().sl))&&(a=z.FF(this.uc,a.vs,a.start,a.end),z.Sc(this.Nh().oa().querySelector(".js-highlightMenuQuoteButton"),"is-active",!!a))};z.f.V6=function(){this.Pm&&x$(this,null)};
z.f.o4=function(){if(z.XG(this.za)){var a=z.NF(this.Nh());if(a){var b=a.range,c=a.Bea,d=z.Mc(this.Nh().oa().querySelector(".js-highlightMenuQuoteButton"),"is-active"),a=z.TF(this.il,b);z.r(z.q(this.uc.toggle(a.vs,a.start,a.end,!c),function(a){z.YS();d?z.PF(this.Nh()):z$(this,a);var b=c?"selection_menu":"quote_click_menu";A$(this,a.Bg(),!d,b)},this),z.Q)}}};
z.f.p4=function(){if(z.XG(this.za)&&z.v.supportsEdit){var a=z.NF(this.Nh());if(a){var b=z.TF(this.il,a.range);z.r(z.q(this.uc.create(b.vs,b.start,b.end,1,!0),function(a){A$(this,a.Bg(),!0,"selection_menu_quote_respond");this.ba("quote-respond",a,b.vs.name)},this),z.Q)}}};
z.f.A4=function(a){var b=this.Pm,c=y$(this,b),d=b.pc(),e=b.cd(),b=a.query(".js-quoteAttributions-pileOn"),g=z.Mc(b,"is-active");z.r(z.q(this.uc.toggle(c,d,e,!0),function(b){var k=a.query(".js-quoteAttributions-pileOn");z.Tc(k,"is-active");if(k=z.GF(this.uc,c,d,e)){var n=zva(this,k),p=a.query(".js-quoteAttributions-info");z.P(p,vva,n)}else a.Hb();!g&&z.ot()&&(a.Hb(),z$(this,k));k=z.ot()?"quote_hover":"quote_click_mobile";A$(this,b.Bg(),!g,k)},this),z.Q)};
z.f.B4=function(){if(z.XG(this.za)&&z.v.supportsEdit){var a=y$(this,this.Pm),b=this.Pm.pc(),c=this.Pm.cd();z.r(z.q(this.uc.create(a,b,c,1,!0),function(b){A$(this,b.Bg(),!0,"quote_respond");this.ba("quote-respond",b,a.name)},this),z.Q)}};
z.f.AU=function(){var a=new u$(this.Oc),b=this.uc.Po,c=Object.keys(b).concat(this.IR);z.Ua(c);c.forEach(function(a){var c=b[a]||[],g=this.za;if(g=(a=g.Oc&&z.Qt(g.Oc,a))&&this.za.Ag(a))uva(g,c),a.innerHTML=z.Kq(g,z.v,z.UG(this.za)),z.AK(this.f9,a)},this);this.IR=Object.keys(b);(a=a.restore())&&a.select()};z.m(B$,z.Uu);z.f=B$.prototype;z.f.load=function(a){if(!z.$k())return z.Gc([]);this.Fa=a;this.Wk||(this.Wk=z.r(z.q(this.kl.get(this.l.s(z.Xja,{postId:a}),{background:!0}),this.d9,this),z.Q));return this.Wk.hc()};
z.f.Ul=function(){return this.FR};z.f.Qv=function(){return this.dU};z.f.jF=function(a){return this.HS[a]||null};z.f.Kl=function(a,b){return z.oQ(C$(this,b),a)};z.f.bt=function(a,b){this.HS[a]=b};z.f.va=function(){return this.Fa};
z.f.d9=function(a){var b=a.references.User;this.dU=a.post.visibility;var c=a.value;if(c)for(var d=0;d<c.length;d++){var e=c[d];if("HIDDEN"!=e.state){var g=e.replies,h=b;if(g)for(var k=0;k<g.length;k++){var n=g[k],p=n.authorId||null;n.author=p&&h[p]||null}g=e.anchor;h=e.authorId||null;e.author=h&&b[h]||null;g=C$(this,g);e=z.Uq(e);g.add(z.gF(this.aa,e))}}if(a=a.highlights)for(b=0;b<a.length;b++)this.bt(a[b].id,z.Xi.mb(z.Xq,a[b]));this.FR=!0};z.da(F$,z.R);F$.prototype.V=function(){var a=this;z.R.prototype.V.call(this);z.q(nva(this.Ba,this.I9,this.W8),function(b){b.placements&&b.placements.forEach(a.e5,a)})};F$.prototype.e5=function(a){switch(a.location){case 1:var b=this.xa.query(".js-postFooterPlacements");z.P(b,z.jS,{items:a.items,context:2})}};z.da(G$,z.R);G$.prototype.Je=function(a){this.ea=a};G$.prototype.V=function(){var a=this;this.W()?(z.R.prototype.V.call(this),z.r(z.q(pva(this.Ba,this.ea.La()),function(b){z.P(a.W(),yva,{items:z.DF(b.Cf),context:9});var c=a.query(".js-relatedReadsStream");b=new z.wU(a.X,b.Cf);b.Ia(c);b.kg(9);a.track(b)}),z.Q)):z.Q("Attempted to initialize RelatedReadsStreamControl without root element.")};Kva.prototype.JE=function(a,b,c){return new w$(a,b,c)};wwa.prototype.get=function(a){return H$(this,a)};z.m(I$,z.eZ);z.f=I$.prototype;z.f.Gy=!1;z.f.lu="";z.f.Hy=0;z.f.Wl=z.X;z.f.Re=function(){return this.WJ};z.f.save=function(){this.Ea().length<=this.kj&&this.qr()};z.f.Ja=function(){(0,window.clearTimeout)(this.Hy);I$.R.Ja.call(this)};z.f.V=function(){function a(a){a.stopPropagation()}I$.R.V.call(this);this.lu=this.Ea();this.ed(this.lu);this.Jr(13,this.ZJ,this);this.Jr(27,this.$J,this);this.Ra.pa("blur",this.YJ,!1,this);var b=this.Ra.oa();z.Wt(b,"keydown",a);z.Wt(b,"keyup",a);z.Wt(b,"keypress",a)};
z.f.WO=function(a){return a};z.f.qr=function(){if(this.isEnabled()){var a=this.Ea().trim();if(a){this.BG(!1);var b=this.wX(),a=this.vX(a);this.ba("saving",a);z.yc(z.r(z.q(this.kl.post(b,a.Bb()),this.p7,this),this.n7.bind(this,a)),this.BG.bind(this,!0))}}};z.f.p7=function(a){this.ba("save",this.WO(a.value))};z.f.n7=function(a,b){this.ba("fail",a);this.ha.error((0,z.B)("Saving failed. You may be having connectivity issues or notes might be disabled on this post. Please try again."));z.Q(b)};
z.f.ZJ=function(a){if(this.fv&&this.fv.Xl())return!1;a.shiftKey||(a.preventDefault(),this.save());return!0};z.f.$J=function(a){if(this.fv&&this.fv.Xl())return!1;a.preventDefault();this.ed(this.lu);this.ba("cancel");return!1};z.f.YJ=function(){this.Gy&&(this.Ea().length>=this.kj?(0,window.confirm)(this.zX())?(this.ed(this.lu),this.ba("cancel")):this.focus():this.Hy=(0,window.setTimeout)(this.qr.bind(this),100))};z.m(J$,I$);z.f=J$.prototype;z.f.AH=null;z.f.fR=null;z.f.BH=null;z.f.rh=null;z.f.fJ=null;z.f.eJ=null;z.f.GS=null;z.f.bt=function(a){this.rh=a;this.fJ=a.startIndex;this.eJ=a.endIndex;this.GS=a.content;return this};z.f.zX=function(){return(0,z.B)("Your note is too long; do you want to abandon your changes?")};z.f.WO=function(a){var b=z.jt();a=z.Uq(a).gm(b).Aw(b.Sa());this.rh&&a.Iv()&&this.Od.bt(a.Iv(),this.rh);var b=this.Od,c;c=z.gF(b.aa,a);C$(b,c.Mc()).add(c);return a};
z.f.wX=function(){return this.Re()?this.l.s(z.Yja,{postId:this.Fa,noteId:this.Re()}):this.l.s(z.Wja,{postId:this.Fa})};z.f.vX=function(a){var b=z.jt();a=(new z.Tq({content:a,anchor:this.AH,anchorContent:this.fR,anchorImage:this.BH?this.BH.Bb():null,replies:[],createdAt:Date.now()})).gm(b);null!=this.fJ&&null!=this.eJ&&(b=new z.Xq({anchor:this.AH,startIndex:this.fJ,endIndex:this.eJ,content:this.GS}),a.bt(b));return a};z.m(K$,I$);K$.prototype.zX=function(){return(0,z.B)("Your reply is too long; do you want to abandon your changes?")};K$.prototype.WO=function(a){var b=z.jt();a=z.Wq(a).gm(b).Aw(b.Sa());r$(this.Od.Kl(a.Re(),this.nd)).push(a);return a};K$.prototype.wX=function(){return this.wU?this.l.s(z.aka,{postId:this.Fa,noteId:this.Re(),replyId:this.wU}):this.l.s(z.$ja,{postId:this.Fa,noteId:this.Re()})};
K$.prototype.vX=function(a){var b=z.jt();return(new z.Vq({replyId:"",postId:this.Fa,noteId:this.Re(),content:a,createdAt:Date.now()})).gm(b)};z.m(M$,z.R);z.f=M$.prototype;
z.f.V=function(){M$.R.V.call(this);z.U(this.W()).o("show-note-editor",this.fL,this).o("hide-note-editor",this.bJ.bind(this,!0)).o("show-reply-editor",this.eaa,this).o("hide-reply-editor",this.V4,this).o("save-note",this.c$,this).o("save-reply",this.d$,this).o("highlight-quote",this.Y4,this).o("dismiss-note",this.LR.bind(this,!0),this).o("delete-note",this.LR.bind(this,!1),this).o("delete-reply",this.j3,this).o("previous-highlight-tip",this.b9,this).o("next-highlight-tip",this.a6,this);Fwa(this);this.Vg&&
k$(this.Vg)&&(Ewa(this),z.Xu(this,k$(this.Vg),"add",this.m7,this));if(this.AK&&this.SS&&this.TS){var a=this.query(".js-inlineNewPostControl"),b=this.AK,c=this.za.va(),d=new z.a_(this.X);d.OA("web-inline-quote-responses");d.Ia(a);d.mx=!0;d.kI=!0;d.hI=!0;d.dE=wva;d.Uq=b;d.TA(c);d.Ky=!0;this.pd=d;this.pd.U();a=O$(this.wy);this.ba("set-active-highlight",this.nd,a)}this.rh&&(this.fL(),this.he&&this.he.focus());P$(this,0)};
z.f.fa=function(){this.Am&&this.Am.IM();(this.rh||this.wy)&&this.ba("reset-highlight",this.nd,null);M$.R.fa.call(this)};z.f.Ja=function(){z.Uv(this.W());z.uf(this.W());z.kd(this.pd);z.kd(this.he);z.kd(this.Am);z.ld(z.db(this.yh));this.Am=this.yh=this.he=this.pd=null;M$.R.Ja.call(this)};z.f.Mp=function(){if(this.he&&this.he.Ea())return!0;for(var a=z.db(this.yh),b=0;b<a.length;b++)if(a[b]&&a[b].Ea())return!0;return this.pd&&!this.pd.isDismissable()?!0:!1};
z.f.hx=function(){var a=[],b=[],c=[],d=this.pu&&(this.rh||this.wy);d||(this.Yq?(a=this.uc?n$(this.uc,this.Yq.quotes):[],b=this.Yq.notes,c=this.Yq.Gj):(b=this.Od?z.DF(C$(this.Od,this.nd)):[],this.WJ||(this.uc?(a=this.uc,a=n$(a,a.Po[this.nd]||[])):a=[],c=this.Vg?q$(this.Vg,this.nd):[])));return z.lt(Bwa,{post:this.za.Za(),quotes:a,notes:b,Gj:c,mQ:!!this.AK,HG:d,ZA:this.pu,Iw:this.oV,rfa:z.WG(this.za)})};
z.f.m7=function(){var a=this.query(".js-blockGroupPosts"),b=z.lt(Awa,{Gj:q$(this.Vg,this.nd)});z.wf(b,a);Ewa(this)};
z.f.fL=function(){if(this.pu){if(!this.he){var a=this.query(".js-noteEditor"),b=String(z.kt(zwa)),a=this.he=new J$(this.X,a,this.za.va(),null,b),b=this.nd,c=this.za.Ag(this.Ed.get(this.nd)),d=c.ia(),c=4==c.type?c.Bd():null;a.AH=b;a.fR=d;a.BH=c;(a=this.rh)&&this.he.bt(a);z.Xu(this,this.he,"saving",this.Q7,this);z.Xu(this,this.he,"fail",this.T6,this);z.Xu(this,this.he,"save",this.L7,this)}z.t(this.query(".js-noteActions"),"is-noteEditorVisible");this.he&&this.he.focus()}};
z.f.c$=function(){this.he&&this.he.save()};z.f.Q7=function(a){this.he.ed("");var b=this.query(".js-notesList");a={note:a,post:this.za.Za(),HG:this.pu,ZA:this.pu};a=z.lt(L$,a);b.appendChild(a);z.Qc(b,"is-empty");Fwa(this);this.bJ()};z.f.L7=function(a){var b=this.query(".js-notesList").lastChild;a=a.Re();z.t(b,"js-note-"+a);b.setAttribute("data-note-id",a);(b=b.querySelector(".js-deleteNote"))&&b.setAttribute("data-action-value",a)};
z.f.T6=function(){var a=this.query(".js-notesList");a.removeChild(a.lastChild);z.t(a,"is-empty");this.fL()};z.f.bJ=function(a){a?this.ba("close"):this.he&&(this.he.Ea()&&this.he.ed(""),z.Qc(this.query(".js-noteActions"),"is-noteEditorVisible"))};z.f.eaa=function(a){(a=N$(a.target))&&this.pu&&Gwa(this,a)};z.f.d$=function(a){a=N$(a.target);(a=this.yh[a])&&a.save()};
z.f.R7=function(a){var b=a.Re();this.yh[b]&&this.yh[b].ed("");var c=this.Od.Kl(b,this.nd).author.userId==a.author.userId,d=this.query(".js-note-"+a.Re()+" .js-repliesList");a={note:a,post:this.za.Za(),CY:c};a=z.lt(L$,a);d.appendChild(a);z.Qc(d,"is-empty");Hwa(this,b)};z.f.M7=function(a){var b=this.query(".js-note-"+a.Re()).querySelector(".js-repliesList").lastChild;a=a.ps();z.t(b,"js-reply-"+a);(b=b.querySelector(".js-deleteNote"))&&b.setAttribute("data-action-value",a)};
z.f.U6=function(a){var b=this.query(".js-note-"+a.Re()+" .js-repliesList");b.removeChild(b.lastChild);z.t(b,"is-empty");Gwa(this,a.Re())};z.f.V4=function(a){(a=N$(a.target))&&Hwa(this,a)};z.f.Y4=function(a){a=a.target;var b=a.getAttribute("data-quote-creator-id"),c=H$(this.Ed,this.nd);c&&(this.Am&&this.Am.IM(),this.Am=Jwa(this,c,a,function(){Iwa(this,b,!1);z.kd(this.Am);this.Am=null}),Iwa(this,b,!0))};
z.f.X4=function(a){var b=H$(this.Ed,this.nd);(a=this.Od.Kl(a.target.getAttribute("data-note-id"),this.nd))&&b&&(b=(b=a.Iv())?this.Od.jF(b):null,this.ba("set-active-highlight",this.nd,b))};z.f.Z4=function(a){var b=H$(this.Ed,this.nd),c;c=this.Vg;a=a.target.getAttribute("data-post-id");c=k$(c)?z.oQ(k$(c),a):null;b&&c&&(b=o$(c))&&(b=p$(b)&&p$(b).xk())&&(c=b.Db())&&c.length&&(b=O$(b),this.ba("set-active-highlight",this.nd,b))};
z.f.EL=function(){var a=null;this.wy&&(a=O$(this.wy));this.rh&&(a=this.rh);this.ba("reset-highlight",this.nd,a)};
z.f.LR=function(a,b){var c=b.value,d=this.Od.Kl(c,this.nd),e=this.query(".js-note-"+c);if(d&&e){z.St(e);this.EL();this.ib(".js-note-item").every(function(a){return z.Mc(a,"u-hide")})&&this.bJ(!0);var g=D$(this.Od,d,"HIDDEN");z.r(g.yi,function(b){this.ga.U(a?(0,z.B)("Yikes! Something happened and we couldn’t dismiss this note."):(0,z.B)("Yikes! Something happened and we couldn’t delete this note."),"error");g.HA();z.Tt(e);(400>b.status||499<b.status)&&D$(this.Od,d,"NEW")},this);z.q(this.ga.U(a?(0,z.B)("The note has been dismissed."):
(0,z.B)("The note has been deleted."),{type:"success",Jw:!0}),function(){this.ga.Hb();g.HA();D$(this.Od,d,"NEW");z.Tt(e)},this)}};
z.f.j3=function(a){var b=a.value,c=this.query(".js-reply-"+b),d=N$(a.target);if(d&&c){z.St(c);var e=E$(this.Od,b,d,this.za.va(),this.nd,"HIDDEN");z.r(e.yi,function(){this.ga.U((0,z.B)("Yikes! Something happened and we couldn’t delete this reply."),"error");e.HA();z.Tt(c);E$(this.Od,b,d,this.za.va(),this.nd,"")},this);z.q(this.ga.U((0,z.B)("The reply has been deleted."),{type:"success",Jw:!0}),function(){this.ga.Hb();e.HA();E$(this.Od,b,d,this.za.va(),this.nd,"");z.Tt(c)},this)}};
z.f.b9=function(){P$(this,this.xC-1)};z.f.a6=function(){P$(this,this.xC+1)};z.m(Q$,z.R);z.f=Q$.prototype;z.f.V=function(){Q$.R.V.call(this);var a=[];z.WG(this.za)&&a.push(this.Od.load(this.Fa));this.XS||(a.push(this.uc.load(this.Fa)),a.push(this.Vg.load(this.Fa)));this.Kq=z.q(z.q(z.q(z.AD(a),function(){this.Kq=null},this),this.ww,this),this.t2,this);z.Xu(this,this.$a,"resize-end",this.Kg,this)};z.f.fa=function(){this.Kq&&this.Kq.cancel();Q$.R.fa.call(this)};z.f.Ja=function(){this.Kq=null;Q$.R.Ja.call(this)};z.f.ww=function(){xwa(this.Ed,function(a,b){R$(this,b)},this)};
z.f.Kg=function(){xwa(this.Ed,function(a,b){Qwa(this,b)},this)};z.f.t2=function(){var a=this.uc.xh;z.Xu(this,a,"add",this.RT,this);z.Xu(this,a,"remove",this.RT,this);(a=k$(this.Vg))&&z.Xu(this,a,"add",this.I7,this)};z.f.RT=function(a){Kwa(this,Object.keys(z.JF(this.uc,a instanceof Array?a:[a])))};z.f.I7=function(a){Kwa(this,(a instanceof Array?a:[a]).map(this.Vg.hN,this.Vg))};z.f.hx=function(a){var b=window.document.createElement("div");b.className="notesMarkers";a.appendChild(b);return b};
z.f.Yx=function(a,b){z.mb(a,{startIndex:Math.min(a.startIndex,b.startIndex),endIndex:Math.max(a.endIndex,b.endIndex),notes:a.notes.concat(b.notes),quotes:a.quotes.concat(b.quotes),Gj:a.Gj.concat(b.Gj)})};z.m(S$,z.R);z.f=S$.prototype;
z.f.V=function(){S$.R.V.call(this);this.pa(this.xa.W(),"click",this.F5,this,!0);z.U(this.Wx).o("select-anchor",this.S7,this);var a=this.za.Za();if(a.Cp()&&!this.za.td()){var b=z.Ik(a),b=2==a.visibility&&b&&!z.Hj(b.Rh());a.allowResponses&&!b&&z.r(this.Vg.load(this.za.va(),"best"),z.Q);a.Rh().bF()&&(this.bD=z.q(this.Od.load(this.za.va()),this.q7,this));z.r(this.uc.load(this.za.va()),z.Q)}this.HJ&&U$(this);z.Xu(this,this.Pa,"historyUpdate",function(){U$(this,z.iH())},this);this.Gd&&z.Xu(this,this.Gd,
"highlight",this.o7,this)};z.f.Ja=function(){z.kd(this.Hf);this.Hf=null;z.kd(this.Zi);this.Zi=null;this.Wx&&z.U(this.Wx).clear("select-anchor");this.bD&&this.bD.cancel();this.bD=null;S$.R.Ja.call(this)};z.f.ufa=function(a,b){T$(this,b,null,null,a)};z.f.Uga=function(){this.Hf&&this.Hf.Kg()};z.f.Mp=function(){if(!this.Zi)return!1;var a=this.Zi.Ea();return a?a.Mp():!1};z.f.l7=function(a){a.subscribe("add",this.vV,this);a.subscribe("remove",this.vV,this)};
z.f.vV=function(a){(z.ha(a)?a:[a]).forEach(function(a){R$(this.Hf,a.Mc())},this)};z.f.q7=function(){var a=(0,z.Aa)();this.bD=null;U$(this,z.iH());this.pa(this.Ef,z.mL,this.gK,this);z.qA("notes.renderMarkers",(0,z.Aa)()-a)};z.f.gK=function(a){(a=a.target.getAttribute("name"))&&H$(this.Ed,a)&&Qwa(this.Hf,a)};z.f.o7=function(){if(this.Gd){var a=Wwa(this,this.Gd.sl);z.PF(this.Gd);a&&(a=a.highlight,this.KU(a.anchor,a),T$(this,a.anchor,a))}};
z.f.F5=function(a){if(this.Zi){var b=a.target;if(!z.Bf(this.Zi.W(),b)){var c=this.Zi.Ea(),d;if(!(d=!c)){a:if(c.he&&c.he.Ea())c=!0;else{d=z.db(c.yh);for(var e=0;e<d.length;e++)if(d[e]&&d[e].Ea()){c=!0;break a}c=c.pd&&!c.pd.Fg()?!0:!1}d=!c}d&&(c=this.Zi&&this.Zi.gk,d="select-anchor"==b.getAttribute("data-action"),this.IK(),c&&d&&z.Bf(c,b)&&a.stopPropagation())}}};
z.f.bk=function(a){if(!(767>=window.innerWidth)){var b=a.gk,c=z.hu(b);a.Ci();a=a.W();var d=z.hu(a),e=window.innerHeight,g=window.innerWidth,h=this.xa.query(".js-metabar"),k=0;h&&(k=z.hu(h).height);d.height>=e-k?z.t(a,"floating--sidebar"):(h=z.cu(b),h=c.top+d.height>=e?z.du().top+e-d.height-10:z.cu(b),b=z.hu(this.Wx).left+10,b+d.width>=g&&(b=g-d.width-10),a.style.top=h+"px",a.style.left=b+"px")}};z.f.IK=function(){z.kd(this.Zi);this.Zi=null};
z.f.S7=function(a){var b=z.It(a.target,function(a){return z.Mc(a,"js-paragraphControl")},this.YT),b=Rwa(this.Hf,a.value,b);T$(this,a.value,null,null,null,b)};z.f.KU=function(a,b){if(this.za.td()){var c=z.Ug();this.PD=(c=c&&ywa(this.Ed,z.Wf(c)))&&new u$(c)}Vwa(this,a,b)};z.f.P9=function(a,b){Vwa(this,a,b);if(this.za.td()&&this.PD){var c=this.PD.restore();c&&c.select()}this.PD=null};
z.f.sr=function(a){if(this.Ed&&(a=H$(this.Ed,a))){a=Math.max(z.cu(a),0);var b=window.document.body;this.$i&&this.$i.cancel();this.$i=new z.BD(b,"scrollTop",600,a)}};Xwa.prototype.JE=function(a,b,c){return new S$(a,b,c)};z.da(V$,z.R);z.f=V$.prototype;z.f.Je=function(a){this.ea=a};z.f.jga=function(a){this.eL=a};z.f.V=function(){this.W()?(z.R.prototype.V.call(this),z.U(this.W()).o("show-other-responses",this.XU,this),z.P(this.W(),Ywa,{post:this.ea}),this.ea.Cp()&&z.r(z.q(z.q(z.q(ova(this.Ba,this.ea.La(),"best"),this.uU.bind(this,"best")),this.B9,this),function(){this.QL.JP&&this.XU()},this),z.Q)):z.Q("Attempted to initialize ResponsesStreamControl without root element.")};
z.f.fa=function(){z.U(this.W()).clear("show-other-responses");z.R.prototype.fa.call(this)};z.f.uU=function(a,b){if(this.isActive()){var c=b.Cf,d=void 0;"best"==a?(d=this.query(".js-responsesStream"),z.Xu(this,c,"add",this.vT.bind(this,c)),this.vT(c)):d=this.query(".js-responsesStreamOther");c&&(z.bl()||0<c.Tc())&&d&&(z.P(d,z.jS,{items:z.DF(c),context:2}),c=new z.wU(this.X,c),c.Ia(d),c.kg(2),this.track(c),z.Tt(this.query(".js-responsesStreamWrapper")))}};
z.f.B9=function(){var a=this.query(".js-inlineNewPostControl"),b=this.query(".js-responsesLoggedOutPrompt");if(z.bl())if(a){var b=(new z.a_(this.X)).OA("web-inline-post-response").TA(this.ea.La()),c=z.kt(z.Ro,{post:this.ea,uG:!0});b.qD=c;b.Ky=this.eL;this.pd=b.Ia(a);this.track(this.pd)}else b&&this.eL&&(a=z.bu(b),b=z.cu(b),z.$t(a,0,b));else b&&z.t(b,"u-hide")};
z.f.XU=function(){this.jK||(this.jK=z.yc(z.q(z.q(ova(this.Ba,this.ea.La(),"other"),this.uU.bind(this,"other")),function(){z.St(this.query(".js-showOtherResponses"));this.QL.JP=!0},this),function(){this.jK=null},this))};z.f.vT=function(a){(a=a.lj)&&a.next&&"other"==a.next.filter&&!this.QL.JP&&(z.Tt(this.query(".js-responsesStreamWrapper")),z.Tt(this.query(".js-showOtherResponses")))};z.f.yv=function(){this.pd&&(z.yT(this.pd.W(),new z.$g(60,0,200,0)),this.pd.yv())};z.da(W$,z.R);z.f=W$.prototype;z.f.V=function(){z.R.prototype.V.call(this);this.Ze();this.HD();z.U(this.W()).o("sidecard-dismiss",this.p3,this)};z.f.fa=function(){z.Uv(this.W());z.R.prototype.fa.call(this)};z.f.hx=function(a){var b=window.document.createElement("div");b.className="cardChromeless u-width200 u-hide u-md-hide";a.appendChild(b);return b};z.f.Ze=function(){z.P(this.W(),Gva,{posts:this.vD})};
z.f.HD=function(){if(z.cl(z.v).enable_related_reads_side_card_fixed){var a=this.W();z.t(a,"u-positionFixed");z.t(a,"u-transition--fadeOut300");if(this.$o)a.style.top=this.$o;else{var b=(z.gu().height-Z$)/2,b=Math.max(b,0);this.$o=b+"px";a.style.top=this.$o;this.OB>$$+Zwa&&(z.Tt(a),this.wT(),z.Xu(this,this.Xb,"refresh",this.wT,this))}}else if(a=this.W(),z.t(a,"u-positionAbsolute"),this.$o)a.style.top=this.$o;else{var c=z.gu().height,b=z.au(this.za.Ef).y,c=Math.max(1.5*c,b+c+$$);a:{var d;if((d=this.za.Ef.querySelectorAll(".graf--p"))&&
d.length){var e=d[0];if(e){for(var g=z.au(e).y,h=z.hu(e).height,k={y:g,height:h},n=[],p=1;p<d.length;p++)e=d[p],g=z.au(e).y,h=z.hu(e).height,e.classList.contains("graf-after--p")?k=k?{y:k.y,height:g-k.y+h}:{y:g,height:h}:(n.push({y:k.y,height:k.height}),k={y:g,height:h});n.push(k);d=n}else d=[]}else d=[];if(d&&d.length)for(e=0;e<d.length;e++)if(!(d[e].height<Z$||c>d[e].y+d[e].height)&&(c=Math.max(c,d[e].y),c>=d[e].y&&c+Z$<=d[e].y+d[e].height))break a;c=-1}c<$$||(this.$o=c+"px",a.style.top=this.$o,
b+this.OB-c>Zwa&&(z.Tt(a),a={userId:z.Yk().userId,experimentName:"recirculation.experimentSideCard",action:"side_card_shown",article_ratio:c/this.OB},z.T(z.PM,a)))}};
z.f.wT=function(){var a=this.W();if(a&&!this.AS){var b=z.SC(this.Xb,this.za.Ef),c=$wa,c=Math.max(c,$$/this.OB),d=z.Mc(a,"u-transition--fadeIn300");b>=c&&b<=axa&&!d?(z.Uc(a,"u-transition--fadeOut300","u-transition--fadeIn300"),a={userId:z.Yk().userId,experimentName:"recirculation.experimentSideCard",action:"side_card_shown",article_ratio:b},z.T(z.PM,a)):d&&(b<c||b>axa)&&(z.Uc(a,"u-transition--fadeIn300","u-transition--fadeOut300"),a={userId:z.Yk().userId,experimentName:"recirculation.experimentSideCard",
action:"side_card_hidden",article_ratio:b},z.T(z.PM,a))}};z.f.p3=function(){this.AS=!0;z.Uc(this.W(),"u-transition--fadeIn300","u-transition--fadeOut300");var a={userId:z.Yk().userId,experimentName:"recirculation.experimentSideCard",action:"side_card_dismissed"};z.T(z.PM,a)};var $$=650,Zwa=650,Z$=250,$wa=.25,axa=.95;z.da(X$,z.R);X$.prototype.iga=function(a){this.za=a;this.ea=this.za.Za()};
X$.prototype.V=function(){var a=this;this.W()?(z.R.prototype.V.call(this),this.Aa=z.r(z.q(this.o9.Kz(this.ea.La()),function(b){var c=b.metabar;if(z.cl(z.v).enable_read_next_in_metabar&&c&&c.length){var d=z.pQ(c),e=a.xa.query(".js-readNextMetabarRight");e&&(d=new Y$(d,"read_next_metabar_promo"),d.gx=!0,d.JU=!0,d.Ia(e),a.track(d),z.T(z.oH,{promoId:"post_page_read_next_metabar_popup"}),e=a.xa.query(".js-postActionRightSeparator"),z.Vt(e))}e=b.topCard;if(z.cl(z.v).enable_related_reads_header_promo&&e&&
e.length){var d=z.pQ(e),g=a.xa.query(".js-readNextHeaderCard");g&&(a.track((new Y$(d,"read_next_header_promo")).Ia(g)),z.t(g,"is-visible"),z.T(z.oH,{promoId:"post_page_read_next_header_popup"}))}d=b.bottomCard;if((z.cl(z.v).enable_related_reads_footer_promo||z.cl(z.v).enable_related_reads_footer_promo_always_shown)&&d&&d.length){var g=z.pQ(d),h=a.xa.query(".js-readNextFooterCard");h&&a.track((new Y$(g,"read_next_footer_promo")).Ia(h))}g=b.sideCard;(z.cl(z.v).enable_related_reads_side_card||z.cl(z.v).enable_related_reads_side_card_fixed)&&
g&&g.length&&(h=new W$(a.X,a.xa.W(),g,a.za),a.track(h));b=b.footerGrid;z.cl(z.v).enable_related_reads_footer_grid_ui&&b&&b.length&&z.P(a.W(),Fva,{posts:b});c=z.Pa(c,g,e,d);z.cl(z.v).enable_read_next_mobile_carousel&&(b=a.xa.query(".js-relatedReadsMobileCarousel"))&&(c&&c.length?z.P(b,Eva,{posts:c,source:"related_reads_mobile_carousel"}):z.St(b))}),z.Q)):z.Q("Attempted to initialize RelatedReadsRecirculationControl without root element.")};
X$.prototype.fa=function(){z.R.prototype.fa.call(this);this.Aa&&(this.Aa.cancel(),this.Aa=null)};z.da(Y$,z.R);Y$.prototype.V=function(){z.R.prototype.V.call(this);z.P(this.W(),t$,{post:this.ea,pga:!0,NP:this.raa,Jea:this.gx,ca:this.gx,Gea:this.gx,Fea:this.JU,oA:!this.gx})};var bxa=z.Qz,cxa=bxa.Da();cxa.scope("screen").add("quotes",Kva).add("quote-responses",Xwa).add("responses-stream-control",V$).add("notes-data",B$).add("related-reads-stream-control",G$).add("related-reads-recirculation-control",X$);z.qQ(cxa.scope("app"),"PlacementsControl",F$);z.rQ(bxa,"notes");}).call(this, _mdm);
//# sourceURL=fingerprint:notes
