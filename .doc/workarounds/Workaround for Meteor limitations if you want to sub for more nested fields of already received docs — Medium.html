<!DOCTYPE html>
<!-- saved from url=(0156)https://medium.com/@MaxDubrovin/workaround-for-meteor-limitations-if-you-want-to-sub-for-more-nested-fields-of-already-received-docs-eb3fdbfe4e07#.ysginq4d7 -->
<html xmlns:cc="http://creativecommons.org/ns#"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# medium-com: http://ogp.me/ns/fb/medium-com#"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium</title><link rel="canonical" href="https://medium.com/@MaxDubrovin/workaround-for-meteor-limitations-if-you-want-to-sub-for-more-nested-fields-of-already-received-docs-eb3fdbfe4e07"><meta name="title" content="Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium"><meta name="referrer" content="always"><meta name="description" content="It’s only a matter of time when you face it"><meta property="og:site_name" content="Medium"><meta property="og:title" content="Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium"><meta property="og:url" content="https://medium.com/@MaxDubrovin/workaround-for-meteor-limitations-if-you-want-to-sub-for-more-nested-fields-of-already-received-docs-eb3fdbfe4e07"><meta property="og:image" content="https://cdn-images-1.medium.com/max/1200/1*CnHxgy05Ds54HGQ8HJl62g.png"><meta property="fb:app_id" content="542599432471018"><meta property="og:description" content="It’s only a matter of time when you face it"><meta property="twitter:description" content="It’s only a matter of time when you face it"><meta name="twitter:site" content="@Medium"><meta name="twitter:image:src" content="https://cdn-images-1.medium.com/max/1200/1*CnHxgy05Ds54HGQ8HJl62g.png"><link rel="publisher" href="https://plus.google.com/103654360130207659246"><link rel="author" href="https://medium.com/@MaxDubrovin"><meta name="author" content="Maxim Dubrovin"><meta property="og:type" content="article"><meta name="twitter:card" content="summary_large_image"><meta property="article:publisher" content="https://www.facebook.com/medium"><meta property="article:author" content="Maxim Dubrovin"><meta property="fb:smart_publish:robots" content="noauto"><meta property="article:published_time" content="2014-12-28T14:47:45.067Z"><meta name="twitter:creator" content="@MaxDubrovin"><meta name="twitter:label1" value="Reading time"><meta name="twitter:data1" value="4 mins"><script type="text/javascript" async="" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/ga.js"></script><script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","image":{"@type":"ImageObject","width":969,"height":780,"url":"https://cdn-images-1.medium.com/max/969/1*CnHxgy05Ds54HGQ8HJl62g.png"},"datePublished":"2014-12-28T14:47:45.067Z","dateModified":"2015-08-12T02:34:23.470Z","headline":"Workaround for Meteor limitations if you want to sub for more nested fields of already received docs","name":"Workaround for Meteor limitations if you want to sub for more nested fields of already received docs","author":{"@type":"Person","name":"Maxim Dubrovin","url":"https://medium.com/@MaxDubrovin"}}</script><meta name="twitter:app:name:iphone" content="Medium"><meta name="twitter:app:id:iphone" content="828256236"><meta name="twitter:app:url:iphone" content="medium://p/eb3fdbfe4e07"><meta property="al:ios:app_name" content="Medium"><meta property="al:ios:app_store_id" content="828256236"><meta property="al:android:package" content="com.medium.reader"><meta property="al:android:app_name" content="Medium"><meta property="al:ios:url" content="medium://p/eb3fdbfe4e07"><meta property="al:android:url" content="medium://p/eb3fdbfe4e07"><meta property="al:web:url" content="https://medium.com/@MaxDubrovin/workaround-for-meteor-limitations-if-you-want-to-sub-for-more-nested-fields-of-already-received-docs-eb3fdbfe4e07"><link rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/eb3fdbfe4e07"><meta name="theme-color" content="#000000"><link rel="stylesheet" type="text/css" href="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/fonts-base.by5Oi_VbnwEIvhnWIsuUjA.css"><link rel="stylesheet" href="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/main-base.uP9RAbx360BVovJzYqDPKg.css"><script>if (window.top !== window.self) window.top.location = window.self.location.href;var OB_startTime = new Date().getTime(); var OB_loadErrors = []; function _onerror(e) { OB_loadErrors.push(e) }; if (document.addEventListener) document.addEventListener("error", _onerror, true); else if (document.attachEvent) document.attachEvent("onerror", _onerror); function _asyncScript(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = u; f.parentNode.insertBefore(s, f);}function _asyncStyles(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("link"); s.rel = "stylesheet"; s.href = u; f.parentNode.insertBefore(s, f); return s}var _gaq = _gaq || [];_gaq.push(["_setAccount", "UA-24232453-2"]); _gaq.push(["_setDomainName", window.location.hostname]); _gaq.push(["_setAllowLinker", true]); _gaq.push(["_trackPageview"]);_asyncScript(("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js");(new Image()).src = "/_/stat?event=pixel.load&origin=" + encodeURIComponent(location.origin);</script><script type="text/javascript">try {
window.AG_onLoad = function(func) { if (window.addEventListener) { window.addEventListener('DOMContentLoaded', func); } };
window.AG_removeElementById = function(id) { var element = document.getElementById(id); if (element && element.parentNode) { element.parentNode.removeChild(element); }};
window.AG_removeElementBySelector = function(selector) { if (!document.querySelectorAll) { return; } var nodes = document.querySelectorAll(selector); if (nodes) { for (var i = 0; i < nodes.length; i++) { if (nodes[i] && nodes[i].parentNode) { nodes[i].parentNode.removeChild(nodes[i]); } } } };
window.AG_each = function(selector, fn) { if (!document.querySelectorAll) return; var elements = document.querySelectorAll(selector); for (var i = 0; i < elements.length; i++) { fn(elements[i]); }; };
var AG_removeParent = function(el, fn) { while (el && el.parentNode) { if (fn(el)) { el.parentNode.removeChild(el); return; } el = el.parentNode; } };
var AdFox_getCodeScript = function() {};
AG_onLoad(function() { window.AG_each('iframe[id^="AdFox_iframe_"]', function(el) { if (el && el.parentNode) { el.parentNode.removeChild(el); } }); });
try { Object.defineProperty(window, 'noAdsAtAll', { get: function() { return true; } }); } catch (ex) {}
} catch (ex) { console.error('Error executing AG js: ' + ex); }</script><!--[if lt IE 9]><script charset="UTF-8" src="https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js"></script><![endif]--><link rel="shortcut icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-medium.TAS6uQ-Y7kcKgi0xjcYHXw.ico" class="js-favicon is-default"><link rel="apple-touch-icon" sizes="152x152" href="https://cdn-static-1.medium.com/_/fp/img/apple-touch-icon-ipad-retina.Akq8aSfZqfW1fceMxKqBZA.png"><link rel="apple-touch-icon" sizes="120x120" href="https://cdn-static-1.medium.com/_/fp/img/apple-touch-icon-iphone-retina.c211N_zSkSXPQk-ggPi4mQ.png"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn-static-1.medium.com/_/fp/img/apple-touch-icon-ipad.LSTr_8Uf-3hSd7eDjoW_8g.png"><link rel="apple-touch-icon" href="https://cdn-static-1.medium.com/_/fp/img/apple-touch-icon.JWwtHOsKxVkBzoR3FSccjw.png"><link rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon.KjTfUJo7yJH_fCoUzzH3cg.svg" color="#171717"><style id="clearly_highlighting_css" type="text/css">/* selection */ html.clearly_highlighting_enabled ::-moz-selection { background: rgba(246, 238, 150, 0.99); } html.clearly_highlighting_enabled ::selection { background: rgba(246, 238, 150, 0.99); } /* cursor */ html.clearly_highlighting_enabled {    /* cursor and hot-spot position -- requires a default cursor, after the URL one */    cursor: url("chrome-extension://phmkpljilkopjoacakielhagnbbmdmgn/clearly/images/highlight--cursor.png") 14 16, text; } /* highlight tag */ em.clearly_highlight_element {    font-style: inherit !important; font-weight: inherit !important;    background-image: url("chrome-extension://phmkpljilkopjoacakielhagnbbmdmgn/clearly/images/highlight--yellow.png");    background-repeat: repeat-x; background-position: top left; background-size: 100% 100%; } /* the delete-buttons are positioned relative to this */ em.clearly_highlight_element.clearly_highlight_first { position: relative; } /* delete buttons */ em.clearly_highlight_element a.clearly_highlight_delete_element {    display: none; cursor: pointer;    padding: 0; margin: 0; line-height: 0;    position: absolute; width: 34px; height: 34px; left: -17px; top: -17px;    background-image: url("chrome-extension://phmkpljilkopjoacakielhagnbbmdmgn/clearly/images/highlight--delete-sprite.png"); background-repeat: no-repeat; background-position: 0px 0px; } em.clearly_highlight_element a.clearly_highlight_delete_element:hover { background-position: -34px 0px; } /* retina */ @media (min--moz-device-pixel-ratio: 2), (-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2) {    em.clearly_highlight_element { background-image: url("chrome-extension://phmkpljilkopjoacakielhagnbbmdmgn/clearly/images/highlight--yellow@2x.png"); }    em.clearly_highlight_element a.clearly_highlight_delete_element { background-image: url("chrome-extension://phmkpljilkopjoacakielhagnbbmdmgn/clearly/images/highlight--delete-sprite@2x.png"); background-size: 68px 34px; } } </style><style>[touch-action="none"]{ -ms-touch-action: none; touch-action: none; }[touch-action="pan-x"]{ -ms-touch-action: pan-x; touch-action: pan-x; }[touch-action="pan-y"]{ -ms-touch-action: pan-y; touch-action: pan-y; }[touch-action="scroll"],[touch-action="pan-x pan-y"],[touch-action="pan-y pan-x"]{ -ms-touch-action: pan-x pan-y; touch-action: pan-x pan-y; }</style></head><body itemscope="" class="postShowScreen browser-chrome os-mac is-withMagicUnderlines is-js" data-action-scope="_actionscope_0"><script>document.body.className = document.body.className.replace(/(^|\s)is-noJs(\s|$)/, "$1is-js$2")</script><div class="site-main surface-container" id="container"><div class="butterBar butterBar--error" data-action-scope="_actionscope_1"></div><div class="surface" id="_obv.shell._surface_1467819063551" style="display: block; visibility: visible;"><div class="screenContent surface-content is-supplementalPostContentLoaded" data-action-scope="_actionscope_2"><canvas class="canvas-renderer" width="1760" height="900"></canvas><nav class="metabar u-clearfix js-metabar metabar--top metabar--centered metabar--postArticle metabar--affixed is-minimized"><div class="metabar-inner u-maxWidth1000 u-marginAuto u-paddingLeft20 u-paddingRight20"><div class="metabar-block metabar-block--left u-floatLeft"><a href="https://medium.com/" class="siteNav-logo" data-log-event="home"><span class="svgIcon svgIcon--logoNew svgIcon--45px is-flushLeft"><svg class="svgIcon-use" width="45" height="45" viewBox="-17 18 45 45" data-multipart="true"><path d="M11.525 28.078c-.472-.225-.858.002-.858.506v20.044l8.616 4.113c.948.46 1.717.14 1.717-.7v-19.3a.22.22 0 0 0-.124-.19l-9.35-4.46v-.01z"></path><path d="M.333 43.696l9.83-15.247c.278-.43.89-.6 1.36-.38l9.364 4.47c.06.03.082.1.047.15L10.666 48.63.333 43.698v-.002z"></path><path d="M-8.57 28.35c-.786-.375-1.053-.096-.592.62L.333 43.696l10.333 4.932L.356 32.635a.156.156 0 0 0-.06-.054l-8.866-4.23z"></path><path d="M.333 52.033c0 .84-.643 1.22-1.43.844l-8.045-3.84c-.472-.224-.858-.82-.858-1.325V28.89c0-.672.515-.976 1.145-.675l9.133 4.36a.092.092 0 0 1 .055.084v19.37z"></path></svg></span><span class="u-textScreenReader">Homepage</span></a></div><div class="metabar-block metabar-block--right u-floatRight"><div class="buttonSet buttonSet--wide"></div><div class="buttonSet"><a class="button button--primary button--chromeless u-accentColor--buttonNormal is-inSiteNavBar u-marginRight15" href="https://medium.com/m/signin?redirect=https%3A%2F%2Fmedium.com%2F%40MaxDubrovin%2Fworkaround-for-meteor-limitations-if-you-want-to-sub-for-more-nested-fields-of-already-received-docs-eb3fdbfe4e07" data-action="sign-in-prompt" data-redirect="https://medium.com/@MaxDubrovin/workaround-for-meteor-limitations-if-you-want-to-sub-for-more-nested-fields-of-already-received-docs-eb3fdbfe4e07" data-action-source="nav_signup">Sign in / Sign up</a><label class="inputGroup u-sm-hide metabar-predictiveSearch u-baseColor--placeholderNormal" title="Search Medium"><span class="svgIcon svgIcon--search svgIcon--25px u-baseColor--iconNormal"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M20.067 18.933l-4.157-4.157a6 6 0 1 0-.884.884l4.157 4.157a.624.624 0 1 0 .884-.884zM6.5 11c0-2.62 2.13-4.75 4.75-4.75S16 8.38 16 11s-2.13 4.75-4.75 4.75S6.5 13.62 6.5 11z"></path></svg></span><input class="js-predictiveSearchInput textInput textInput--rounded textInput--darkText u-baseColor--textNormal textInput--transparent" type="search" placeholder="Search Medium" required="true"></label><a class="button button--chromeless u-sm-show u-baseColor--buttonNormal button--withIcon" href="https://medium.com/search" title="Search" aria-label="Search"><span class="button-defaultState"><span class="svgIcon svgIcon--search svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M20.067 18.933l-4.157-4.157a6 6 0 1 0-.884.884l4.157 4.157a.624.624 0 1 0 .884-.884zM6.5 11c0-2.62 2.13-4.75 4.75-4.75S16 8.38 16 11s-2.13 4.75-4.75 4.75S6.5 13.62 6.5 11z"></path></svg></span></span></a></div></div></div></nav><div class="postActionsBar js-postActionsBar"><div class="postActionsBar-container container"><div class="postActionsBar-content row js-postActionsBarContent"><div class="postActions u-marginAuto u-maxWidth1250 u-padding0 u-positionRelative"><div class="u-positionAbsolute u-positionRight0 u-marginRight20 js-readNextInteractions"><div class="u-floatLeft"><div class="u-floatRight buttonSet"><div class="buttonSet-inner"><button class="button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_actions_bar"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path></svg></span></button></div><div class="buttonSet-inner"><button class="button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_actions_bar"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path></svg></span></button></div></div></div><div class="col u-xs-hide u-height44 u-width255 u-padding0 u-marginLeft0 u-verticalAlignTop u-foreground u-block u-floatLeft js-readNextMetabarRight"></div></div><div class="container u-maxWidth740 u-height44 u-marginAuto js-postActions-actionButtons"><div class="u-floatLeft buttonSet buttonSet--withLabels"><div class="buttonSet-inner"><div class="js-actionRecommend" data-post-id="eb3fdbfe4e07" data-is-icon-29px="true" data-source="post_actions_bar"><button class="button button--primary button--large button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon u-accentColor--iconLight" title="Recommend to share this article with your followers and let the author know you liked it" aria-label="Recommend to share this article with your followers and let the author know you liked it" data-action="sign-in-prompt" data-sign-in-action="upvote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/eb3fdbfe4e07" data-action-source="post_actions_bar"><span class="button-defaultState"><span class="svgIcon svgIcon--heart svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.215 23.716c-.348.288-.984.826-1.376 1.158a.526.526 0 0 1-.68 0c-.36-.307-.92-.78-1.22-1.03C9.22 20.734 3 15.527 3 10.734 3 7.02 5.916 4 9.5 4c1.948 0 3.77.898 5 2.434C15.73 4.898 17.552 4 19.5 4c3.584 0 6.5 3.02 6.5 6.734 0 4.9-6.125 9.96-9.785 12.982zM19.5 5.2c-1.774 0-3.423.923-4.41 2.468a.699.699 0 0 1-.59.323.706.706 0 0 1-.59-.32c-.988-1.54-2.637-2.47-4.41-2.47-2.922 0-5.3 2.49-5.3 5.54 0 4.23 6.19 9.41 9.517 12.19.217.18.566.48.783.66l.952-.79c3.496-2.88 9.348-7.72 9.348-12.05 0-3.05-2.378-5.53-5.3-5.53z"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--heartFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.5 4c-1.948 0-3.77.898-5 2.434C13.27 4.898 11.448 4 9.5 4 5.916 4 3 7.02 3 10.734c0 4.793 6.227 10 9.95 13.11.296.25.853.723 1.212 1.03.196.166.48.166.677 0 .39-.332 1.02-.87 1.37-1.158 3.66-3.022 9.79-8.08 9.79-12.982C26 7.02 23.08 4 19.5 4z" fill-rule="evenodd"></path></svg></span></span></button><button class="button button--chromeless u-baseColor--buttonNormal" data-action="show-recommends" data-action-value="eb3fdbfe4e07">10</button></div></div><div class="buttonSet-inner"><button class="button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon" data-action="scroll-to-responses" data-action-source="post_actions_bar"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span></button></div></div></div></div></div></div></div><article class="u-sizeViewHeightMin100 postArticle postArticle--full" lang="en"><div class="layoutSingleColumn notesPositionContainer"><div class="notesMarkers" data-action-scope="_actionscope_4"></div></div><header class="container u-maxWidth740 is-underMetabar"><div class="postMetaHeader u-paddingBottom10 row"><div class="col u-size12of12 js-postMetaLockup"><div class="postMetaLockup postMetaLockup--authorWithBio u-flex"><div class="u-flex0"><a class="link avatar u-baseColor--link" href="https://medium.com/@MaxDubrovin?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-type="hover" data-user-id="44ee27f7a028" dir="auto"><img src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/1-Zox871B4YcNJdOrXuaWjfQ.jpeg" class="avatar-image avatar-image--small" alt="Go to the profile of Maxim Dubrovin"></a></div><div class="u-flex1 u-paddingLeft15 u-overflowHidden"><a class="link link link--darken link--darker u-baseColor--link" href="https://medium.com/@MaxDubrovin?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-type="hover" data-user-id="44ee27f7a028" dir="auto">Maxim Dubrovin</a><span class="followState js-followState buttonSet-inner" data-user-id="44ee27f7a028"><button class="button u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-marginLeft10 u-paddingLeft10 u-paddingRight10 u-height18 u-lineHeight16 u-verticalAlignMiddle u-marginTopNegative2 u-fontSizeSmallest u-uiTextMedium u-xs-hide" data-action="sign-in-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-action-source="post_header_lockup"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton u-marginLeft10 u-paddingLeft10 u-paddingRight10 u-height18 u-lineHeight16 u-verticalAlignMiddle u-marginTopNegative2 u-fontSizeSmallest u-uiTextMedium u-xs-hide" data-action="sign-in-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/44ee27f7a028" data-action-source="post_header_lockup_follow"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span><div class="postMetaInline u-noWrapWithEllipsis u-xs-normalWrap u-xs-lineClamp2">web developer in a space odyssey with Astroshock.ru team</div><div class="postMetaInline">Dec 28, 2014<span class="middotDivider"></span><span class="readingTime">5 min read</span></div></div></div></div></div></header><main role="main" class="postArticle-content js-postField js-notesSource" data-scroll="native"><section name="7111" class=" section--body section--first"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class="section-content"><div class="section-inner layoutSingleColumn"><figure name="2165" id="2165" class="graf--figure graf--leading"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 563px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 80.5%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*CnHxgy05Ds54HGQ8HJl62g.png" data-width="969" data-height="780" data-action="zoom" data-action-value="1*CnHxgy05Ds54HGQ8HJl62g.png" data-scroll="native"><img src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/1-CnHxgy05Ds54HGQ8HJl62g.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="60"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*CnHxgy05Ds54HGQ8HJl62g.png" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/1-CnHxgy05Ds54HGQ8HJl62g(1).png"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*CnHxgy05Ds54HGQ8HJl62g.png"&gt;</noscript></div></div></figure><h3 name="4a52" id="4a52" class="graf--h3 graf-after--figure">Workaround for Meteor DDP limitation and client part of Meteor.subscribe() nuance if you want to subscribe for more nested fields of already received documents</h3><p name="1fbd" id="1fbd" class="graf--p graf-after--h3">Sounds like a rare case, doesn’t it? But it is not. See <a href="https://github.com/meteor/meteor/issues/903" data-href="https://github.com/meteor/meteor/issues/903" class="markup--anchor markup--p-anchor" rel="nofollow">#903</a>, <a href="https://github.com/meteor/meteor/issues/998" data-href="https://github.com/meteor/meteor/issues/998" class="markup--anchor markup--p-anchor" rel="nofollow">#998</a> &amp; <a href="https://github.com/meteor/meteor/issues/3361" data-href="https://github.com/meteor/meteor/issues/3361" class="markup--anchor markup--p-anchor" rel="nofollow">#3361</a>. It’s only a matter of time until you face it.</p><p name="2a0e" id="2a0e" class="graf--p graf-after--p">Better to know about that when you modeling documents structure for a new app or faced with this limitation on already established document models like we at <a href="https://alpheratz.co/" data-href="https://alpheratz.co" class="markup--anchor markup--p-anchor" rel="nofollow">alpheratz.co</a> and need a workaround.</p><p name="87e0" id="87e0" class="graf--p graf-after--p">I think the most possible scenario when you could face it — it’s a reusing subscriptions. In the 2014 thanks for <a href="https://meteorhacks.com/subscription-manager-for-iron-router.html" data-href="https://meteorhacks.com/subscription-manager-for-iron-router.html" class="markup--anchor markup--p-anchor" rel="nofollow">Arunoda from Meteorhacks</a> Meteor community got <a href="https://atmospherejs.com/meteorhacks/subs-manager" data-href="https://atmospherejs.com/meteorhacks/subs-manager" class="markup--anchor markup--p-anchor" rel="nofollow">meteorhacks:subs-manager</a> package to make apps more <a href="https://bulletproofmeteor.com/basics/subscription-caching" data-href="https://bulletproofmeteor.com/basics/subscription-caching" class="markup--anchor markup--p-anchor" rel="nofollow">efficient</a> by making subscriptions caching play nice with <a href="https://www.google.ru/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0CB4QFjAA&amp;url=https%3A%2F%2Fgithub.com%2FEventedMind%2Firon-router&amp;ei=vvueVIWgEebkyAOX-4GADA&amp;usg=AFQjCNFuqMTfn4Iq5kMN7du9a1Q3F9mLAw&amp;sig2=gC0RtiDy-p2KCZrpvERXuw&amp;bvm=bv.82001339,d.bGQ" data-href="https://www.google.ru/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0CB4QFjAA&amp;url=https%3A%2F%2Fgithub.com%2FEventedMind%2Firon-router&amp;ei=vvueVIWgEebkyAOX-4GADA&amp;usg=AFQjCNFuqMTfn4Iq5kMN7du9a1Q3F9mLAw&amp;sig2=gC0RtiDy-p2KCZrpvERXuw&amp;bvm=bv.82001339,d.bGQ" class="markup--anchor markup--p-anchor" rel="nofollow">Iron Router</a>. And we at Alpheratz decided to cache subs especially as one of the most important keys to get smooth views transitions in the future.</p><p name="3048" id="3048" data-align="center" class="graf--p graf-after--p">But something went wrong</p><figure name="024b" id="024b" class="graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 273px; max-height: 115px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 42.1%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*ri3W6sCyKUMKyzLc_2oZWA.png" data-width="273" data-height="115" data-scroll="native"><img src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/1-ri3W6sCyKUMKyzLc_2oZWA.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="30"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*ri3W6sCyKUMKyzLc_2oZWA.png" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/1-ri3W6sCyKUMKyzLc_2oZWA(1).png"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*ri3W6sCyKUMKyzLc_2oZWA.png"&gt;</noscript></div></div></figure><h3 name="3c8d" id="3c8d" class="graf--h3 graf-after--figure">Example of the issue</h3><p name="917e" id="917e" class="graf--p graf-after--h3">Here the whole document structure for the <a href="https://alpheratz.co/white-theme/nomad" data-href="https://alpheratz.co/white-theme/nomad" class="markup--anchor markup--p-anchor" rel="nofollow">album</a> from Albums MongoDB collection:</p><figure name="7b4b" id="7b4b" class="graf--figure graf--iframe graf-after--p"><div class="iframeContainer"><iframe width="700" height="250" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/3a425dd7eaf9b96ca97845c529697a0a.html" data-media-id="3a425dd7eaf9b96ca97845c529697a0a" allowfullscreen="" frameborder="0" style="height: 663px;"></iframe></div></figure><p name="39e8" id="39e8" class="graf--p graf-after--figure">When you go to the published version of the <a href="https://www.alpheratz.co/white-theme/nomad" data-href="https://www.alpheratz.co/white-theme/nomad" class="markup--anchor markup--p-anchor" rel="nofollow">album</a> you subscribe only for the&nbsp;<em class="markup--em markup--p-em">.published</em> nested fields. Since you visited album once — data was cached.</p><figure name="2536" id="2536" class="graf--figure graf--iframe graf-after--p"><div class="iframeContainer"><iframe width="700" height="250" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/3fda661d06aa5ac0dced94d45f37be5d.html" data-media-id="3fda661d06aa5ac0dced94d45f37be5d" allowfullscreen="" frameborder="0" style="height: 283px;"></iframe></div></figure><p name="2080" id="2080" class="graf--p graf-after--figure">Imagine you are the author of the album and want to edit it. You go to the album edit route <a href="https://www.alpheratz.co/my/a/YWNXpEzdfo7TEAPxZ/edit" data-href="https://www.alpheratz.co/my/a/YWNXpEzdfo7TEAPxZ/edit" class="markup--anchor markup--p-anchor" rel="nofollow">https://www.alpheratz.co/my/a/YWNXpEzdfo7TEAPxZ/edit</a> (won’t work if you are not logged in and not an album author). Subscrition on that route subscribes for the whole album document.</p><blockquote name="1cbe" id="1cbe" class="graf--blockquote graf-after--p">note that we didn’t unsubscribe from album data received earlier since we cached that sub with subs-manager</blockquote><p name="a551" id="a551" class="graf--p graf-after--blockquote">Since you already have all album fields except&nbsp;<em class="markup--em markup--p-em">.unpublished</em> nested fields you expect that Meteor efficiently send only them to you.</p><figure name="b769" id="b769" class="graf--figure graf--iframe graf-after--p"><div class="iframeContainer"><iframe width="700" height="250" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/c87f22af35e51b67e74091c0dfb49038.html" data-media-id="c87f22af35e51b67e74091c0dfb49038" allowfullscreen="" frameborder="0" style="height: 243px;"></iframe></div></figure><p name="dc9a" id="dc9a" class="graf--p graf-after--figure">Unfortunately it won’t happen. You will only have what you already had — title and slug with&nbsp;.published fields.</p><p name="1902" id="1902" class="graf--p graf-after--p">You won’t face with it if you previously unsubscribed from album data and subscribe to the whole album doc again. It’s not our case — we building efficient app which sends as minimal data as possible.</p><h3 name="1ee8" id="1ee8" class="graf--h3 graf-after--p">Why you can’t subscribe for more nested fields of already received documents?</h3><p name="fcac" id="fcac" class="graf--p graf-after--h3">At first we subscribed for published version of album data and Meteor sent to following DDP message to the client:</p><figure name="bfa6" id="bfa6" class="graf--figure graf--iframe graf-after--p"><div class="iframeContainer"><iframe width="700" height="250" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/63d97124c2a497e7823f9e83082b9ddf.html" data-media-id="63d97124c2a497e7823f9e83082b9ddf" allowfullscreen="" frameborder="0" style="height: 403px;"></iframe></div></figure><p name="fc7f" id="fc7f" class="graf--p graf-after--figure">Then we went to album edit and sent subscription request for the whole album doc especially expecting&nbsp;.unpublished fields.</p><p name="38ad" id="38ad" class="graf--p graf-after--p">On the server <a href="https://meteorhacks.com/understanding-mergebox.html" data-href="https://meteorhacks.com/understanding-mergebox.html" class="markup--anchor markup--p-anchor" rel="nofollow">Meteor MergeBox</a> decides how to smartly send as little as possible new data to the client. And MergeBox would be happy to send back to you only that missing&nbsp;.unpublished fields in DDP message like this:</p><figure name="a560" id="a560" class="graf--figure graf--iframe graf-after--p"><div class="iframeContainer"><iframe width="700" height="250" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/6dc9e57dcb5a15806634a242af60df79.html" data-media-id="6dc9e57dcb5a15806634a242af60df79" allowfullscreen="" frameborder="0" style="height: 363px;"></iframe></div></figure><p name="af52" id="af52" class="graf--p graf-after--figure">But it won’t happen.</p><p name="2e26" id="2e26" class="graf--p graf-after--p">DDP protocol has limitations.</p><blockquote name="21f6" id="21f6" class="graf--blockquote graf--startsWithDoubleQuote graf-after--p">“right now DDP only exposes top level fields of objects, which does keep the protocol much less complex.” —<a href="https://github.com/meteor/meteor/issues/903#issuecomment-16083907" data-href="https://github.com/meteor/meteor/issues/903#issuecomment-16083907" class="markup--anchor markup--blockquote-anchor" rel="nofollow"> David Glasser, MDG</a></blockquote><p name="d32b" id="d32b" class="graf--p graf-after--blockquote">DDP message sent to us was like this:</p><figure name="2272" id="2272" class="graf--figure graf--iframe graf-after--p"><div class="iframeContainer"><iframe width="700" height="250" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/bb33aa71a775a29f50c2bf60ab005839.html" data-media-id="bb33aa71a775a29f50c2bf60ab005839" allowfullscreen="" frameborder="0" style="height: 403px;"></iframe></div></figure><p name="e727" id="e727" class="graf--p graf-after--figure">Yeah, it’s over publishing but only by title and slug top-level fields.</p><p name="eedb" id="eedb" class="graf--p graf-after--p">So, OK OK. We actually subscribed for new nested fields data but why it didn’t appear in client collection?</p><p name="0d2d" id="0d2d" class="graf--p graf-after--p">Beacause of another Meteor nuance:</p><blockquote name="a720" id="a720" class="graf--blockquote graf--startsWithDoubleQuote graf-after--p"><em class="markup--em markup--blockquote-em">“If more than one subscription sends conflicting values for a field (same collection name, document ID, and field name), then the value on the client will be one of the published values, chosen arbitrarily.” — </em><a href="http://docs.meteor.com/#/full/meteor_subscribe" data-href="http://docs.meteor.com/#/full/meteor_subscribe" class="markup--anchor markup--blockquote-anchor" rel="nofollow"><em class="markup--em markup--blockquote-em">Meteor.subscribe</em></a><em class="markup--em markup--blockquote-em"> last paragraph in Meteor API docs.</em></blockquote><p name="50d8" id="50d8" class="graf--p graf-after--blockquote"><strong class="markup--strong markup--p-strong">Arbitrarily.</strong></p><p name="da35" id="da35" class="graf--p graf-after--p">We need a workaround.</p><h3 name="95fe" id="95fe" class="graf--h3 graf-after--p">Workaround</h3><h4 name="5a6f" id="5a6f" class="graf--h4 graf-after--h3">If you planning to build new app or ready to refactor current doc models</h4><p name="36ef" id="36ef" class="graf--p graf-after--h4">You can model documents structure in other ways.</p><p name="f7e6" id="f7e6" class="graf--p graf-after--p">Like this:</p><figure name="e098" id="e098" class="graf--figure graf--iframe graf-after--p"><div class="iframeContainer"><iframe width="700" height="250" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/28beb9520227d1033d80311bc473a90a.html" data-media-id="28beb9520227d1033d80311bc473a90a" allowfullscreen="" frameborder="0" style="height: 343px;"></iframe></div></figure><p name="130e" id="130e" class="graf--p graf-after--figure">Now when you go to album editor album doc extending will happen by the top-level&nbsp;.unpublished fields.</p><p name="6c6e" id="6c6e" class="graf--p graf-after--p">Or like this:</p><figure name="bdea" id="bdea" class="graf--figure graf--iframe graf-after--p"><div class="iframeContainer"><iframe width="700" height="250" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/01ca97cb4fc5f27bf37a088f97879b8b.html" data-media-id="01ca97cb4fc5f27bf37a088f97879b8b" allowfullscreen="" frameborder="0" style="height: 223px;"></iframe></div></figure><p name="e915" id="e915" class="graf--p graf-after--figure graf--last">Idea is to expose nested fields to the top-level.</p></div></div></section><section name="86e7" class=" section--body"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class="section-content"><div class="section-inner layoutSingleColumn"><p name="41a7" id="41a7" class="graf--p graf--leading">I think both ways are wrong even if you modeling docs structure from scratch for a new app. Examples above is very simple. But I imagine how we will decide to add more fields related to the album title such as pre and sub title, styling and etc. Overall album document fields number may grow in the future. Doc will look like a mess without logic. Keeping logically separate data under own field is much cleaner even if parent field name is too vague.</p><p name="0f84" id="0f84" class="graf--p graf-after--p">And of course it’s a pain to restructure already established docs structure for in-production app.</p><p name="2ea7" id="2ea7" class="graf--p graf-after--p">Best solution should work nice with current docs structure and be ready to be thrown away when DDP protocol evolve.</p><h4 name="3014" id="3014" class="graf--h4 graf-after--p">If you want to stay on your current docs model and be flexible with your app and Meteor future changes</h4><p name="26f6" id="26f6" class="graf--p graf-after--h4">Our solution is to use supportive <strong class="markup--strong markup--p-strong">client-only collections</strong> to publish nested fields into them.</p><p name="1796" id="1796" class="graf--p graf-after--p">Supportive because their role is just to be fixing collection that contains only docs with only nested fields that cause issues.</p><p name="a218" id="a218" class="graf--p graf-after--p graf--last">It helps to avoid over publishing because of DDP limitations and client side same doc arbitrarily fields merging.</p></div></div></section><section name="287d" class=" section--body"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class="section-content"><div class="section-inner layoutSingleColumn"><p name="1bd6" id="1bd6" class="graf--p graf--leading">Let’s add client-only collection <strong class="markup--strong markup--p-strong">CC_Albums_unpublishedFields</strong></p><figure name="d2d4" id="d2d4" class="graf--figure graf--iframe graf-after--p"><div class="iframeContainer"><iframe width="700" height="250" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/3f3b19d906a4997d33725d8e59e5e933.html" data-media-id="3f3b19d906a4997d33725d8e59e5e933" allowfullscreen="" frameborder="0" style="height: 123px;"></iframe></div></figure><p name="e465" id="e465" class="graf--p graf-after--figure">«CC» — Client Collection</p><p name="10ac" id="10ac" class="graf--p graf-after--p">«Albums» — supportive for Albums collection</p><p name="13f3" id="13f3" class="graf--p graf-after--p">«unpublishedFields» — contains only album docs with&nbsp;.unpublished fields</p><p name="e31c" id="e31c" class="graf--p graf-after--p">Now we need to publish&nbsp;.unpublished fields in that collection when client subscribes for album_edit.</p><figure name="c4e6" id="c4e6" class="graf--figure graf--iframe graf-after--p"><div class="iframeContainer"><iframe width="700" height="250" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/51aefbe38cf999f4bf02f1fffc91056a.html" data-media-id="51aefbe38cf999f4bf02f1fffc91056a" allowfullscreen="" frameborder="0" style="height: 943px;"></iframe></div></figure><p name="2776" id="2776" class="graf--p graf-after--figure">This line saves the day:</p><figure name="b7f6" id="b7f6" class="graf--figure graf--iframe graf-after--p"><div class="iframeContainer"><iframe width="700" height="250" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/18a0edd4936a0d31deb46fe010d608aa(1).html" data-media-id="18a0edd4936a0d31deb46fe010d608aa" allowfullscreen="" frameborder="0" style="height: 63px;"></iframe></div></figure><p name="b4f6" id="b4f6" class="graf--p graf-after--figure">Also note to call this.ready() if you only do _publishCursor inside publication without returning cursor:</p><figure name="8ff2" id="8ff2" class="graf--figure graf--iframe graf-after--p graf--last"><div class="iframeContainer"><iframe width="700" height="250" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/d5367a1b5bf92abc8619dc58d7bea571.html" data-media-id="d5367a1b5bf92abc8619dc58d7bea571" allowfullscreen="" frameborder="0" style="height: 203px;"></iframe></div></figure></div></div></section><section name="0975" class=" section--body"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class="section-content"><div class="section-inner layoutSingleColumn"><p name="4cf7" id="4cf7" class="graf--p graf--leading">Here is the all our client-only collections and complete publication for album edit for the whole picture:</p><figure name="eb78" id="eb78" class="graf--figure graf--iframe graf-after--p graf--last"><div class="iframeContainer"><iframe width="700" height="250" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/208009bc7d8c9c727363d05ca2e2cd13.html" data-media-id="208009bc7d8c9c727363d05ca2e2cd13" allowfullscreen="" frameborder="0" style="height: 2523px;"></iframe></div></figure></div></div></section><section name="5eb9" class=" section--body"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class="section-content"><div class="section-inner layoutSingleColumn"><p name="db88" id="db88" class="graf--p graf--leading">After that there was a question — «Should we refactor collection updates methods on&nbsp;.unpublsihed fields to be performed against client-only collection like CC_Albums_unpublishedFields.update()?»</p><p name="ab93" id="ab93" class="graf--p graf-after--p">Fortunately it’s unnecessary.</p><p name="6359" id="6359" class="graf--p graf-after--p">Updates on&nbsp;.unpublished fields happens against Albums collection as usual despite the fact that Albums client side collection didn’t receive them.</p><p name="cf60" id="cf60" class="graf--p graf-after--p">We update:</p><figure name="1b0b" id="1b0b" class="graf--figure graf--iframe graf-after--p"><div class="iframeContainer"><iframe width="700" height="250" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/17c439f35986d2d13edffcd1bb87c8f8.html" data-media-id="17c439f35986d2d13edffcd1bb87c8f8" allowfullscreen="" frameborder="0" style="height: 363px;"></iframe></div></figure><p name="ece5" id="ece5" class="graf--p graf-after--figure">This&nbsp;.unpublished fields won’t appear in client Albums collection since we didn’t publish them into that collection.</p><p name="3434" id="3434" class="graf--p graf-after--p">But fortunately publication into client-only collection</p><figure name="c13f" id="c13f" class="graf--figure graf--iframe graf-after--p"><div class="iframeContainer"><iframe width="700" height="250" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/18a0edd4936a0d31deb46fe010d608aa(1).html" data-media-id="18a0edd4936a0d31deb46fe010d608aa" allowfullscreen="" frameborder="0" style="height: 63px;"></iframe></div></figure><p name="5366" id="5366" class="graf--p graf-after--figure">remains reactive</p><p name="115d" id="115d" class="graf--p graf-after--p">and after updating against Albums collection we reactively get&nbsp;.unpublished field changes in CC_Albums_unpublishedFields on the client.</p><p name="fb01" id="fb01" class="graf--p graf-after--p">We made refactor only when we need to make some operations with&nbsp;.unpublished fields data, like Publishing album:</p><figure name="0b16" id="0b16" class="graf--figure graf--iframe graf-after--p graf--last"><div class="iframeContainer"><iframe width="700" height="250" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/05b646b47c3217e53ec413891de28860.html" data-media-id="05b646b47c3217e53ec413891de28860" allowfullscreen="" frameborder="0" style="height: 1823px;"></iframe></div></figure></div></div></section><section name="9b30" class=" section--body section--last"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class="section-content"><div class="section-inner layoutSingleColumn"><p name="8290" id="8290" data-align="center" class="graf--p graf--leading">And both collections lived happily ever after</p><p name="e752" id="e752" data-align="center" class="graf--p graf-after--p">The End.</p><h3 name="a09e" id="a09e" class="graf--h3 graf-after--p">Tools to track data that comes to the client</h3><p name="27ee" id="27ee" class="graf--p graf-after--h3">These tools were very helpful during all «Reusing subscriptions» quest.</p><p name="29ec" id="29ec" class="graf--p graf-after--p"><a href="https://github.com/arunoda/meteor-ddp-analyzer" data-href="https://github.com/arunoda/meteor-ddp-analyzer" class="markup--anchor markup--p-anchor" rel="nofollow">ddp-analyzer</a> — thanks Arunoda</p><p name="2cfd" id="2cfd" class="graf--p graf-after--p graf--last"><a href="https://atmospherejs.com/msavin/mongoinspector" data-href="https://atmospherejs.com/msavin/mongoinspector" class="markup--anchor markup--p-anchor" rel="nofollow">MongoInspector</a> — thanks Max Savin</p></div></div></section></main><footer class="u-paddingTop10"><div class="container u-maxWidth740"><div class="row"><div class="col u-size12of12"></div></div><div class="row"><div class="col u-size12of12 js-postTags"><div class="postTags"><div class="tags tags--postTags tags--borderless"></div></div></div></div><div class="row js-postActionsFooter"><div class="postActions col u-size12of12"><div class="u-floatLeft buttonSet buttonSet--withLabels"><div class="buttonSet-inner"><div class="js-actionRecommend" data-post-id="eb3fdbfe4e07" data-is-icon-29px="true" data-source="post_actions_footer"><button class="button button--primary button--large button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon u-accentColor--iconLight" title="Recommend to share this article with your followers and let the author know you liked it" aria-label="Recommend to share this article with your followers and let the author know you liked it" data-action="sign-in-prompt" data-sign-in-action="upvote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/eb3fdbfe4e07" data-action-source="post_actions_footer"><span class="button-defaultState"><span class="svgIcon svgIcon--heart svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.215 23.716c-.348.288-.984.826-1.376 1.158a.526.526 0 0 1-.68 0c-.36-.307-.92-.78-1.22-1.03C9.22 20.734 3 15.527 3 10.734 3 7.02 5.916 4 9.5 4c1.948 0 3.77.898 5 2.434C15.73 4.898 17.552 4 19.5 4c3.584 0 6.5 3.02 6.5 6.734 0 4.9-6.125 9.96-9.785 12.982zM19.5 5.2c-1.774 0-3.423.923-4.41 2.468a.699.699 0 0 1-.59.323.706.706 0 0 1-.59-.32c-.988-1.54-2.637-2.47-4.41-2.47-2.922 0-5.3 2.49-5.3 5.54 0 4.23 6.19 9.41 9.517 12.19.217.18.566.48.783.66l.952-.79c3.496-2.88 9.348-7.72 9.348-12.05 0-3.05-2.378-5.53-5.3-5.53z"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--heartFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.5 4c-1.948 0-3.77.898-5 2.434C13.27 4.898 11.448 4 9.5 4 5.916 4 3 7.02 3 10.734c0 4.793 6.227 10 9.95 13.11.296.25.853.723 1.212 1.03.196.166.48.166.677 0 .39-.332 1.02-.87 1.37-1.158 3.66-3.022 9.79-8.08 9.79-12.982C26 7.02 23.08 4 19.5 4z" fill-rule="evenodd"></path></svg></span></span></button><button class="button button--chromeless u-baseColor--buttonNormal" data-action="show-recommends" data-action-value="eb3fdbfe4e07">10</button></div></div><div class="buttonSet-inner"><button class="button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon" data-action="scroll-to-responses" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span></button></div></div><div class="u-floatRight buttonSet buttonSet--narrow"><button class="button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path></svg></span></button><button class="button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path></svg></span></button></div></div></div></div><div class="js-postPromotionWrapper postPromotionWrapper" data-location-id="footer_above_post_attribution"></div><div class="container u-maxWidth740 js-postAttributionFooterContainer"><div class="u-margin20"></div><div class="row js-postFooterInfo"><div class="col u-size12of12"><li class="card card-user"><div class="u-marginLeft20 u-floatRight"><span class="followState js-followState buttonSet-inner" data-user-id="44ee27f7a028"><button class="button button--small u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton" data-action="sign-in-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-action-source="footer_card"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton" data-action="sign-in-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/44ee27f7a028" data-action-source="footer_card_follow"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="card-imageWrapper "><a class="link avatar u-baseColor--link" href="https://medium.com/@MaxDubrovin?source=footer_card" title="Go to the profile of Maxim Dubrovin" aria-label="Go to the profile of Maxim Dubrovin" data-action-source="footer_card" data-user-id="44ee27f7a028" dir="auto"><img src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/1-Zox871B4YcNJdOrXuaWjfQ.jpeg" class="avatar-image avatar-image--small" alt="Go to the profile of Maxim Dubrovin"></a></div><div class="card-content"><h3 class="card-name"><a class="link link--primary u-accentColor--hoverTextNormal" href="https://medium.com/@MaxDubrovin" property="cc:attributionName" title="Go to the profile of Maxim Dubrovin" aria-label="Go to the profile of Maxim Dubrovin" rel="author cc:attributionUrl" data-user-id="44ee27f7a028" dir="auto">Maxim Dubrovin</a></h3><p class="card-description">web developer in a space odyssey with Astroshock.ru team</p></div></li></div></div></div><div class="js-postBundleWrapper postBundleWrapper"></div><div class="js-postFooterPlacements"></div><div class="responsesWrapper supplementalPostContent js-responsesWrapper" data-action-scope="_actionscope_5"><div class="container u-maxWidth740"><div class="responsesStreamWrapper u-maxWidth640 js-responsesStreamWrapper"><div class="container u-maxWidth640 responsesStream-title"><div class="row"><div class="col u-size12of12"><div class="heading u-clearfix"><div class="u-clearfix"><div class="heading-content u-floatLeft"><span class="heading-title heading-title--semibold">Responses</span></div></div></div></div></div></div><div class="container u-maxWidth640 responsesStream-editor cardChromeless"><div class="row"><div class="col u-size12of12"><div class="responses-loggedOutPrompt js-responsesLoggedOutPrompt"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--withIconAndLabel button--loggedOutPrompt" data-action="sign-in-prompt" data-redirect="https://medium.com/@MaxDubrovin/workaround-for-meteor-limitations-if-you-want-to-sub-for-more-nested-fields-of-already-received-docs-eb3fdbfe4e07#--respond" data-action-source="logged_out_response_prompt"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span><span class="button-label  js-buttonLabel">Write a response…</span></button></div></div></div></div><div class="responsesStream js-responsesStream"></div><div class="container u-maxWidth640 u-hide js-showOtherResponses"><div class="row"><button class="button button--primary button--withChrome u-accentColor--buttonNormal responsesStream-showOtherResponses cardChromeless u-sizeFullWidth" data-action="show-other-responses">Show all responses</button></div></div><div class="responsesStream js-responsesStreamOther"></div></div></div></div><div class="supplementalPostContent js-readNext"></div><div class="supplementalPostContent js-heroPromo"></div></footer></article><div class="promoCardWrapper js-promoCardWrapper"><div class="promoCard"><button class="button button--close button--chromeless u-baseColor--buttonNormal" data-action="popup-dismiss">×</button><div class="promoCard-header">Don’t miss Maxim Dubrovin’s next story</div><div class="u-floatRight"><span class="followState js-followState buttonSet-inner" data-user-id="44ee27f7a028"><button class="button u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton" data-action="sign-in-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-action-source="user_follow_popup"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton" data-action="sign-in-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/44ee27f7a028" data-action-source="user_follow_popup_follow"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="avatar"><img src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/1-Zox871B4YcNJdOrXuaWjfQ(1).jpeg" class="avatar-image avatar-image--smaller" alt="Maxim Dubrovin"><span class="avatar-text">Maxim Dubrovin</span></div></div></div><div class="highlightMenu" data-action-scope="_actionscope_3"><div class="highlightMenu-inner"><div class="buttonSet buttonSet--highlightMenu"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu u-accentColor--highlightStrong js-highlightMenuQuoteButton" data-action="sign-in-prompt" data-sign-in-action="quote" data-requires-token="true" data-redirect-type="quote" data-action-source="quote_menu"><span class="svgIcon svgIcon--highlighter svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M13.7 15.964l5.204-9.387-4.726-2.62-5.204 9.387 4.726 2.62zm-.493.885l-1.313 2.37-1.252.54-.702 1.263-3.796-.865 1.228-2.213-.202-1.35 1.314-2.37 4.722 2.616z" fill-rule="evenodd"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu " data-action="sign-in-prompt" data-sign-in-action="quote-respond" data-action-source="quote_menu"><span class="svgIcon svgIcon--responseFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19.074 21.117c-1.244 0-2.432-.37-3.532-1.096a7.792 7.792 0 0 1-.703-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.662 0 8.457 3.5 8.457 7.803 0 2.058-.85 3.984-2.403 5.448.023.17.06.35.118.55.192.69.537 1.38 1.026 2.04.15.21.172.48.058.7a.686.686 0 0 1-.613.38h-.03z" fill-rule="evenodd"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu " data-action="twitter" data-action-source="quote_menu"><span class="svgIcon svgIcon--twitterFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M21.725 5.338c-.744.47-1.605.804-2.513 1.006a3.978 3.978 0 0 0-2.942-1.293c-2.22 0-4.02 1.81-4.02 4.02 0 .32.034.63.07.94-3.31-.18-6.27-1.78-8.255-4.23a4.544 4.544 0 0 0-.574 2.01c.04 1.43.74 2.66 1.8 3.38-.63-.01-1.25-.19-1.79-.5v.08c0 1.93 1.38 3.56 3.23 3.95-.34.07-.7.12-1.07.14-.25-.02-.5-.04-.72-.07.49 1.58 1.97 2.74 3.74 2.8a8.49 8.49 0 0 1-5.02 1.72c-.3-.03-.62-.04-.93-.07A11.447 11.447 0 0 0 8.88 21c7.386 0 11.43-6.13 11.414-11.414.015-.21.01-.38 0-.578a7.604 7.604 0 0 0 2.01-2.08 7.27 7.27 0 0 1-2.297.645 3.856 3.856 0 0 0 1.72-2.23"></path></svg></span></button><div class="buttonSet-separator"></div><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu " data-action="sign-in-prompt" data-sign-in-action="highlight" data-action-source="quote_menu"><span class="svgIcon svgIcon--privatenoteFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M17.662 4.552H7.346A4.36 4.36 0 0 0 3 8.898v5.685c0 2.168 1.614 3.962 3.697 4.28v2.77c0 .303.35.476.59.29l3.904-2.994h6.48c2.39 0 4.35-1.96 4.35-4.35V8.9c0-2.39-1.95-4.346-4.34-4.346zM16 14.31a.99.99 0 0 1-1.003.99h-4.994C9.45 15.3 9 14.85 9 14.31v-3.02a.99.99 0 0 1 1-.99v-.782a2.5 2.5 0 0 1 2.5-2.51c1.38 0 2.5 1.13 2.5 2.51v.782c.552.002 1 .452 1 .99v3.02z"></path><path d="M14 9.81c0-.832-.674-1.68-1.5-1.68-.833 0-1.5.84-1.5 1.68v.49h3v-.49z"></path></g></svg></span></button></div></div><div class="highlightMenu-arrowClip"><span class="highlightMenu-arrow"></span></div></div></div></div></div><div class="loadingBar"></div><script>// <![CDATA[
window["obvInit"] = function (opt_embedded) {window["obvInit"]["embedded"] = opt_embedded; window["obvInit"]["ready"] = true;}
// ]]></script><script>// <![CDATA[
var GLOBALS = {"audioUrl":"https://d1fcbxp97j4nb2.cloudfront.net","baseUrl":"https://medium.com","bestOfFirstSlug":"may-2013","bestOfLatestSlug":"april-2016","buildLabel":"22684-e4da144","currentUser":{"userId":"lo_752f35246d49","isVerified":false,"subscriberEmail":""},"currentUserHasUnverifiedEmail":false,"facebookKey":"542599432471018","facebookScope":["public_profile","email","user_friends"],"isAuthenticated":false,"isCurrentUserVerified":false,"language":"ru","loadingPlaceholderImg":"https://cdn-static-1.medium.com/_/fp/img/media-loading-placeholder.b31hiO4ynbDLRrXWEFF4aQ.png","mediumTwitterScreenName":"medium","miroUrl":"https://cdn-images-1.medium.com","moduleUrls":{"base":"https://cdn-static-1.medium.com/_/fp/js/main-base.bundle.DZDAeG6IXUPuK2JegLvaYQ.js","notes":"https://cdn-static-1.medium.com/_/fp/js/main-notes.bundle.DT6whI-Q37VugY4lmaFX1w.js","posters":"https://cdn-static-1.medium.com/_/fp/js/main-posters.bundle.GMsRk2LCoKajzuJJOR3ppQ.js","common-async":"https://cdn-static-1.medium.com/_/fp/js/main-common-async.bundle.54IL9DPs8cPtWLsAL9sBtg.js","stats":"https://cdn-static-1.medium.com/_/fp/js/main-stats.bundle.uvhA98m5qRVs3Gop_PJSQA.js","misc-screens":"https://cdn-static-1.medium.com/_/fp/js/main-misc-screens.bundle.CS0VX3EwVQn4JbKAEgdbTg.js"},"postColumnWidth":700,"previewConfig":{"weightThreshold":1,"weightImageParagraph":0.51,"weightIframeParagraph":0.8,"weightTextParagraph":0.08,"weightEmptyParagraph":0,"weightP":0.003,"weightH":0.005,"weightBq":0.003,"minPTextLength":60,"truncateBoundaryChars":20,"detectTitle":true,"detectTitleLevThreshold":0.15},"productName":"Medium","supportsEdit":true,"termsUrl":"//medium.com/policy/9db0094a1e0f","textshotHost":"textshot.medium.com","transactionId":"1467819061844:b3b0bc66a270","useragent":{"browser":"chrome","family":"chrome","os":"mac","version":49,"supportsDesktopEdit":true,"supportsInteract":true,"supportsView":true,"isMobile":false,"isTablet":false,"isNative":false,"supportsFileAPI":true,"isTier1":true,"clientVersion":"","unknownParagraphsBad":false,"clientChannel":"","supportsRealScrollEvents":true,"supportsVhUnits":true,"ruinsViewportSections":false,"supportsHtml5Video":true,"supportsMagicUnderlines":true,"isFacebook":false,"isWebView":false,"isFacebookWebView":false,"supportsProgressiveMedia":true,"isGoogle":false,"isApple":false,"supportsPromotedPosts":true,"supportsScrollableMetabar":true},"variants":{"allow_access":true,"allow_signup":true,"can_update_settings":true,"can_send_push_notifications":true,"can_export_data":true,"allow_test_auth":"disallow","enable_email_registration":true,"use_experimental_css":true,"can_resume_from_last_read_location":true,"can_follow_users":true,"receive_post_published_pushes":true,"receive_mention_pushes":true,"feed_homepage":true,"welcome_post_url":"https://about.medium.com","signin_services":"twitter,facebook,google,email,google-fastidv","signup_services":"twitter,facebook,google,email,google-fastidv","mobile_app_promotion":"dialog","enable_bing_search":true,"enable_algolia_search":true,"show_tagged_posts_in_search":true,"friends_only_quotes":true,"enable_user_search_with_bing":true,"enable_session_cookie_encryption":true,"enable_tag_follow_onboarding":true,"your_top_stories_source":"similar-posts","android_rating_prompt_recommend_threshold":5,"number_of_top_stories":3,"number_of_in_stream_global_top_stories":3,"enable_top_stories_in_stream":true,"enable_top_stories_in_stream_on_ios":true,"enable_top_stories_in_stream_on_android":true,"enable_post_recommend_threshold_in_stream":true,"enable_response_recommend_threshold_in_stream":true,"post_recommend_threshold":1,"response_recommend_threshold":2,"google_sign_in_android":true,"enable_pile_on_activity":true,"enable_onboarding":true,"enable_activity_rollup":true,"custom_miro_url":"https://cdn-images-1.medium.com","ios_custom_miro_url":"https://cdn-images-1.medium.com","enable_friends_recommends_plugin":true,"receive_follow_pushes":true,"receive_recommend_pushes":true,"receive_response_pushes":true,"receive_highlight_pushes":true,"enable_small_first_page":true,"reengagement_notification_duration":3,"enable_oauth_api":true,"enable_oauth_token_self_issuance":true,"enable_oauth_app_creation":true,"list_of_lists_bucket":"default","enable_user_social_count_healing":true,"enable_social_counts_from_user_stat_total":true,"enable_responses_stream":true,"enable_follow_lists_from_dynamo":true,"track_with_social_id":true,"enable_related_reads_webui":true,"enable_post_bundles_strategy_tag_based":true,"enable_hopper_for_tag_based_post_bundles":true,"enable_post_bundles_strategy_author_based":true,"enable_post_bundles_strategy_collection_based":true,"show_author_writes_about":true,"enable_profile_stream_web":true,"enable_profile_stream_filters_web":true,"enable_profile_nav":true,"top_stories_experiment_source":"topStories02","enable_new_home_feed":true,"add_top_stories_in_new_home_feed":true,"ranked_home_feed_time_decay_grace_period_in_hour":168,"ranked_home_feed_time_decay_hours_per_unit":24,"ranked_home_feed_time_decay_max_units":10,"receive_post_added_to_front_page_activity":true,"enable_post_feed_friend_recommended_write":true,"enable_post_feed_from_followed_tags_write":true,"use_user_signals_for_ranking":true,"can_enter_payment_details":"live","enable_adsnative_integration":true,"enable_post_promotion_tooltip":true,"enable_web_catalog_homepage":true,"enable_web_catalog_homepage_ts_nav":true,"enable_welcome_onboarding_email":true,"browsable_stream_config_bucket":"curated","ios_small_post_preview_truncation_length":5.5,"ios_large_post_preview_truncation_length":5.5,"allow_full_rss_feed_for_users":true,"allow_full_rss_feed_for_publications":true,"enable_onboarding_after_actions":true,"enable_welcome_email_digest":true,"enable_seen_bloom_filter":true,"disable_ios_catalog_badging":true,"enable_rerank_under_the_fold":true,"enable_ranked_feed_survey_promo":true,"enable_ios_textshots":true,"enable_textshots_v2":true,"enable_textshots_v2_web_ui":true,"enable_dark_sign_in_modals":true,"enable_promoted_story_above_post_footer":true,"enable_ios_personalization_promo":true,"digest_experiment":"control","enable_prepublish_share_settings":true,"enable_automatic_profile_registration":true,"enable_nav_on_stories":true,"enable_custom_domain_profiles":true,"enable_customize_slug":true,"enable_collection_post_nav_item":true,"enable_web_bio_lockups":true,"enable_related_reads_footer_grid_ui":true,"enable_logged_in_follow_on_collection_post":true,"enable_read_next_in_metabar":true,"social_recs_weight_factor":1,"social_recs_from_interest_graph_weight_factor":1,"social_recs_from_similar_user_weight_factor":1,"digest_total_post_count":30,"digest_posts_count_published_by_followed_users_and_collections":16,"digest_posts_count_recommended_by_users":5,"digest_posts_count_recommended_by_staff":5,"digest_posts_count_per_tag":2},"xsrfToken":"","iosAppId":"828256236","supportEmail":"yourfriends@medium.com","teamName":"Team Medium","fp":{"/img/apple-touch-icon-ipad-retina.png":"https://cdn-static-1.medium.com/_/fp/img/apple-touch-icon-ipad-retina.Akq8aSfZqfW1fceMxKqBZA.png","/img/apple-touch-icon-iphone-retina.png":"https://cdn-static-1.medium.com/_/fp/img/apple-touch-icon-iphone-retina.c211N_zSkSXPQk-ggPi4mQ.png","/img/apple-touch-icon-ipad.png":"https://cdn-static-1.medium.com/_/fp/img/apple-touch-icon-ipad.LSTr_8Uf-3hSd7eDjoW_8g.png","/img/apple-touch-icon.png":"https://cdn-static-1.medium.com/_/fp/img/apple-touch-icon.JWwtHOsKxVkBzoR3FSccjw.png","/img/default-avatar.png":"https://cdn-static-1.medium.com/_/fp/img/default-avatar.dmbNkD5D-u45r44go_cf0g.png","/img/default-preview-image.png":"https://cdn-static-1.medium.com/_/fp/img/default-preview-image.IsBK38jFAJBlWifMLO4z9g.png","/img/default-preview-image-v2.png":"https://cdn-static-1.medium.com/_/fp/img/default-preview-image-v2.MXL-j6S8fTEd8UFP_foEEw.png","/img/email/app_store_badge@2x.png":"https://cdn-static-1.medium.com/_/fp/img/email/app_store_badge@2x.8bDQGNMm-Xs7Hz6WA2XquQ.png","/img/email/app-devices@2x.png":"https://cdn-static-1.medium.com/_/fp/img/email/app-devices@2x.6hgpI423F62SKyT8Lo6dzA.png","/img/email/check1.png":"https://cdn-static-1.medium.com/_/fp/img/email/check1.0DM77li7vZhq5o2V9cVYLQ.png","/img/email/check2.png":"https://cdn-static-1.medium.com/_/fp/img/email/check2.GLlNusQmn1hwo9WDN-gE1w.png","/img/email/check3.png":"https://cdn-static-1.medium.com/_/fp/img/email/check3.7VxOUVMXAVbHRRnzMrJ_5A.png","/img/email/email-logo.png":"https://cdn-static-1.medium.com/_/fp/img/email/email-logo.x91rxfZYzIT9OJ5-ySD30A.png","/img/email/email-wordmark.png":"https://cdn-static-1.medium.com/_/fp/img/email/email-wordmark.gDTi-pejtOeN6Ux6a0MNFQ.png","/img/email/fb_logo.png":"https://cdn-static-1.medium.com/_/fp/img/email/fb_logo.Q0M98YwNTu77gLWTK6-RyQ.png","/img/email/google_play_badge@2x.png":"https://cdn-static-1.medium.com/_/fp/img/email/google_play_badge@2x.iWEWlt5_Qj20rr79-IGEBQ.png","/img/email/heart.png":"https://cdn-static-1.medium.com/_/fp/img/email/heart._hlyuYQiuuTWrRmDnDphJA.png","/img/email/heart@2x.png":"https://cdn-static-1.medium.com/_/fp/img/email/heart@2x.qvCTX1XHNpntqxt01oypQw.png","/img/email/heart1.png":"https://cdn-static-1.medium.com/_/fp/img/email/heart1.rnGEmSwcGUhztl_zSU7l6Q.png","/img/email/heart2.png":"https://cdn-static-1.medium.com/_/fp/img/email/heart2.HBiLu3koIYsKjjKroohgbA.png","/img/email/heart3.png":"https://cdn-static-1.medium.com/_/fp/img/email/heart3.AIJBOHw11HuhdClVJNtmtg.png","/img/email/large.png":"https://cdn-static-1.medium.com/_/fp/img/email/large.4EIhZbIk5sgqYSoB4YPmUA.png","/img/email/response.png":"https://cdn-static-1.medium.com/_/fp/img/email/response.5ZuN24N5XqS7ofHKg1lKXw.png","/img/email/response@2x.png":"https://cdn-static-1.medium.com/_/fp/img/email/response@2x.xzKQM4FzSurAVkghLQQWkA.png","/img/email/trophy.png":"https://cdn-static-1.medium.com/_/fp/img/email/trophy.YXqqMnNASKQDXZ46YdTWFA.png","/img/email/twitter_logo.png":"https://cdn-static-1.medium.com/_/fp/img/email/twitter_logo.Pz4a3o9WMU5QioxLKcyFhQ.png","/img/email/unlisted.png":"https://cdn-static-1.medium.com/_/fp/img/email/unlisted.ikh8R2LElOz_1YM8A2Db4g.png","/img/email/welcome-heart.png":"https://cdn-static-1.medium.com/_/fp/img/email/welcome-heart.6BRCOGcwGeOCBTql8pbq2g.png","/img/email/welcome-response.png":"https://cdn-static-1.medium.com/_/fp/img/email/welcome-response.iWVQLjiUG5pyQrPyGiYEpw.png","/img/email/welcome-write.png":"https://cdn-static-1.medium.com/_/fp/img/email/welcome-write.afdGsuE6YDk3HkaIASRl0w.png","/img/help/add-media-start.gif":"https://cdn-static-1.medium.com/_/fp/img/help/add-media-start.GXmqQ2Svt1WfZGIZSM93tg.gif","/img/help/add-media.gif":"https://cdn-static-1.medium.com/_/fp/img/help/add-media.SZH2LBmkwVExuhozFfVvYg.gif","/img/help/embed-start.gif":"https://cdn-static-1.medium.com/_/fp/img/help/embed-start.EBJ2PcWFJuYopsQV4wwklA.gif","/img/help/embed.gif":"https://cdn-static-1.medium.com/_/fp/img/help/embed.1BM0Di9vd91Kv8fLioJabw.gif","/img/help/text-highlight-start.gif":"https://cdn-static-1.medium.com/_/fp/img/help/text-highlight-start.AvTbakaFuUCd05YoMECoMQ.gif","/img/help/text-highlight.gif":"https://cdn-static-1.medium.com/_/fp/img/help/text-highlight.XVChoKYZ1-s3gJgHm9-7Yg.gif","/img/help/2.0-add-media.gif":"https://cdn-static-1.medium.com/_/fp/img/help/2.0-add-media.LhrJcTFODoqjnPPuHNEInA.gif","/img/help/2.0-add-media-start.png":"https://cdn-static-1.medium.com/_/fp/img/help/2.0-add-media-start.PTVdm36977cSfaYOpMNTNQ.png","/img/help/2.0-highlight-menu.gif":"https://cdn-static-1.medium.com/_/fp/img/help/2.0-highlight-menu.vMoUc7pXOyYFMJX68LXicw.gif","/img/help/2.0-highlight-menu-start.png":"https://cdn-static-1.medium.com/_/fp/img/help/2.0-highlight-menu-start.7vCytTKUZPOZvr_MCYADsA.png","/img/help/2.0-embed.gif":"https://cdn-static-1.medium.com/_/fp/img/help/2.0-embed.2g5jIXYtWjsRFa9D-hBhMQ.gif","/img/help/2.0-embed-start.png":"https://cdn-static-1.medium.com/_/fp/img/help/2.0-embed-start.LGy_FmixvcoEVIDKjg1jwA.png","/img/help/2.0-mention.gif":"https://cdn-static-1.medium.com/_/fp/img/help/2.0-mention.H9pEv0eHAvkGUVqdrHxH5g.gif","/img/help/2.0-mention-start.png":"https://cdn-static-1.medium.com/_/fp/img/help/2.0-mention-start.ShYTOfy6w3VDU9PKFfOEyw.png","/img/help/highlight-tips-1.gif":"https://cdn-static-1.medium.com/_/fp/img/help/highlight-tips-1.dEp02HXMKtAeKxsV5MWqGg.gif","/img/help/highlight-tips-2.gif":"https://cdn-static-1.medium.com/_/fp/img/help/highlight-tips-2.SyXCciYXeNpx4-GUAuh0XQ.gif","/img/import/highlight-menu.png":"https://cdn-static-1.medium.com/_/fp/img/import/highlight-menu.kzoaVM8mJJ-Hu9m9uo3Omg.png","/img/import/image-highlight-menu.png":"https://cdn-static-1.medium.com/_/fp/img/import/image-highlight-menu.q43-H2dl0JvBS_5znQCW8A.png","/img/import/publish-metabar.png":"https://cdn-static-1.medium.com/_/fp/img/import/publish-metabar.YbEX1a2Pu0rAR_LuKeg8JA.png","/img/payments/amex.png":"https://cdn-static-1.medium.com/_/fp/img/payments/amex.5EPSpIzX7GdCzJlp6ScaDw.png","/img/payments/diners.png":"https://cdn-static-1.medium.com/_/fp/img/payments/diners.NGD5bmkc-37YhAWWR1kzZQ.png","/img/payments/discover.png":"https://cdn-static-1.medium.com/_/fp/img/payments/discover.EZDA3I2LqtScyoBjwnpyAA.png","/img/payments/jcb.png":"https://cdn-static-1.medium.com/_/fp/img/payments/jcb.r4YW_7gdVvO70Y1uobs9zw.png","/img/payments/mastercard.png":"https://cdn-static-1.medium.com/_/fp/img/payments/mastercard.pkLRUgj9PI_snp1LBC8FYQ.png","/img/payments/placeholder.png":"https://cdn-static-1.medium.com/_/fp/img/payments/placeholder.UD4yFjC9YHrS0yCBRmRwvQ.png","/img/payments/visa.png":"https://cdn-static-1.medium.com/_/fp/img/payments/visa.0d40297wdAUwEkxSXQjBoQ.png","/img/payments/credit-card-sprite.png":"https://cdn-static-1.medium.com/_/fp/img/payments/credit-card-sprite.aNIJTodZTkf86-MUkQX7Xw.png","/img/signup/signup_education.png":"https://cdn-static-1.medium.com/_/fp/img/signup/signup_education.U40idKqxw3q2V5uNY4tV2w.png","/icons/favicon.svg":"https://cdn-static-1.medium.com/_/fp/icons/favicon.KjTfUJo7yJH_fCoUzzH3cg.svg","/icons/favicon-dev-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-dev-editor.YKKRxBO8EMvIqhyCwIiJeQ.ico","/icons/favicon-hatch-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-hatch-editor.BuEyHIqlyh2s_XEk4Rl32Q.ico","/icons/favicon-medium-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium-editor.PiakrZWB7Yb80quUVQWM6g.ico"},"facebookNamespace":"medium-com","authBaseUrl":"https://medium.com","imageUploadSizeMb":25,"isAuthDomainRequest":true,"algoliaApiEndpoint":"https://MQ57UUUQZ2-dsn.algolia.net","algoliaAppId":"MQ57UUUQZ2","algoliaSearchOnlyApiKey":"aadabda268e3bfaffe7b287709262fec","iosAppStoreUrl":"https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8","iosAppLinkBaseUrl":"medium:","algoliaIndexPrefix":"medium_","androidPlayStoreUrl":"https://play.google.com/store/apps/details?id=com.medium.reader","googleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","androidPackage":"com.medium.reader","androidPlayStoreMarketScheme":"market://details?id=com.medium.reader","googleAuthUri":"https://accounts.google.com/o/oauth2/auth","androidScheme":"medium","layoutData":{"useDynamicScripts":false,"googleAnalyticsTrackingCode":"UA-24232453-2","jsShivUrl":"https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js","cssFontUrls":["https://cdn-static-1.medium.com/_/fp/css/fonts-base.by5Oi_VbnwEIvhnWIsuUjA.css"],"useDynamicCss":false,"faviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium.TAS6uQ-Y7kcKgi0xjcYHXw.ico"},"authBaseUrlRev":"moc.muidem//:sptth","isDnt":false,"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","archiveUploadSizeMb":100,"paymentData":{"currencies":{"1":{"label":"US Dollar","external":"usd"}},"countries":{"1":{"label":"United States of America","external":"US"}},"accountTypes":{"1":{"label":"Individual","external":"individual"},"2":{"label":"Company","external":"company"}}},"previewConfig2":{"weightThreshold":1,"weightImageParagraph":0.05,"raiseImage":true,"enforceHeaderHierarchy":true,"isImageInsetRight":true},"isAmp":false,"iosScheme":"medium"}
// ]]></script><script charset="UTF-8" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/main-base.bundle.DZDAeG6IXUPuK2JegLvaYQ.js" async="true"></script><script>// <![CDATA[
window["obvInit"]({"value":{"id":"eb3fdbfe4e07","versionId":"bd0802a32a37","creatorId":"44ee27f7a028","creator":{"userId":"44ee27f7a028","name":"Maxim Dubrovin","username":"MaxDubrovin","createdAt":1395375633265,"lastPostCreatedAt":1421414578430,"imageId":"1*Zox871B4YcNJdOrXuaWjfQ.jpeg","backgroundImageId":"","bio":"web developer in a space odyssey with Astroshock.ru team","twitterScreenName":"MaxDubrovin","socialStats":{"userId":"44ee27f7a028","usersFollowedCount":107,"usersFollowedByCount":32,"type":"SocialStats"},"social":{"userId":"lo_752f35246d49","targetUserId":"44ee27f7a028","type":"Social"},"facebookAccountId":"","allowNotes":1,"type":"User"},"homeCollectionId":"","title":"Workaround for Meteor limitations if you want to sub for more nested fields of already received docs","detectedLanguage":"en","latestVersion":"bd0802a32a37","latestPublishedVersion":"bd0802a32a37","hasUnpublishedEdits":false,"latestRev":1707,"createdAt":1419527778727,"updatedAt":1439346863470,"acceptedAt":0,"firstPublishedAt":1419778065067,"latestPublishedAt":1419780052156,"vote":false,"experimentalCss":"","displayAuthor":"","content":{"subtitle":"It’s only a matter of time when you face it","bodyModel":{"paragraphs":[{"name":"2165","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*CnHxgy05Ds54HGQ8HJl62g.png","originalWidth":969,"originalHeight":780}},{"name":"4a52","type":3,"text":"Workaround for Meteor DDP limitation and client part of Meteor.subscribe() nuance if you want to subscribe for more nested fields of already received documents","markups":[]},{"name":"1fbd","type":1,"text":"Sounds like a rare case, doesn’t it? But it is not. See #903, #998 & #3361. It’s only a matter of time until you face it.","markups":[{"type":3,"start":56,"end":60,"href":"https://github.com/meteor/meteor/issues/903","title":"","rel":"","anchorType":0},{"type":3,"start":62,"end":66,"href":"https://github.com/meteor/meteor/issues/998","title":"","rel":"","anchorType":0},{"type":3,"start":69,"end":74,"href":"https://github.com/meteor/meteor/issues/3361","title":"","rel":"","anchorType":0}]},{"name":"2a0e","type":1,"text":"Better to know about that when you modeling documents structure for a new app or faced with this limitation on already established document models like we at alpheratz.co and need a workaround.","markups":[{"type":3,"start":158,"end":170,"href":"https://alpheratz.co","title":"","rel":"","anchorType":0}]},{"name":"87e0","type":1,"text":"I think the most possible scenario when you could face it — it’s a reusing subscriptions. In the 2014 thanks for Arunoda from Meteorhacks Meteor community got meteorhacks:subs-manager package to make apps more efficient by making subscriptions caching play nice with Iron Router. And we at Alpheratz decided to cache subs especially as one of the most important keys to get smooth views transitions in the future.","markups":[{"type":3,"start":113,"end":137,"href":"https://meteorhacks.com/subscription-manager-for-iron-router.html","title":"","rel":"","anchorType":0},{"type":3,"start":159,"end":183,"href":"https://atmospherejs.com/meteorhacks/subs-manager","title":"","rel":"","anchorType":0},{"type":3,"start":210,"end":219,"href":"https://bulletproofmeteor.com/basics/subscription-caching","title":"","rel":"","anchorType":0},{"type":3,"start":267,"end":278,"href":"https://www.google.ru/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=0CB4QFjAA&url=https%3A%2F%2Fgithub.com%2FEventedMind%2Firon-router&ei=vvueVIWgEebkyAOX-4GADA&usg=AFQjCNFuqMTfn4Iq5kMN7du9a1Q3F9mLAw&sig2=gC0RtiDy-p2KCZrpvERXuw&bvm=bv.82001339,d.bGQ","title":"","rel":"","anchorType":0}]},{"name":"3048","type":1,"text":"But something went wrong","markups":[],"alignment":2},{"name":"024b","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*ri3W6sCyKUMKyzLc_2oZWA.png","originalWidth":273,"originalHeight":115}},{"name":"3c8d","type":3,"text":"Example of the issue","markups":[]},{"name":"917e","type":1,"text":"Here the whole document structure for the album from Albums MongoDB collection:","markups":[{"type":3,"start":42,"end":47,"href":"https://alpheratz.co/white-theme/nomad","title":"","rel":"","anchorType":0}]},{"name":"7b4b","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"3a425dd7eaf9b96ca97845c529697a0a"}},{"name":"39e8","type":1,"text":"When you go to the published version of the album you subscribe only for the .published nested fields. Since you visited album once — data was cached.","markups":[{"type":3,"start":44,"end":49,"href":"https://www.alpheratz.co/white-theme/nomad","title":"","rel":"","anchorType":0},{"type":2,"start":77,"end":87}]},{"name":"2536","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"3fda661d06aa5ac0dced94d45f37be5d"}},{"name":"2080","type":1,"text":"Imagine you are the author of the album and want to edit it. You go to the album edit route https://www.alpheratz.co/my/a/YWNXpEzdfo7TEAPxZ/edit (won’t work if you are not logged in and not an album author). Subscrition on that route subscribes for the whole album document.","markups":[{"type":3,"start":92,"end":144,"href":"https://www.alpheratz.co/my/a/YWNXpEzdfo7TEAPxZ/edit","title":"","rel":"nofollow","anchorType":0}]},{"name":"1cbe","type":6,"text":"note that we didn’t unsubscribe from album data received earlier since we cached that sub with subs-manager","markups":[]},{"name":"a551","type":1,"text":"Since you already have all album fields except .unpublished nested fields you expect that Meteor efficiently send only them to you.","markups":[{"type":2,"start":47,"end":59}]},{"name":"b769","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"c87f22af35e51b67e74091c0dfb49038"}},{"name":"dc9a","type":1,"text":"Unfortunately it won’t happen. You will only have what you already had — title and slug with .published fields.","markups":[]},{"name":"1902","type":1,"text":"You won’t face with it if you previously unsubscribed from album data and subscribe to the whole album doc again. It’s not our case — we building efficient app which sends as minimal data as possible.","markups":[]},{"name":"1ee8","type":3,"text":"Why you can’t subscribe for more nested fields of already received documents?","markups":[]},{"name":"fcac","type":1,"text":"At first we subscribed for published version of album data and Meteor sent to following DDP message to the client:","markups":[]},{"name":"bfa6","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"63d97124c2a497e7823f9e83082b9ddf"}},{"name":"fc7f","type":1,"text":"Then we went to album edit and sent subscription request for the whole album doc especially expecting .unpublished fields.","markups":[]},{"name":"38ad","type":1,"text":"On the server Meteor MergeBox decides how to smartly send as little as possible new data to the client. And MergeBox would be happy to send back to you only that missing .unpublished fields in DDP message like this:","markups":[{"type":3,"start":14,"end":29,"href":"https://meteorhacks.com/understanding-mergebox.html","title":"","rel":"","anchorType":0}]},{"name":"a560","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"6dc9e57dcb5a15806634a242af60df79"}},{"name":"af52","type":1,"text":"But it won’t happen.","markups":[]},{"name":"2e26","type":1,"text":"DDP protocol has limitations.","markups":[]},{"name":"21f6","type":6,"text":"“right now DDP only exposes top level fields of objects, which does keep the protocol much less complex.” — David Glasser, MDG","markups":[{"type":3,"start":107,"end":126,"href":"https://github.com/meteor/meteor/issues/903#issuecomment-16083907","title":"","rel":"","anchorType":0}]},{"name":"d32b","type":1,"text":"DDP message sent to us was like this:","markups":[]},{"name":"2272","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"bb33aa71a775a29f50c2bf60ab005839"}},{"name":"e727","type":1,"text":"Yeah, it’s over publishing but only by title and slug top-level fields.","markups":[]},{"name":"eedb","type":1,"text":"So, OK OK. We actually subscribed for new nested fields data but why it didn’t appear in client collection?","markups":[]},{"name":"0d2d","type":1,"text":"Beacause of another Meteor nuance:","markups":[]},{"name":"a720","type":6,"text":"“If more than one subscription sends conflicting values for a field (same collection name, document ID, and field name), then the value on the client will be one of the published values, chosen arbitrarily.” — Meteor.subscribe last paragraph in Meteor API docs.","markups":[{"type":3,"start":210,"end":226,"href":"http://docs.meteor.com/#/full/meteor_subscribe","title":"","rel":"","anchorType":0},{"type":2,"start":0,"end":261}]},{"name":"50d8","type":1,"text":"Arbitrarily.","markups":[{"type":1,"start":0,"end":12}]},{"name":"da35","type":1,"text":"We need a workaround.","markups":[]},{"name":"95fe","type":3,"text":"Workaround","markups":[]},{"name":"5a6f","type":13,"text":"If you planning to build new app or ready to refactor current doc models","markups":[]},{"name":"36ef","type":1,"text":"You can model documents structure in other ways.","markups":[]},{"name":"f7e6","type":1,"text":"Like this:","markups":[]},{"name":"e098","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"28beb9520227d1033d80311bc473a90a"}},{"name":"130e","type":1,"text":"Now when you go to album editor album doc extending will happen by the top-level .unpublished fields.","markups":[]},{"name":"6c6e","type":1,"text":"Or like this:","markups":[]},{"name":"bdea","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"01ca97cb4fc5f27bf37a088f97879b8b"}},{"name":"e915","type":1,"text":"Idea is to expose nested fields to the top-level.","markups":[]},{"name":"41a7","type":1,"text":"I think both ways are wrong even if you modeling docs structure from scratch for a new app. Examples above is very simple. But I imagine how we will decide to add more fields related to the album title such as pre and sub title, styling and etc. Overall album document fields number may grow in the future. Doc will look like a mess without logic. Keeping logically separate data under own field is much cleaner even if parent field name is too vague.","markups":[]},{"name":"0f84","type":1,"text":"And of course it’s a pain to restructure already established docs structure for in-production app.","markups":[]},{"name":"2ea7","type":1,"text":"Best solution should work nice with current docs structure and be ready to be thrown away when DDP protocol evolve.","markups":[]},{"name":"3014","type":13,"text":"If you want to stay on your current docs model and be flexible with your app and Meteor future changes","markups":[]},{"name":"26f6","type":1,"text":"Our solution is to use supportive client-only collections to publish nested fields into them.","markups":[{"type":1,"start":34,"end":57}]},{"name":"1796","type":1,"text":"Supportive because their role is just to be fixing collection that contains only docs with only nested fields that cause issues.","markups":[]},{"name":"a218","type":1,"text":"It helps to avoid over publishing because of DDP limitations and client side same doc arbitrarily fields merging.","markups":[]},{"name":"1bd6","type":1,"text":"Let’s add client-only collection CC_Albums_unpublishedFields","markups":[{"type":1,"start":33,"end":60}]},{"name":"d2d4","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"3f3b19d906a4997d33725d8e59e5e933"}},{"name":"e465","type":1,"text":"«CC» — Client Collection","markups":[]},{"name":"10ac","type":1,"text":"«Albums» — supportive for Albums collection","markups":[]},{"name":"13f3","type":1,"text":"«unpublishedFields» — contains only album docs with .unpublished fields","markups":[]},{"name":"e31c","type":1,"text":"Now we need to publish .unpublished fields in that collection when client subscribes for album_edit.","markups":[]},{"name":"c4e6","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"51aefbe38cf999f4bf02f1fffc91056a"}},{"name":"2776","type":1,"text":"This line saves the day:","markups":[]},{"name":"b7f6","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"18a0edd4936a0d31deb46fe010d608aa"}},{"name":"b4f6","type":1,"text":"Also note to call this.ready() if you only do _publishCursor inside publication without returning cursor:","markups":[]},{"name":"8ff2","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"d5367a1b5bf92abc8619dc58d7bea571"}},{"name":"4cf7","type":1,"text":"Here is the all our client-only collections and complete publication for album edit for the whole picture:","markups":[]},{"name":"eb78","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"208009bc7d8c9c727363d05ca2e2cd13"}},{"name":"db88","type":1,"text":"After that there was a question — «Should we refactor collection updates methods on .unpublsihed fields to be performed against client-only collection like CC_Albums_unpublishedFields.update()?»","markups":[]},{"name":"ab93","type":1,"text":"Fortunately it’s unnecessary.","markups":[]},{"name":"6359","type":1,"text":"Updates on .unpublished fields happens against Albums collection as usual despite the fact that Albums client side collection didn’t receive them.","markups":[]},{"name":"cf60","type":1,"text":"We update:","markups":[]},{"name":"1b0b","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"17c439f35986d2d13edffcd1bb87c8f8"}},{"name":"ece5","type":1,"text":"This .unpublished fields won’t appear in client Albums collection since we didn’t publish them into that collection.","markups":[]},{"name":"3434","type":1,"text":"But fortunately publication into client-only collection","markups":[]},{"name":"c13f","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"18a0edd4936a0d31deb46fe010d608aa"}},{"name":"5366","type":1,"text":"remains reactive","markups":[]},{"name":"115d","type":1,"text":"and after updating against Albums collection we reactively get .unpublished field changes in CC_Albums_unpublishedFields on the client.","markups":[]},{"name":"fb01","type":1,"text":"We made refactor only when we need to make some operations with .unpublished fields data, like Publishing album:","markups":[]},{"name":"0b16","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"05b646b47c3217e53ec413891de28860"}},{"name":"8290","type":1,"text":"And both collections lived happily ever after","markups":[],"alignment":2},{"name":"e752","type":1,"text":"The End.","markups":[],"alignment":2},{"name":"a09e","type":3,"text":"Tools to track data that comes to the client","markups":[]},{"name":"27ee","type":1,"text":"These tools were very helpful during all «Reusing subscriptions» quest.","markups":[]},{"name":"29ec","type":1,"text":"ddp-analyzer — thanks Arunoda","markups":[{"type":3,"start":0,"end":12,"href":"https://github.com/arunoda/meteor-ddp-analyzer","title":"","rel":"","anchorType":0}]},{"name":"2cfd","type":1,"text":"MongoInspector — thanks Max Savin","markups":[{"type":3,"start":0,"end":14,"href":"https://atmospherejs.com/msavin/mongoinspector","title":"","rel":"","anchorType":0}]}],"sections":[{"name":"7111","startIndex":0},{"name":"86e7","startIndex":44},{"name":"287d","startIndex":51},{"name":"0975","startIndex":62},{"name":"5eb9","startIndex":64},{"name":"9b30","startIndex":76}]},"postDisplay":{"coverless":true}},"virtuals":{"createdAtRelative":"2 years ago","updatedAtRelative":"a year ago","acceptedAtRelative":"","createdAtEnglish":"December 25, 2014","updatedAtEnglish":"August 11, 2015","acceptedAtEnglish":"","firstPublishedAtEnglish":"December 28, 2014","latestPublishedAtEnglish":"December 28, 2014","allowNotes":true,"snippet":"It’s only a matter of time when you face it","previewImage":{"imageId":"1*CnHxgy05Ds54HGQ8HJl62g.png","filter":"","backgroundSize":"","originalWidth":969,"originalHeight":780,"strategy":"resample","height":0,"width":0},"wordCount":1025,"imageCount":2,"readingTime":4.25125786163522,"subtitle":"It’s only a matter of time when you face it","usersBySocialRecommends":[],"latestPublishedAtAbbreviated":"Dec 28, 2014","firstPublishedAtAbbreviated":"Dec 28, 2014","emailSnippet":"Workaround for Meteor DDP limitation and client part of Meteor.subscribe() nuance if you want to subscribe for more nested fields of already received documents ¶\n\nSounds like a rare case, doesn’t it? But it is not. See #903, #998 & #3361. It’s only a matter of time until you face it. ¶\n\nBetter to know about that when you modeling documents structure for a new app or faced with this limitation on already established document models like we at alpheratz.co","recommends":10,"socialRecommends":[],"isBookmarked":false,"tags":[],"socialRecommendsCount":0,"responsesCreatedCount":0,"links":{"entries":[],"version":"0.1"},"isLockedPreviewOnly":false},"coverless":true,"slug":"workaround-for-meteor-limitations-if-you-want-to-sub-for-more-nested-fields-of-already-received-docs","translationSourcePostId":"","translationSourceCreatorId":"","isApprovedTranslation":false,"inResponseToPostId":"","inResponseToRemovedAt":0,"isTitleSynthesized":false,"allowResponses":true,"importedUrl":"","importedPublishedAt":0,"visibility":0,"uniqueSlug":"workaround-for-meteor-limitations-if-you-want-to-sub-for-more-nested-fields-of-already-received-docs-eb3fdbfe4e07","previewContent":{"bodyModel":{"paragraphs":[{"name":"previewImage","type":4,"text":"","layout":10,"metadata":{"id":"1*CnHxgy05Ds54HGQ8HJl62g.png","originalWidth":969,"originalHeight":780}},{"name":"previewTitle","type":2,"text":"Workaround for Meteor limitations if you want to sub for more nested fields of already received docs","alignment":1}],"sections":[{"startIndex":0}]},"isFullContent":false},"license":0,"inResponseToMediaResourceId":"","canonicalUrl":"https://medium.com/@MaxDubrovin/workaround-for-meteor-limitations-if-you-want-to-sub-for-more-nested-fields-of-already-received-docs-eb3fdbfe4e07","approvedHomeCollectionId":"","newsletterId":"","webCanonicalUrl":"https://medium.com/@MaxDubrovin/workaround-for-meteor-limitations-if-you-want-to-sub-for-more-nested-fields-of-already-received-docs-eb3fdbfe4e07","mediumUrl":"https://medium.com/@MaxDubrovin/workaround-for-meteor-limitations-if-you-want-to-sub-for-more-nested-fields-of-already-received-docs-eb3fdbfe4e07","migrationId":"","notifyFollowers":true,"notifyTwitter":false,"isSponsored":false,"isRequestToPubDisabled":false,"type":"Post"},"collaborators":[],"membershipPlans":[],"footerPromo":{"promoId":"read_next_sign_in_tnt","isDismissable":false,"imageId":"1*trOZJzNWOEyh79Y1od6W-Q.png","streamIndex":0},"collectionUserRelations":[],"mode":null,"references":{"User":{"44ee27f7a028":{"userId":"44ee27f7a028","name":"Maxim Dubrovin","username":"MaxDubrovin","createdAt":1395375633265,"lastPostCreatedAt":1421414578430,"imageId":"1*Zox871B4YcNJdOrXuaWjfQ.jpeg","backgroundImageId":"","bio":"web developer in a space odyssey with Astroshock.ru team","twitterScreenName":"MaxDubrovin","socialStats":{"userId":"44ee27f7a028","usersFollowedCount":107,"usersFollowedByCount":32,"type":"SocialStats"},"social":{"userId":"lo_752f35246d49","targetUserId":"44ee27f7a028","type":"Social"},"facebookAccountId":"","allowNotes":1,"type":"User"}},"Social":{"44ee27f7a028":{"userId":"lo_752f35246d49","targetUserId":"44ee27f7a028","type":"Social"}},"SocialStats":{"44ee27f7a028":{"userId":"44ee27f7a028","usersFollowedCount":107,"usersFollowedByCount":32,"type":"SocialStats"}}}})
// ]]></script><div class="surface-scrollOverlay"></div><script charset="UTF-8" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/main-common-async.bundle.54IL9DPs8cPtWLsAL9sBtg.js"></script><script charset="UTF-8" src="./Workaround for Meteor limitations if you want to sub for more nested fields of already received docs — Medium_files/main-notes.bundle.DT6whI-Q37VugY4lmaFX1w.js"></script></body></html>