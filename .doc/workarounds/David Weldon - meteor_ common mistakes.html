<!DOCTYPE html>
<!-- saved from url=(0045)https://dweldon.silvrback.com/common-mistakes -->
<html class="csstransforms csstransforms3d csstransitions wf-fftisawebpro-n4-active wf-fftisawebpro-i4-active wf-fftisawebpro-n7-active wf-freightsanspro-n7-active sb-init wf-fftisawebpro-i7-active wf-freightsanspro-i3-active wf-freightsanspro-i4-active wf-freightsanspro-i5-active wf-freightsanspro-i6-active wf-freightsanspro-i7-active wf-freightsanspro-n3-active wf-freightsanspro-n4-active wf-freightsanspro-n5-active wf-freightsanspro-n6-active wf-active"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script type="text/javascript" src="./David Weldon - meteor_ common mistakes_files/9a6a49e4f0"></script><script src="./David Weldon - meteor_ common mistakes_files/nr-952.min.js"></script><script id="twitter-wjs" src="./David Weldon - meteor_ common mistakes_files/widgets.js"></script><script type="text/javascript" async="" src="./David Weldon - meteor_ common mistakes_files/ga.js"></script><script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"9a6a49e4f0","applicationID":"2607212","transactionName":"JwtXQEMLWF1SRU5aWAkBFkdZC0M=","queueTime":0,"applicationTime":9,"agent":""}</script>
<script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({1:[function(e,n,t){function r(e,n){return function(){o(e,[(new Date).getTime()].concat(a(arguments)),null,n)}}var o=e("handle"),i=e(2),a=e(3);"undefined"==typeof window.newrelic&&(newrelic=NREUM);var c=["setPageViewName","setCustomAttribute","finished","addToTrace","inlineHit"],u=["addPageAction"],f="api-";i(c,function(e,n){newrelic[n]=r(f+n,"api")}),i(u,function(e,n){newrelic[n]=r(f+n)}),n.exports=newrelic,newrelic.noticeError=function(e){"string"==typeof e&&(e=new Error(e)),o("err",[e,(new Date).getTime()])}},{}],2:[function(e,n,t){function r(e,n){var t=[],r="",i=0;for(r in e)o.call(e,r)&&(t[i]=n(r,e[r]),i+=1);return t}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],3:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(0>o?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=r},{}],ee:[function(e,n,t){function r(){}function o(e){function n(e){return e&&e instanceof r?e:e?c(e,a,i):i()}function t(t,r,o){e&&e(t,r,o);for(var i=n(o),a=l(t),c=a.length,u=0;c>u;u++)a[u].apply(i,r);var s=f[m[t]];return s&&s.push([w,t,r,i]),i}function p(e,n){g[e]=l(e).concat(n)}function l(e){return g[e]||[]}function d(e){return s[e]=s[e]||o(t)}function v(e,n){u(e,function(e,t){n=n||"feature",m[t]=n,n in f||(f[n]=[])})}var g={},m={},w={on:p,emit:t,get:d,listeners:l,context:n,buffer:v};return w}function i(){return new r}var a="nr@context",c=e("gos"),u=e(2),f={},s={},p=n.exports=o();p.backlog=f},{}],gos:[function(e,n,t){function r(e,n,t){if(o.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){o.buffer([e],r),o.emit(e,n,t)}var o=e("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!b++){var e=y.info=NREUM.info,n=s.getElementsByTagName("script")[0];if(e&&e.licenseKey&&e.applicationID&&n){u(m,function(n,t){e[n]||(e[n]=t)});var t="https"===g.split(":")[0]||e.sslForHttp;y.proto=t?"https://":"http://",c("mark",["onload",a()],null,"api");var r=s.createElement("script");r.src=y.proto+e.agent,n.parentNode.insertBefore(r,n)}}}function o(){"complete"===s.readyState&&i()}function i(){c("mark",["domContent",a()],null,"api")}function a(){return(new Date).getTime()}var c=e("handle"),u=e(2),f=window,s=f.document,p="addEventListener",l="attachEvent",d=f.XMLHttpRequest,v=d&&d.prototype;NREUM.o={ST:setTimeout,CT:clearTimeout,XHR:d,REQ:f.Request,EV:f.Event,PR:f.Promise,MO:f.MutationObserver},e(1);var g=""+location,m={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-952.min.js"},w=d&&v&&v[p]&&!/CriOS/.test(navigator.userAgent),y=n.exports={offset:a(),origin:g,features:{},xhrWrappable:w};s[p]?(s[p]("DOMContentLoaded",i,!1),f[p]("load",r,!1)):(s[l]("onreadystatechange",o),f[l]("onload",r)),c("mark",["firstbyte",a()],null,"api");var b=0},{}]},{},["loader"]);</script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>David Weldon - meteor: common mistakes</title>
  <meta name="description" content="meteor: common mistakes">
  <meta name="author" content="David Weldon">
  
  <!-- Do a conditional here to test for the theme selected in settings.-->
  <link href="./David Weldon - meteor_ common mistakes_files/kaia_theme-e7813ce6a1aa16790c15f13ba2823df6.css" media="all" rel="stylesheet" type="text/css">

<script src="./David Weldon - meteor_ common mistakes_files/application-55d5466ac2b26fd6f4998865c24385ee.js" type="text/javascript"></script><script type="text/javascript">try {
window.AG_onLoad = function(func) { if (window.addEventListener) { window.addEventListener('DOMContentLoaded', func); } };
window.AG_removeElementById = function(id) { var element = document.getElementById(id); if (element && element.parentNode) { element.parentNode.removeChild(element); }};
window.AG_removeElementBySelector = function(selector) { if (!document.querySelectorAll) { return; } var nodes = document.querySelectorAll(selector); if (nodes) { for (var i = 0; i < nodes.length; i++) { if (nodes[i] && nodes[i].parentNode) { nodes[i].parentNode.removeChild(nodes[i]); } } } };
window.AG_each = function(selector, fn) { if (!document.querySelectorAll) return; var elements = document.querySelectorAll(selector); for (var i = 0; i < elements.length; i++) { fn(elements[i]); }; };
var AG_removeParent = function(el, fn) { while (el && el.parentNode) { if (fn(el)) { el.parentNode.removeChild(el); return; } el = el.parentNode; } };
var AdFox_getCodeScript = function() {};
AG_onLoad(function() { window.AG_each('iframe[id^="AdFox_iframe_"]', function(el) { if (el && el.parentNode) { el.parentNode.removeChild(el); } }); });
try { Object.defineProperty(window, 'noAdsAtAll', { get: function() { return true; } }); } catch (ex) {}
} catch (ex) { console.error('Error executing AG js: ' + ex); }</script><style type="text/css"></style>

    <script type="text/javascript" src="./David Weldon - meteor_ common mistakes_files/cqm7mbn.js"></script>


    <script type="text/javascript">

        var _gaq = _gaq || [];
        //handles all back end tracking, and silvrback home tracking

        //pushes stats to user account, with either custom domain or subdomain. One or the other, not both. If custom domain is set, then silvrback subdomain tracking won't show for user.
        _gaq.push(['user._setAccount', 'UA-67703807-1']);
        _gaq.push(['user._setDomainName', 'silvrback.com']);
        _gaq.push(['user._setAllowLinker', true]);
        _gaq.push(['user._trackPageview']);

        //Send tracking data to 3rd profile. Tracks all front end user domain data (custom domains and subdomains)
        _gaq.push(['custom._setAccount', 'UA-43290725-3']);
        _gaq.push(['custom._setDomainName', 'silvrback.com']);
        _gaq.push(['custom._setAllowLinker', true]);
        _gaq.push(['custom._trackPageview']);


        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';

            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();

    </script>

  <link href="./David Weldon - meteor_ common mistakes_files/font-awesome.css" rel="stylesheet">

  <script type="text/javascript">var _sf_startpt = (new Date()).getTime()</script>
  <style type="text/css">.tk-ff-tisa-web-pro{font-family:"ff-tisa-web-pro",serif;}.title,.tk-freight-sans-pro{font-family:"freight-sans-pro","Myriad Pro","Myriad",sans-serif;}</style><link rel="stylesheet" href="./David Weldon - meteor_ common mistakes_files/l" media="all"><script type="text/javascript">try {
      Typekit.load();
  } catch (e) {
  }</script>
  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
  <![endif]-->
  <meta content="authenticity_token" name="csrf-param">
<meta content="IxMmnpU0XadFXpZEaRWTxktFLbGNK/iW/ARfbyMLNpw=" name="csrf-token">
    <meta property="og:url" content="https://dweldon.silvrback.com/common-mistakes">
  <meta property="og:title" content="David Weldon - meteor: common mistakes">
  <meta property="og:description" content="meteor: common mistakes">
    <meta property="og:image" content="https://silvrback.s3.amazonaws.com/uploads/94c431ce-0011-46c8-8c29-75f67d58ed75/dave_bw_large.jpg">
    <meta property="og:image:width" content="450">

    <meta property="og:image:height" content="298">
  <style>
    .theme_wrapper {
          background-color: #242729;
        }
        .header_background_text {
          color: #fff;
        }
        .header_background_text > ul > li >a {
          color: #fff;
        }
  </style>
  <style>
    .hll { background-color: #ffffcc }
.c { color: #408080; font-style: italic } /* Comment */
.err { border: 1px solid #FF0000 } /* Error */
.k { color: #008000; font-weight: bold } /* Keyword */
.o { color: #666666 } /* Operator */
.cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cp { color: #BC7A00 } /* Comment.Preproc */
.c1 { color: #408080; font-style: italic } /* Comment.Single */
.cs { color: #408080; font-style: italic } /* Comment.Special */
.gd { color: #A00000 } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #FF0000 } /* Generic.Error */
.gh { color: #000080; font-weight: bold } /* Generic.Heading */
.gi { color: #00A000 } /* Generic.Inserted */
.go { color: #888888 } /* Generic.Output */
.gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.gt { color: #0044DD } /* Generic.Traceback */
.kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.kp { color: #008000 } /* Keyword.Pseudo */
.kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.kt { color: #B00040 } /* Keyword.Type */
.m { color: #666666 } /* Literal.Number */
.s { color: #BA2121 } /* Literal.String */
.na { color: #7D9029 } /* Name.Attribute */
.nb { color: #008000 } /* Name.Builtin */
.nc { color: #0000FF; font-weight: bold } /* Name.Class */
.no { color: #880000 } /* Name.Constant */
.nd { color: #AA22FF } /* Name.Decorator */
.ni { color: #999999; font-weight: bold } /* Name.Entity */
.ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.nf { color: #0000FF } /* Name.Function */
.nl { color: #A0A000 } /* Name.Label */
.nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.nt { color: #008000; font-weight: bold } /* Name.Tag */
.nv { color: #19177C } /* Name.Variable */
.ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.w { color: #bbbbbb } /* Text.Whitespace */
.mb { color: #666666 } /* Literal.Number.Bin */
.mf { color: #666666 } /* Literal.Number.Float */
.mh { color: #666666 } /* Literal.Number.Hex */
.mi { color: #666666 } /* Literal.Number.Integer */
.mo { color: #666666 } /* Literal.Number.Oct */
.sb { color: #BA2121 } /* Literal.String.Backtick */
.sc { color: #BA2121 } /* Literal.String.Char */
.sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.s2 { color: #BA2121 } /* Literal.String.Double */
.se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.sh { color: #BA2121 } /* Literal.String.Heredoc */
.si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.sx { color: #008000 } /* Literal.String.Other */
.sr { color: #BB6688 } /* Literal.String.Regex */
.s1 { color: #BA2121 } /* Literal.String.Single */
.ss { color: #19177C } /* Literal.String.Symbol */
.bp { color: #008000 } /* Name.Builtin.Pseudo */
.vc { color: #19177C } /* Name.Variable.Class */
.vg { color: #19177C } /* Name.Variable.Global */
.vi { color: #19177C } /* Name.Variable.Instance */
.il { color: #666666 } /* Literal.Number.Integer.Long */
      .highlight {
        background-color: #f8f8f8;
      }
  </style>


  <link href="https://dweldon.silvrback.com/feed" rel="alternate" title="ATOM" type="application/atom+xml">
  <link href="https://dweldon.silvrback.com/feed.rss" rel="alternate" title="RSS" type="application/rss+xml">
<script type="text/javascript" async="" src="./David Weldon - meteor_ common mistakes_files/embed.js"></script><script async="" type="text/javascript" src="./David Weldon - meteor_ common mistakes_files/count.js"></script><style id="clearly_highlighting_css" type="text/css">/* selection */ html.clearly_highlighting_enabled ::-moz-selection { background: rgba(246, 238, 150, 0.99); } html.clearly_highlighting_enabled ::selection { background: rgba(246, 238, 150, 0.99); } /* cursor */ html.clearly_highlighting_enabled {    /* cursor and hot-spot position -- requires a default cursor, after the URL one */    cursor: url("chrome-extension://phmkpljilkopjoacakielhagnbbmdmgn/clearly/images/highlight--cursor.png") 14 16, text; } /* highlight tag */ em.clearly_highlight_element {    font-style: inherit !important; font-weight: inherit !important;    background-image: url("chrome-extension://phmkpljilkopjoacakielhagnbbmdmgn/clearly/images/highlight--yellow.png");    background-repeat: repeat-x; background-position: top left; background-size: 100% 100%; } /* the delete-buttons are positioned relative to this */ em.clearly_highlight_element.clearly_highlight_first { position: relative; } /* delete buttons */ em.clearly_highlight_element a.clearly_highlight_delete_element {    display: none; cursor: pointer;    padding: 0; margin: 0; line-height: 0;    position: absolute; width: 34px; height: 34px; left: -17px; top: -17px;    background-image: url("chrome-extension://phmkpljilkopjoacakielhagnbbmdmgn/clearly/images/highlight--delete-sprite.png"); background-repeat: no-repeat; background-position: 0px 0px; } em.clearly_highlight_element a.clearly_highlight_delete_element:hover { background-position: -34px 0px; } /* retina */ @media (min--moz-device-pixel-ratio: 2), (-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2) {    em.clearly_highlight_element { background-image: url("chrome-extension://phmkpljilkopjoacakielhagnbbmdmgn/clearly/images/highlight--yellow@2x.png"); }    em.clearly_highlight_element a.clearly_highlight_delete_element { background-image: url("chrome-extension://phmkpljilkopjoacakielhagnbbmdmgn/clearly/images/highlight--delete-sprite@2x.png"); background-size: 68px 34px; } } </style><style>[touch-action="none"]{ -ms-touch-action: none; touch-action: none; }[touch-action="pan-x"]{ -ms-touch-action: pan-x; touch-action: pan-x; }[touch-action="pan-y"]{ -ms-touch-action: pan-y; touch-action: pan-y; }[touch-action="scroll"],[touch-action="pan-x pan-y"],[touch-action="pan-y pan-x"]{ -ms-touch-action: pan-x pan-y; touch-action: pan-x pan-y; }</style><script src="./David Weldon - meteor_ common mistakes_files/count-data.js"></script><script src="./David Weldon - meteor_ common mistakes_files/alfie.f51946af45e0b561c60f768335c9eb79.js" async="" charset="UTF-8"></script></head>
<body class="home show">
<!-- conditional here for the theme body -->




<div id="sb-site" style="min-height: 900px;"><article class="theme_wrapper">
  <!--for user uploaded background pics-->
  <div class="banner_container">
</div>
<div class="shade"></div>



  <div class="kaia_page" style="position:relative; z-index:10">
    <div class="big_article_header">
      <h1 class="kaia_header_title header_background_text">meteor: common mistakes</h1>

      <div class="pic_and_name">
        <a href="https://dweldon.silvrback.com/"><img alt="Dave_bw_large" class="new_bio_pic" src="./David Weldon - meteor_ common mistakes_files/dave_bw_large.jpg"></a><div class="name_link">
             <a href="https://dweldon.silvrback.com/" class="header_background_text">David Weldon</a> 
          </div><div class="name_link tab_open">
            <p></p>Co-Founder and CTO at Edthena<p></p>

          </div>
      </div>
    </div>
  </div>

  <div class="article_body theme2_body">      
    <div class="kaia_page">
      <div class="article_padding theme2_content">
        <div class="all_external_links">
          <p>Over the past few years I've spent countless hours reviewing code and answering questions both on <a href="http://stackoverflow.com/questions/tagged/meteor" target="_blank">stackoverflow</a> and at the monthly <a href="http://www.meetup.com/Meteor-SFBay/" target="_blank">SF devshop</a>. There are certain patterns of mistakes and misunderstandings that most meteor developers (myself included) make on their journey toward learning the framework. In this post I'll catalog some of the most frequent occurrences in the hopes that you can avoid being bitten by at least one of them.</p>

<h2 id="profile-editing">Profile Editing</h2>

<p>Do you have any code that looks like this?</p>
<div class="highlight"><pre><span class="vg">if</span><span class="w"> </span><span class="p">(</span><span class="vg">Meteor</span><span class="o">.</span><span class="vg">user</span><span class="p">()</span><span class="o">.</span><span class="vg">profile</span><span class="o">.</span><span class="vg">isAdmin</span><span class="p">)</span>
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="vg">do</span><span class="w"> </span><span class="vg">important</span><span class="w"> </span><span class="vg">admin</span><span class="w"> </span><span class="vg">things</span>
</pre></div>
<p>If so, I've got some bad news for you. Any user can open up a console and run:</p>
<div class="highlight"><pre><span class="nx">Meteor</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">userId</span><span class="p">(),</span> <span class="p">{</span><span class="nx">$set</span><span class="o">:</span> <span class="p">{</span><span class="s1">'profile.isAdmin'</span><span class="o">:</span> <span class="kc">true</span><span class="p">}});</span>
</pre></div>
<p>Surprise! User profiles are editable by default even if <code>insecure</code> has been removed. To prevent this, just add the following <a href="http://docs.meteor.com/#/full/deny" target="_blank">deny rule</a>:</p>
<div class="highlight"><pre><span class="vg">Meteor</span><span class="o">.</span><span class="vg">users</span><span class="o">.</span><span class="vg">deny</span><span class="p">({</span>
<span class="w">  </span><span class="nl">update:</span><span class="w"> </span><span class="vg">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="vg">return</span><span class="w"> </span><span class="vg">true</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">});</span>
</pre></div>
<h2 id="find-and-fetch">Find and Fetch</h2>

<p>If meteor is your first introduction to mongodb, it may be unclear exactly how to read your documents out of a collection. A glance through the <a href="http://docs.meteor.com/" target="_blank">docs</a> reveals that there's a function called <a href="http://docs.meteor.com/#/full/find" target="_blank">find</a>. Logically, that's what you'd use to find your documents right? Well, sort of.</p>

<p><code>find</code> actually returns a <a href="http://docs.meteor.com/#/full/foreach" target="_blank">collection cursor</a>, which you can think of as an object used to iterate over and extract mongodb documents. <strong>It is not</strong> an array of documents.</p>

<p>This is additionally confusing for beginners because <a href="http://docs.meteor.com/#/full/template_helpers" target="_blank">template helpers</a> typically use cursors, so most tutorials will focus exclusively on <code>find</code>.</p>

<p>For those situations where you need to read the documents directly, you'll have to combine <code>find</code> with <a href="http://docs.meteor.com/#/full/fetch" target="_blank">fetch</a> like this:</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">puppies</span> <span class="o">=</span> <span class="nx">Dogs</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">age</span><span class="o">:</span> <span class="p">{</span><span class="nx">$lt</span><span class="o">:</span> <span class="mi">1</span><span class="p">}}).</span><span class="nx">fetch</span><span class="p">();</span>
</pre></div>
<p>Also note that if you ever want to find a single document, you can use the appropriately named <a href="http://docs.meteor.com/#/full/findone" target="_blank">findOne</a>.</p>

<h2 id="published-secrets">Published Secrets</h2>

<p>Let's say you have a publisher for all of the users in a group:</p>
<div class="highlight"><pre><span class="vg">Meteor</span><span class="o">.</span><span class="vg">publish</span><span class="p">(</span><span class="c1">'groupUsers', function(groupId) {</span>
<span class="w">  </span><span class="vg">check</span><span class="p">(</span><span class="vg">groupId</span><span class="p">,</span><span class="w"> </span><span class="vg">String</span><span class="p">);</span>
<span class="w">  </span><span class="vg">var</span><span class="w"> </span><span class="vg">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">Groups</span><span class="o">.</span><span class="vg">findOne</span><span class="p">(</span><span class="vg">groupId</span><span class="p">);</span>
<span class="w">  </span><span class="vg">var</span><span class="w"> </span><span class="vg">selector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nl">_id:</span><span class="w"> </span><span class="p">{</span><span class="err">$</span><span class="nl">in:</span><span class="w"> </span><span class="vg">group</span><span class="o">.</span><span class="vg">members</span><span class="p">}};</span>
<span class="w">  </span><span class="vg">return</span><span class="w"> </span><span class="vg">Meteor</span><span class="o">.</span><span class="vg">users</span><span class="o">.</span><span class="vg">find</span><span class="p">(</span><span class="vg">selector</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
<p>What's wrong with this (apart from the fact that it isn't <a href="http://stackoverflow.com/questions/26398952/meteor-publish-publish-collection-which-depends-on-other-collection" target="_blank">reactive</a>)?</p>

<p>Unless you specify which <a href="http://docs.meteor.com/#/full/find" target="_blank">fields</a> are to be returned, mongo will return <strong>all</strong> of them, which means that clients can see login tokens, encrypted passwords, and anything else stored in your user documents.</p>

<p>You must specify which fields you want when publishing user data in order to prevent leaking your user's secrets. The corrected function could look something like this:</p>
<div class="highlight"><pre><span class="vg">Meteor</span><span class="o">.</span><span class="vg">publish</span><span class="p">(</span><span class="c1">'groupUsers', function(groupId) {</span>
<span class="w">  </span><span class="vg">check</span><span class="p">(</span><span class="vg">groupId</span><span class="p">,</span><span class="w"> </span><span class="vg">String</span><span class="p">);</span>
<span class="w">  </span><span class="vg">var</span><span class="w"> </span><span class="vg">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">Groups</span><span class="o">.</span><span class="vg">findOne</span><span class="p">(</span><span class="vg">groupId</span><span class="p">);</span>
<span class="w">  </span><span class="vg">var</span><span class="w"> </span><span class="vg">selector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nl">_id:</span><span class="w"> </span><span class="p">{</span><span class="err">$</span><span class="nl">in:</span><span class="w"> </span><span class="vg">group</span><span class="o">.</span><span class="vg">members</span><span class="p">}};</span>
<span class="w">  </span><span class="vg">var</span><span class="w"> </span><span class="vg">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nl">fields:</span><span class="w"> </span><span class="p">{</span><span class="nl">username:</span><span class="w"> </span><span class="il">1</span><span class="p">}};</span>
<span class="w">  </span><span class="vg">return</span><span class="w"> </span><span class="vg">Meteor</span><span class="o">.</span><span class="vg">users</span><span class="o">.</span><span class="vg">find</span><span class="p">(</span><span class="vg">selector</span><span class="p">,</span><span class="w"> </span><span class="vg">options</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
<h2 id="variables-as-keys">Variables as Keys</h2>

<p>Building dynamic selectors is extremely common when creating a rich user interface. Imagine a user being able to search a collection of animals by a key (species, size, region, etc.) and a value from a text input. Your code could look something like:</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="s1">'species'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="s1">'elephant'</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">selector</span> <span class="o">=</span> <span class="p">{</span><span class="nx">key</span><span class="o">:</span> <span class="nx">value</span><span class="p">};</span>
<span class="nx">Animals</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span>
</pre></div>
<p>But there is a subtle JavaScript gotcha that will prevent this <code>find</code> from returning the right results:</p>

<blockquote>
<p>Using a variable identifier as a key in an object literal will substitute the identifier and not the value.</p>
</blockquote>

<p><code>selector</code> is actually evaluated as <code>{key: 'elephant'}</code> and not <code>{species: 'elephant'}</code> as intended. </p>

<p>In es5, the only way to fix this is to initialize <code>selector</code> as an empty object and then use bracket notation to set the key:</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="s1">'species'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="s1">'elephant'</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">selector</span> <span class="o">=</span> <span class="p">{};</span>
<span class="nx">selector</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
<span class="nx">Animals</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span>
</pre></div>
<p>In es6, we can use <a href="http://exploringjs.com/es6/ch_oop-besides-classes.html#_computed-property-keys-1" target="_blank">computed property keys</a>:</p>
<div class="highlight"><pre><span class="kr">const</span> <span class="nx">key</span> <span class="o">=</span> <span class="s1">'species'</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">value</span> <span class="o">=</span> <span class="s1">'elephant'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">selector</span> <span class="o">=</span> <span class="p">{[</span><span class="nx">key</span><span class="p">]</span><span class="o">:</span> <span class="nx">value</span><span class="p">};</span>
<span class="nx">Animals</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span>
</pre></div>
<h2 id="subscriptions-don-39-t-block">Subscriptions Don't Block</h2>

<p>Many aspects of the framework seem like magic. So much so that it may cause you to forget how web browsers work. Take this simple example:</p>
<div class="highlight"><pre><span class="nx">Meteor</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s1">'posts'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">post</span> <span class="o">=</span> <span class="nx">Posts</span><span class="p">.</span><span class="nx">findOne</span><span class="p">();</span>
</pre></div>
<p>The idea that <code>post</code> will be <code>undefined</code> is the root cause of roughly one in twenty meteor questions on stackoverflow.</p>

<p><code>subscribe</code> works like a garden hose - you turn it on and, after a while, things come out the other end. Activating the subscription does not block execution of the browser, therefore an immediate <code>find</code> on the collection won't return any data.</p>

<p><code>subscribe</code> does, however, have an optional callback which you can use like so:</p>
<div class="highlight"><pre><span class="nx">Meteor</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s1">'posts'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Posts</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">count</span><span class="p">());</span>
<span class="p">});</span>
</pre></div>
<p>Alternatively, you can call <code>ready</code> on the subscription handle:</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">handle</span> <span class="o">=</span> <span class="nx">Meteor</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s1">'posts'</span><span class="p">);</span>

<span class="nx">Tracker</span><span class="p">.</span><span class="nx">autorun</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">handle</span><span class="p">.</span><span class="nx">ready</span><span class="p">())</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Posts</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">count</span><span class="p">());</span>
<span class="p">});</span>
</pre></div>
<p>In more complex apps, your subscription activation code and your data consumption code are often very separate, which reduces the value of the above techniques. Fortunately there are two common ways of tackling the problem:</p>

<ol>
<li>If you use <a href="https://github.com/iron-meteor/iron-router" target="_blank">iron router</a>, you can <a href="https://github.com/iron-meteor/iron-router/blob/devel/Guide.md#the-waiton-option" target="_blank">wait on</a> subscriptions, prior to rendering the dependent templates.</li>
<li>You can use <a href="https://dweldon.silvrback.com/guards" target="_blank">guards</a> to check if the data exists within your template code.</li>
</ol>

<p>I'd recommend using a combination of both approaches in your applications depending on your UI requirements. Waiting on a subscription will force a delay before rendering the page, whereas guards will progressively render data as it's received on the client.</p>

<p><strong>Corollary</strong>: In meteor, the majority of "Cannot read property of undefined"errors are caused by an incorrect assumption about the existence of  subscribed data.</p>

<h2 id="overworked-helpers">Overworked Helpers</h2>

<p>Helpers act like a rosetta stone for your templates. They can read things like collection documents, session data, and the current template context,then mix it all up and spit out a nicely formatted result.</p>

<p>Notice that I didn't say anything about calling methods, changing state, or posting messages on twitter. This is because helpers are intended to be synchronous translators which are free of <a href="http://en.wikipedia.org/wiki/Side_effect_(computer_science)" target="_blank">side effects</a>.</p>

<p>Because helpers are reactive, developers are often tempted to use them as a shortcut to link changes together. To illustrate this point, here's an example helper which formats a post comment:</p>
<div class="highlight"><pre><span class="nx">Template</span><span class="p">.</span><span class="nx">postComment</span><span class="p">.</span><span class="nx">helpers</span><span class="p">({</span>
  <span class="nx">message</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">comment</span> <span class="o">=</span> <span class="nx">Comments</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">commentId</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'isExcited'</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">comment</span><span class="p">.</span><span class="nx">text</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span> <span class="o">+</span> <span class="s1">'!'</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">comment</span><span class="p">.</span><span class="nx">text</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>
<p>Now let's suppose we need to animate the message whenever the comment text changes. We could add some jQuery to our helper, but that makes a big assumption: that the helper only reruns under one condition. What if the session variable changes? What if some other property of the comment gets updated? What if changes in the parent cause <code>postComment</code> to be re-rendered?</p>

<p>It's safe to assume your helpers will run many more times than you expect them to. For this reason, its never a good idea to use them beyond their intended purpose. Instead you should use tools like <a href="http://docs.meteor.com/#/full/template_autorun" target="_blank">autorun</a> and <a href="http://docs.meteor.com/#/full/observe_changes" target="_blank">observeChanges</a> to solve these problems.</p>

<p>Note that if your helper needs the result of an asynchronous operation (like a method call) see the answers to <a href="https://stackoverflow.com/questions/22147813/how-to-use-meteor-methods-inside-of-a-template-helper" target="_blank">this question</a>.</p>

<h2 id="sorted-publish">Sorted Publish</h2>

<p>When you publish documents to the client, they are merged with other documents from the same collection and rearranged into an in-memory data store called <a href="https://www.meteor.com/mini-databases" target="_blank">minimongo</a>. The key word being <strong>rearranged</strong>.</p>

<p>Many new meteor developers have a mental model of published data as existing in an ordered list. This leads to questions like: "I published my data in sorted order, so why doesn't it appear that way on the client?" That's expected. There's one simple rule to follow:</p>

<blockquote>
<p>If you need your documents to be ordered on the client, sort them on the client.</p>
</blockquote>

<p>Sorting in a publish function isn't usually necessary unless the result of the sort changes which documents are sent (e.g. you are using a <code>limit</code>).</p>

<p>You may, however, want to retain the server-side sort in cases where the data transmission time is significant. Imagine publishing several hundred blog posts but initially showing only the most recent ten. In this case, having the most recent documents arrive on the client first would help minimize the number of template renderings. [1]</p>

<h2 id="data-attributes">Data Attributes</h2>

<p>Remember that hack where you used to stuff all of your application state into the DOM using data attributes? I constantly see code from new users that looks like this:</p>
<div class="highlight"><pre><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">"nametag"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">data-name=</span><span class="s">"{{name}}"</span><span class="nt">&gt;</span>{{name}}<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/template&gt;</span>
</pre></div><div class="highlight"><pre><span class="vg">Template</span><span class="o">.</span><span class="vg">nametag</span><span class="o">.</span><span class="vg">events</span><span class="p">({</span>
<span class="w">  </span><span class="nl">click:</span><span class="w"> </span><span class="vg">function</span><span class="p">(</span><span class="vg">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="vg">console</span><span class="o">.</span><span class="vg">log</span><span class="p">(</span><span class="err">$</span><span class="p">(</span><span class="vg">e</span><span class="o">.</span><span class="vg">currentTarget</span><span class="p">)</span><span class="o">.</span><span class="vg">data</span><span class="p">()</span><span class="o">.</span><span class="vg">name</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">});</span>
</pre></div>
<p>Meteor is here to stop the madness. Because helpers, event handlers, and templates share the same <a href="https://www.discovermeteor.com/blog/a-guide-to-meteor-templates-data-contexts/" target="_blank">context</a>, the same code should be written as:</p>
<div class="highlight"><pre><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">"nametag"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div&gt;</span>{{name}}<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/template&gt;</span>
</pre></div><div class="highlight"><pre><span class="vg">Template</span><span class="o">.</span><span class="vg">nametag</span><span class="o">.</span><span class="vg">events</span><span class="p">({</span>
<span class="w">  </span><span class="nl">click:</span><span class="w"> </span><span class="vg">function</span><span class="p">(</span><span class="vg">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="vg">console</span><span class="o">.</span><span class="vg">log</span><span class="p">(</span><span class="vg">this</span><span class="o">.</span><span class="vg">name</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">});</span>
</pre></div>
<p><strong>Caveat</strong>: Data attributes may be necessary if you are using a jQuery plugin which requires them.</p>

<h2 id="dynamically-created-collections">Dynamically Created Collections</h2>

<p>This isn't so much a mistake as it is a line of reasoning that will get you nowhere. Here's an example conversation that I've had many times with new meteor developers:</p>

<p><strong>developer</strong>: "I have a collection of diamonds. If a user wants to insert a sapphire, I think I should create a new collection on the fly."</p>

<p><strong>me</strong>: "Why?"</p>

<p><strong>developer</strong>: "Because diamonds and sapphires could have a slightly different object structure."</p>

<p><strong>me</strong>: "What you actually want is a gemstones collection, where each document has a type."</p>

<p><strong>developer</strong>: "But they won't have the same schema. Isn't that a problem?"</p>

<p><strong>me</strong>: "It doesn't matter. Mongo is a schemaless database."</p>

<p><strong>developer</strong>: "Okay, but it's so easy just to declare a new collection on the client."</p>

<p><strong>me</strong>: "Sure, but that doesn't do you any good unless the server knows about it as well. The best attempt I've seen is <a href="https://stackoverflow.com/questions/15214667/creating-new-meteor-collections-on-the-fly" target="_blank">this</a>, but I'm not sure it works."</p>

<p><strong>developer</strong>: "Well I guess I cold try that."</p>

<p><strong>me</strong>: "How will you inform the other connected clients about which collections exist?"</p>

<p><strong>developer</strong>: "Maybe I could publish a collection of dynamically created collections."</p>

<p><strong>me</strong>: "Yikes. How would you even query that?"</p>

<p><strong>developer</strong>: "Ummmm..."</p>

<p><strong>me</strong>: "So how about that gemstones collection?"</p>

<p><strong>developer</strong>: "Yes please."</p>

<p>Meteor isn't built for dynamically created collections. Hopefully this will save you a few hours of research.</p>

<h2 id="merge-box">Merge Box</h2>

<p>This is a problem you'll encounter once you start using publications with fields projections. Let's assume a simplified users collection with the following document:</p>
<div class="highlight"><pre><span class="nx">_id</span><span class="o">:</span> <span class="s1">'abc123'</span><span class="p">,</span>
<span class="nx">username</span><span class="o">:</span> <span class="s1">'bobama'</span><span class="p">,</span>
<span class="nx">profile</span><span class="o">:</span> <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">'Barack'</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">'Obama'</span><span class="p">},</span>
<span class="nx">isPresident</span><span class="o">:</span> <span class="kc">true</span>
</pre></div>
<p>Imagine there are two publications for users:</p>

<ol>
<li><code>return Meteor.users.find({_id: userId}, {fields: {username: 1, profile: 1}});</code></li>
<li><code>return Meteor.users.find({_id: userId}, {fields: {'profile.lastName': 1}});</code></li>
</ol>

<p>The client can only have one copy of any given document. The server will evaluate which fields should be transmitted to the client, using something called the <code>MergeBox</code>. In an ideal world, if both of these publishers were active, the client would always have the complete user profile (one sends the full version and the other sends a partial version).</p>

<p>Unfortunately, the <code>MergeBox</code> <a href="https://github.com/meteor/meteor/issues/998" target="_blank">only operates on top-level fields</a>, as hinted at by this text in the <a href="https://docs.meteor.com/#/full/meteor_subscribe" target="_blank">subscribe</a> documentation:</p>

<blockquote>
<p>If more than one subscription sends conflicting values for a field (same collection name, document ID, and field name), then the value on the client will be one of the published values, chosen arbitrarily.</p>
</blockquote>

<p>In other words, documents are <strong>not deeply merged</strong>, and sometimes the complete profile from publication (1) will be chosen, and sometimes the partial version from (2) will be chosen. The client could see a document like this:</p>
<div class="highlight"><pre><span class="nx">_id</span><span class="o">:</span> <span class="s1">'abc123'</span><span class="p">,</span>
<span class="nx">username</span><span class="o">:</span> <span class="s1">'bobama'</span><span class="p">,</span>
<span class="nx">profile</span><span class="o">:</span> <span class="p">{</span><span class="nx">lastName</span><span class="o">:</span> <span class="s1">'Obama'</span><span class="p">}</span>
</pre></div>
<p>There are some <a href="https://medium.com/@MaxDubrovin/workaround-for-meteor-limitations-if-you-want-to-sub-for-more-nested-fields-of-already-received-docs-eb3fdbfe4e07" target="_blank">complicated workarounds</a> to this problem, but the easiest solution is just to use sub-field projections with caution, and to avoid them entirely when you have multiple publishers for the same field.</p>

<hr>

<p>[1] Thanks to <a href="http://joshowens.me/" target="_blank">Josh Owens</a> for pointing out this exception.</p>

        </div>
        <div class="clear"></div>
        
        <p class="kaia_name_and_tag ">
          <a href="https://dweldon.silvrback.com/">David Weldon</a>
  </p>

  <div class="entry_meta_area">
    <p class="kaia_actions"><span class="entry_date">December 02, 2014</span>
      <br>


              <a class="comment_link fa fa-comment" title="Comment" href="https://dweldon.silvrback.com/common-mistakes#comment_drawer_top"></a>
              <a href="https://dweldon.silvrback.com/common-mistakes#disqus_thread" class="comment_link comment_link_text" data-disqus-identifier="silvrback-dweldon-9917">9 Comments</a>
          <span class="share_social">
      </span></p><div class="bottom-subscription bottom-subscription-wrapper">
  <div>
    <a class="open_ajax_popup sub-button" href="https://dweldon.silvrback.com/email_subscriptions/new">
      Subscribe to this Blog
    </a>

    <div class="search-wrapper">
  <form accept-charset="UTF-8" action="https://dweldon.silvrback.com/search" id="search-form" method="post" target="_blank"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="âœ“"><input name="authenticity_token" type="hidden" value="IxMmnpU0XadFXpZEaRWTxktFLbGNK/iW/ARfbyMLNpw="></div>
      <div class="search-form">
        <input class="search-input" id="term" name="term" placeholder="Search" type="text">
        <input id="user_id" name="user_id" type="hidden" value="640">
        <span class="search-submit">
         <i class="fa fa-search"></i>
        </span>
      </div>
</form></div>
<script type="text/javascript">
    $(function () {
        var searchInput = $('#search-form .search-input');
        $('#search-form .search-submit').click(function (e) {
            search(e, searchInput);
        });

        searchInput.keypress(function (e) {
            if (e.keyCode == 13) {
                search(e, $(this));
            }
        });

        var search = function (event, input) {
            event.preventDefault();
            search_text = input.val();
            if (search_text != '' && search_text.length >= 3) {
                $('#search-form').submit();
            }
            else {
                $('#search-form').find('.search-input').focus();
            }
        };

        searchInput.focusin(function () {
            $('.search-form').addClass('search-active');
        }).focusout(function () {
            $('.search-form').removeClass('search-active');
        });
    });
</script>
  </div>

  <div class="share_social article-bottom-social-share">
    <span class="social-share-text"> Share </span>
    <a href="https://dweldon.silvrback.com/articles/9917/shares/new" class="share-email-link">
        <i class="fa fa-envelope"></i>
</a>
    <a href="http://www.twitter.com/share?url=https://dweldon.silvrback.com/common-mistakes&amp;text=meteor:%20common%20mistakes" title="Share this post on Twitter" data-lang="en" onclick="return !window.open(this.href, &#39;Twitter&#39;, &#39;width=640,height=300&#39;)"><i class="fa fa-twitter"></i></a>

    <a target="_blank" onclick="return !window.open(this.href, &#39;Facebook&#39;, &#39;width=640,height=300&#39;)" href="http://www.facebook.com/sharer/sharer.php?u=https://dweldon.silvrback.com/common-mistakes" title="Share this post on Facebook"><i class="fa fa-facebook"></i></a>

    <a href="http://plus.google.com/share?url=https://dweldon.silvrback.com/common-mistakes" target="_blank" onclick="return !window.open(this.href, &#39;Google +&#39;, &#39;width=640,height=300&#39;)" title="Share this post on Google +"><i class="last_link fa fa-google-plus"></i></a>
    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://dweldon.silvrback.com/common-mistakes" onclick="return !window.open(this.href, &#39;LinkedIn&#39;, &#39;width=640,height=300&#39;)" target="_blank" title="Share this post on LinkedIn">
      <i class="last_link fa fa-linkedin"></i>
    </a>
  </div>
</div>

<div id="email_share_popup" class="white-popup mfp-with-anim mfp-hide">
  <div class="modal-header">
    <h1 class="header-title"> Share this article with friends </h1>
  </div>
  <div class="modal-body">

  </div>
</div>

<script>!function (d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (!d.getElementById(id)) {
        js = d.createElement(s);
        js.id = id;
        js.src = "https://platform.twitter.com/widgets.js";
        fjs.parentNode.insertBefore(js, fjs);
    }
}(document, "script", "twitter-wjs");</script>
<script type="text/javascript">
    $(function () {
        $('.share-email-link').click(function (e) {
            e.preventDefault();
            $.ajax({
                url: $(this).attr('href'),
                type: 'get',
                dataType: 'script'
            })
        });
    });
</script>
    
          
      </div>

  <script type="text/javascript" charset="utf-8">
      $(function () {
          var url = window.location.href;
          var index = url.indexOf('#');
          if (index != -1) {
              var hash = url.substring(index + 1);
              if ((/comment-/i.test(hash) || /post-/i.test(hash))) {
                  $('.comment_link:first').trigger('click');
              }
          }
      });
  </script>



        
      </div>
    </div>
  </div>
  
  <div style="position:relative; z-index:100">
      <div class="kaia_page kaia_footer_section">
        <div class="align_center read_next">
          <h2 class="read_next_btn"><a href="https://dweldon.silvrback.com/kadira" class="read_next_link" title="Read Next">Read Next: meteor: How we use Kadira at Edthena</a>
</h2>
        </div>

        <div class="bottom_menu_links align_center header_background_text">
          <ul>
              <li><a href="https://dweldon.silvrback.com/">Blog</a></li>
<li><a href="https://dweldon.silvrback.com/archive">Archive</a></li>
    <li><a href="https://dweldon.silvrback.com/bio">Bio</a></li>
<li><a href="https://dweldon.silvrback.com/feed">RSS</a></li>
          </ul>
        </div>
      </div>

      <div class="kaia_footer">
        <div class="kaia_page">
          <div class="bottom_footer_area">
            <p class="align_center header_background_text">
              

            </p><div class="footer-copy-right">
              Â© 2016 <a href="https://dweldon.silvrback.com/">David Weldon</a>
              <br><br>
                      <a href="https://www.silvrback.com/" title="Proudly Published With Silvrback Blog"><img alt="Gorilla-white" src="./David Weldon - meteor_ common mistakes_files/gorilla-white-741ea3d1f1fcab17c198f45d894493d6.svg" style="width:40px; margin-top:20px;"></a>
            </div>
            <p></p>
          </div>
        </div>
      </div>
</div>
</article><div class="comments" id="comment_drawer_top">
  <div class="article_body">
    <div class="kaia_page">
      <p class="comments_x"><a class="fa fa-times comments_close" style="color:#000"></a></p>
      <div class="article_padding comments_inner">      
          <div class="align_center disqus">
    <div id="disqus_thread" style="width:94%; border:1px solid #eee; padding:20px;"><iframe id="dsq-app2" name="dsq-app2" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./David Weldon - meteor_ common mistakes_files/saved_resource.html" horizontalscrolling="no" verticalscrolling="no" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 5799px !important;"></iframe></div>
  </div>
  <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = "dweldon"; // required: replace example with your forum shortname
    var disqus_identifier = "silvrback-dweldon-9917";

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the &lt;a href="http://disqus.com/?ref_noscript"&gt;comments powered by Disqus.&lt;/a&gt;</noscript>
  

      </div>
    </div>
  </div>
</div><div class="clear"></div><script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = "dweldon";; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
  </script><div class="social" style="display: block;">
    <ul>





    <li><a href="http://www.github.com/dweldon" target="_blank" title="My GitHub Profile"><i class="fa fa-github"></i></a></li>


    <li><a href="mailto:dweldon@gmail.com" target="_blank" title="Get in Touch"><i class="fa fa-comments"></i></a></li>
</ul>
  </div><script type="text/javascript">
  $(document).ready(function() {
    //need to fetch the read next btn via js to avoid the cache. Convert to utc. 
    $.getScript("/home/read_next?date=2014-12-02 21:02:52 UTC&article_id=9917");
    $('.all_external_links').find('a[href^="http://"], a[href^="https://"]').attr('target', '_blank');

  });
</script><script type="text/javascript">
    var _sf_async_config = {uid: 35610, domain: 'silvrback.com', useCanonical: true};
    (function () {
        function loadChartbeat() {
            window._sf_endpt = (new Date()).getTime();
            var e = document.createElement('script');
            e.setAttribute('language', 'javascript');
            e.setAttribute('type', 'text/javascript');
            e.setAttribute('src', '//static.chartbeat.com/js/chartbeat.js');
            document.body.appendChild(e);
        };
        var oldonload = window.onload;
        window.onload = (typeof window.onload != 'function') ?
                loadChartbeat : function () {
            oldonload();
            loadChartbeat();
        };
    })();

    $(document).ready(function () {
        $(".tab_open a").attr("target", "_blank");
    })
</script></div>




  

  








<iframe id="rufous-sandbox" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: none;"></iframe><script language="javascript" type="text/javascript" src="./David Weldon - meteor_ common mistakes_files/chartbeat.js"></script></body></html>